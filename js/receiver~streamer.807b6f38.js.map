{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.string.split.js","webpack:///./node_modules/core-js/modules/web.dom-collections.for-each.js","webpack:///./node_modules/core-js/internals/array-for-each.js","webpack:///./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack:///./node_modules/core-js/internals/array-method-has-species-support.js","webpack:///./node_modules/core-js/modules/es.regexp.to-string.js","webpack:///./node_modules/sdp/sdp.js","webpack:///./src/utils/background/helpers/CodecsHandler.js","webpack:///./node_modules/core-js/modules/es.array.for-each.js","webpack:///./node_modules/node-libs-browser/mock/process.js","webpack:///./node_modules/core-js/internals/is-regexp.js","webpack:///./node_modules/core-js/modules/es.string.match.js","webpack:///./node_modules/core-js/modules/es.regexp.constructor.js","webpack:///./node_modules/core-js/internals/array-species-create.js","webpack:///./node_modules/core-js/internals/inherit-if-required.js","webpack:///./node_modules/core-js/internals/create-property.js","webpack:///./node_modules/regenerator-runtime/runtime.js","webpack:///./node_modules/core-js/modules/es.array.concat.js","webpack:///./node_modules/core-js/modules/es.array.join.js","webpack:///./node_modules/core-js/modules/es.array.splice.js","webpack:///./node_modules/core-js/internals/array-method-is-strict.js","webpack:///./node_modules/core-js/internals/array-method-uses-to-length.js","webpack:///./node_modules/core-js/internals/array-iteration.js","webpack:///./node_modules/core-js/modules/es.array.index-of.js","webpack:///./node_modules/rtcmulticonnection/dist/RTCMultiConnection.js","webpack:///./node_modules/webrtc-adapter/src/js/utils.js","webpack:///./node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","webpack:///./node_modules/webrtc-adapter/src/js/chrome/getdisplaymedia.js","webpack:///./node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/edge/filtericeservers.js","webpack:///./node_modules/webrtc-adapter/src/js/edge/getusermedia.js","webpack:///./node_modules/webrtc-adapter/src/js/edge/getdisplaymedia.js","webpack:///./node_modules/webrtc-adapter/src/js/edge/edge_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","webpack:///./node_modules/webrtc-adapter/src/js/firefox/getdisplaymedia.js","webpack:///./node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/safari/safari_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/common_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/adapter_factory.js","webpack:///./node_modules/webrtc-adapter/src/js/adapter_core.js","webpack:///./node_modules/path-browserify/index.js","webpack:///./src/utils/background/helpers/IceServersHandler.js","webpack:///./node_modules/core-js/internals/is-array.js","webpack:///./node_modules/rtcpeerconnection-shim/rtcpeerconnection.js","webpack:///./node_modules/core-js/internals/dom-iterables.js"],"names":["fixRegExpWellKnownSymbolLogic","isRegExp","anObject","requireObjectCoercible","speciesConstructor","advanceStringIndex","toLength","callRegExpExec","regexpExec","fails","arrayPush","push","min","Math","MAX_UINT32","SUPPORTS_Y","RegExp","SPLIT","nativeSplit","maybeCallNative","internalSplit","split","length","separator","limit","string","String","this","lim","undefined","call","match","lastIndex","lastLength","output","flags","ignoreCase","multiline","unicode","sticky","lastLastIndex","separatorCopy","source","slice","index","apply","test","O","splitter","regexp","res","done","value","rx","S","C","unicodeMatching","p","q","A","e","z","i","global","DOMIterables","forEach","createNonEnumerableProperty","COLLECTION_NAME","Collection","CollectionPrototype","prototype","error","$forEach","arrayMethodIsStrict","arrayMethodUsesToLength","STRICT_METHOD","USES_TO_LENGTH","module","exports","callbackfn","arguments","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","Promise","then","_asyncToGenerator","fn","self","args","err","wellKnownSymbol","V8_VERSION","SPECIES","METHOD_NAME","array","constructor","foo","Boolean","redefine","TO_STRING","RegExpPrototype","nativeToString","NOT_GENERIC","INCORRECT_NAME","name","R","rf","f","unsafe","SDPUtils","random","toString","substr","localCName","generateIdentifier","splitLines","blob","trim","map","line","splitSections","parts","part","getDescription","sections","getMediaSections","shift","matchPrefix","prefix","filter","indexOf","parseCandidate","substring","candidate","foundation","component","parseInt","protocol","toLowerCase","priority","ip","address","port","type","relatedAddress","relatedPort","tcpType","ufrag","usernameFragment","writeCandidate","sdp","toUpperCase","join","parseIceOptions","parseRtpMap","parsed","payloadType","clockRate","channels","numChannels","writeRtpMap","codec","pt","preferredPayloadType","parseExtmap","id","direction","uri","writeExtmap","headerExtension","preferredId","parseFmtp","kv","j","writeFmtp","parameters","Object","keys","params","param","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","ssrc","colon","attribute","parseSsrcGroup","semantics","ssrcs","getMid","mediaSection","mid","parseFingerprint","algorithm","getDtlsParameters","sessionpart","role","fingerprints","writeDtlsParameters","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","getIceParameters","pwd","password","writeIceParameters","parseRtpParameters","description","codecs","headerExtensions","fecMechanisms","rtcp","mline","rtpmapline","fmtps","writeRtpDescription","kind","caps","maxptime","extension","parseRtpEncodingParameters","secondarySsrc","encodingParameters","hasRed","hasUlpfec","primarySsrc","flows","apt","encParam","codecPayloadType","rtx","JSON","parse","stringify","fec","mechanism","bandwidth","maxBitrate","parseRtcpParameters","rtcpParameters","remoteSsrc","obj","cname","rsize","reducedSize","compound","mux","parseMsid","spec","stream","track","planB","msidParts","parseSctpDescription","maxMessageSize","parseMLine","maxSizeLine","isNaN","sctpPort","fmt","sctpMapLines","writeSctpDescription","media","sctp","generateSessionId","writeSessionBoilerplate","sessId","sessVer","sessUser","sessionId","version","user","writeMediaSection","transceiver","iceGatherer","getLocalParameters","dtlsTransport","rtpSender","rtpReceiver","msid","sendEncodingParameters","getDirection","getKind","isRejected","parseOLine","username","sessionVersion","netType","addressType","isValidSDP","charAt","CodecsHandler","preferCodec","codecName","videoCodecNumbers","vp8LineNumber","vp9LineNumber","h264LineNumber","preferCodecHelper","ignore","preferCodecNumber","newLine","videoCodecNumbersOriginal","newOrder","codecNumber","replace","removeVPX","disableNACK","prioritize","codecMimeType","peer","getSenders","sender","getParameters","mimeType","unshift","splice","setParameters","removeNonG722","setBAS","isScreen","isFirefox","screen","console","warn","audio","video","findLine","sdpLines","findLineInRange","startLine","endLine","realEndLine","getCodecPayloadType","sdpLine","pattern","result","setVideoBitrates","vp8Payload","xgoogle_min_bitrate","xgoogle_max_bitrate","max","vp8Index","rtxPayload","rtxIndex","rtxFmtpLineIndex","appendrtxNext","concat","setOpusAttributes","opusPayload","opusIndex","opusFmtpLineIndex","appendOpusNext","stereo","maxaveragebitrate","maxplaybackrate","cbr","useinbandfec","usedtx","forceStereoAudio","setApplicationSpecificBandwidth","preferVP9","window","BandwidthHandler","$","target","proto","forced","nextTick","Array","setTimeout","platform","arch","execPath","title","pid","browser","env","argv","binding","Error","path","cwd","chdir","dir","exit","kill","umask","dlopen","uptime","memoryUsage","uvCounters","features","isObject","classof","MATCH","it","regExpExec","nativeMatch","matcher","fullUnicode","n","matchStr","DESCRIPTORS","isForced","inheritIfRequired","defineProperty","getOwnPropertyNames","getFlags","stickyHelpers","setInternalState","set","setSpecies","NativeRegExp","re1","re2","CORRECT_NEW","UNSUPPORTED_Y","FORCED","RegExpWrapper","thisIsRegExp","patternIsRegExp","flagsAreUndefined","proxy","configurable","get","isArray","originalArray","setPrototypeOf","$this","dummy","Wrapper","NewTarget","NewTargetPrototype","toPrimitive","definePropertyModule","createPropertyDescriptor","object","propertyKey","runtime","Op","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","makeInvokeMethod","tryCatch","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","method","AsyncIterator","invoke","record","__await","unwrapped","previousPromise","enqueue","callInvokeWithMethodAndArg","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","displayName","isGeneratorFunction","genFun","ctor","mark","__proto__","awrap","async","iter","reverse","pop","skipTempReset","prev","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","Function","toObject","createProperty","arraySpeciesCreate","arrayMethodHasSpeciesSupport","IS_CONCAT_SPREADABLE","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_INDEX_EXCEEDED","IS_CONCAT_SPREADABLE_SUPPORT","SPECIES_SUPPORT","isConcatSpreadable","spreadable","k","len","E","IndexedObject","toIndexedObject","nativeJoin","ES3_STRINGS","toAbsoluteIndex","toInteger","HAS_SPECIES_SUPPORT","ACCESSORS","0","1","MAXIMUM_ALLOWED_LENGTH_EXCEEDED","start","deleteCount","insertCount","actualDeleteCount","from","to","actualStart","argumentsLength","argument","has","cache","thrower","options","argument0","argument1","enumerable","bind","createMethod","TYPE","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","NO_HOLES","that","specificCreate","boundFunction","some","every","find","findIndex","$indexOf","nativeIndexOf","NEGATIVE_ZERO","searchElement","RTCMultiConnection","roomid","forceOptions","browserFakeUserAgent","SocketConnection","connection","connectCallback","isData","session","data","userid","sessionid","socketMessageEvent","socketCustomEvent","autoCloseEntireSession","broadcast","maxParticipantsAllowed","enableScalableBroadcast","maxRelayLimitPerUser","extra","socketCustomParameters","io","sockets","socketURL","enableLogs","location","origin","socket","connect","socketOptions","mPeer","multiPeersHandler","updateExtraBackup","remoteUserId","peersBackup","onMessageEvent","message","peers","onExtraDataUpdated","streamSyncNeeded","streamEvents","streamid","action","onstreamended","allParticipants","participant","localPeerSdpConstraints","OfferToReceiveAudio","sdpConstraints","mandatory","OfferToReceiveVideo","remotePeerSdpConstraints","oneway","isOneWay","isDataOnly","newParticipant","createNewPeer","userPreferences","readyForOffer","attachStreams","waitingForLocalMedia","newParticipationRequest","deletePeer","dontGetRemoteStream","dontAttachLocalStream","connectionDescription","successCallback","onNewParticipant","changedUUID","oldUUID","newUUID","userLeft","onUserLeft","leave","addNegotiatedMessage","on","alreadyConnected","resetProps","emit","event","onSocketDisconnect","onSocketError","onUserStatusChanged","status","onEntireSessionClosed","useridAlreadyTaken","yourNewUserId","onUserIdAlreadyTaken","log","debug","onNumberOfBroadcastViewersUpdated","isInitiator","MultiPeers","skipPeers","initFileBufferReader","fbr","FileBufferReader","onProgress","chunk","onFileProgress","onBegin","file","onFileStart","onEnd","onFileEnd","getLength","numberOfPeers","selectFirst","firstPeer","getAllParticipants","allPeers","callbcak","send","isNull","size","enableFileSharing","shareFile","ArrayBuffer","DataView","remoteUser","channel","createDataChannel","renegotiate","TextSender","text","uuid","getLocalConfig","remoteSdp","streamsToShare","rtcMultiConnection","renegotiatingPeer","peerRef","onLocalSdp","localSdp","onNegotiationNeeded","onLocalCandidate","localCandidate","OnIceCandidateHandler","processCandidates","onDataChannelMessage","convertToObject","readyForNextChunk","getNextChunk","nextChunk","isLastChunk","chunkMissing","addChunk","promptNextChunk","onDataChannelError","onDataChannelOpened","onDataChannelClosed","onRemoteStream","streams","onGettingRemoteMedia","onRemoteStreamRemoved","onRemovingRemoteMedia","onPeerStateChanged","states","iceConnectionState","onNegotiationStarted","onNegotiationCompleted","search","disconnectWith","enableMedia","setUserPreferences","localConfig","PeerInitiator","createAnsweringPeer","renegotiatePeer","replaceTrack","isVideoTrack","lastVideoTrack","lastAudioTrack","addRemoteSdp","addRemoteCandidate","isAudio","isVideo","onReadyForOffer","onGettingLocalMedia","localStream","onLocalMediaError","constraints","onMediaError","readAsArrayBuffer","arrayOfUsers","chunkSize","DetectRTC","textReceiver","TextReceiver","receive","onclose","onerror","onopen","getRemoteStreams","fireEvent","eventName","CustomEvent","eventDetail","__exposedProps__","dispatchEvent","setHarkEvents","streamEvent","getTracks","onspeaking","onsilence","hark","onvolumechange","volume","threshold","merge","setMuteHandlers","addEventListener","muteType","onmute","unmuteType","onunmute","getRandomString","crypto","getRandomValues","navigator","userAgent","a","Uint32Array","token","l","Date","getTime","getRMCMediaElement","callback","autoCreateMediaElement","isAudioOnly","mediaElement","document","createElement","srcObject","setAttribute","streamEndedEvent","currentUserMediaRequest","remove","idInstance","StreamsHandler","onSyncNeeded","aStream","idx","newStreamsArray","parentNode","removeChild","played","play","cbFired","catch","listenEventHandler","eventHandler","removeEventListener","removeNullEntries","newArray","item","isString","getUserMedia","captureStream","mozCaptureStream","getContext","pause","drawImage","toDataURL","HTMLVideoElement","HTMLMediaElement","href","hash","width","height","URL","createObjectURL","revokeObjectURL","isNodejs","process","versions","node","webkitGetUserMedia","mozGetUserMedia","isMobileDevice","isEdge","msSaveOrOpenBlob","msSaveBlob","isOpera","opera","InstallTrigger","isSafari","isChrome","chrome","isIE","documentMode","getBrowserInfo","appVersion","nameOffset","verOffset","ix","nAgt","browserName","appName","fullVersion","parseFloat","majorVersion","lastIndexOf","isPrivateBrowsing","retry","isDone","currentTrial","maxRetry","isTimeout","setInterval","clearInterval","isIE10OrLater","ua","exec","detectPrivateMode","isPrivate","webkitRequestFileSystem","TEMPORARY","indexedDB","db","open","readyState","localStorage","setItem","removeItem","isMobile","Android","BlackBerry","iOS","Opera","Windows","any","getOsName","osName","detectDesktopOS","cs","unknown","nVer","os","clientStrings","s","r","osVersion","getAndroidVersion","osInfo","isCanvasSupportsStreamCapturing","isVideoSupportsStreamCapturing","regexIpv4Local","regexIpv4","regexIpv6","DetectLocalIPAddress","isWebRTCSupported","isPublic","isIpv4","getIPs","getElementById","ipDuplicates","RTCPeerConnection","mozRTCPeerConnection","webkitRTCPeerConnection","iframe","win","contentWindow","peerConfig","optional","RtpDataChannels","servers","iceServers","urls","pc","addStream","addTrack","onicecandidate","handleCandidate","isPromisesSupported","createOffer","setLocalDescription","afterCreateOffer","ipAddress","localDescription","MediaDevices","audioInputDevices","audioOutputDevices","videoInputDevices","mediaDevices","enumerateDevices","canEnumerate","MediaStreamTrack","hasMicrophone","hasSpeakers","hasWebcam","isWebsiteHasMicrophonePermissions","isWebsiteHasWebcamPermissions","checkDeviceSupport","getSources","alreadyUsedDevices","devices","_device","device","d","deviceId","label","isCustomLabel","domain","isORTCSupported","RTCIceGatherer","isScreenCapturingSupported","isNonLocalHost","webAudio","isSupported","isCreateMediaStreamSourceSupported","isAudioContextSupported","isRtpDataChannelsSupported","isSCTPSupportd","isSctpDataChannelsSupported","isGetUserMediaSupported","displayResolution","getAspectRatio","w","h","gcd","b","displayAspectRatio","toFixed","isWebSocketsSupported","WebSocket","CLOSING","isWebSocketsBlocked","checkWebSocketsSupport","starttime","websocket","onmessage","WebsocketLatency","close","load","isSetSinkIdSupported","isRTPSenderReplaceTracksSupported","isRemoteStreamProcessingSupported","isApplyConstraintsSupported","isMultiMonitorScreenCapturingSupported","MediaStream","webkitMediaStream","cordova","el","attachEvent","attachEventListener","listener","useCapture","isAudioPlusTab","audioPlusTab","t","isUnifiedPlanSupportedDefault","canAddTransceiver","RTCRtpTransceiver","tempPc","addTransceiver","isUnifiedPlanSuppored","isUnifiedPlanSupported","sdpSemantics","config","getConfiguration","setCordovaAPIs","plugins","iosrtc","RTCSessionDescription","RTCIceCandidate","enable","selectAudioOutput","iOSDefaultAudioOutputDevice","registerGlobals","defaults","setSdpConstraints","mozRTCSessionDescription","mozRTCIceCandidate","removeStream","allRemoteStreams","localStreams","iceTransports","candidates","turn","relay","stun","reflexive","host","iceTransportPolicy","iceCandidatePoolSize","bundlePolicy","rtcpMuxPolicy","optionalArgument","getReceivers","receiver","getLocalStreams","trickleIce","sdpMid","sdpMLineIndex","beforeAddingStream","oniceconnectionstatechange","onsignalingstatechange","iceGatheringState","signalingState","dontDuplicate","ontrack","onended","onremovestream","streamToShare","onremovetrack","removeTrack","remoteCandidate","addIceCandidate","cb","processSdp","setRemoteDescription","isOfferer","setChannelEvents","binaryType","internalSend","ondatachannel","enableDisableVideoEncoding","encodings","active","createOfferOrAnswer","_method","onSettingLocalDescription","nativeClose","fmtpLineIndex","extractSdp","payload","icePair","iceRestrictions","iceProtocols","udp","tcp","IceServersHandler","getIceServers","setStreamType","chromeMediaSource","mozMediaSource","mediaSource","getUserMediaHandler","mutex","localMediaConstraints","streaming","isBlackBerry","getUserMediaStream","getUserMediaError","getUserMediaFailure","hints","getUserMediaSuccess","successCB","failureCB","getDisplayMedia","queueRequests","returnBack","currentUserMediaRequestOptions","handleType","setHandlers","syncAction","mute","isSyncAction","enabled","isAudioMuted","unmute","graduallyIncreaseVolume","looper","times","afterEach","setTimeoutInteval","numberOfTimes","startedTimes","content","last","isobject","receivingTime","latency","sendingTime","autoTranslateText","original","Translator","TranslateText","translatedText","initialText","packetSize","textToTransfer","sendText","textMessage","packets","chunkInterval","FileProgressBarHandler","progressHelper","updateLabel","progress","position","innerHTML","div","filesContainer","body","documentElement","insertBefore","firstChild","querySelector","maxChunks","helper","currentPosition","url","TranslationHandler","language","googKey","newScript","sourceText","encodeURIComponent","randomNumber","response","translations","src","getElementsByTagName","appendChild","getListOfLanguages","xhr","XMLHttpRequest","onreadystatechange","DONE","responseText","languages","useDefaultDevices","preventDuplicateOnStreamEvents","connectSocket","socketAutoReConnect","FirebaseConnection","PubNubConnection","joinRoom","mediaConstraints","getStreamInfoForAdmin","isRoomJoined","openRoom","identifier","publicRoomIdentifier","isRoomOpened","selectAll","tracks","beforeJoin","dontCaptureUserMedia","invokeGetUserMedia","applyConstraints","setStreamEndHandler","muted","onstream","messageToDeliver","openOrJoin","checkPresence","isRoomExist","captureUserMedia","eventObject","onleave","rejoin","onReConnecting","sessionForced","nonScreenSession","onbeforeunload","arg1","dontCloseSocket","closeBeforeUnload","closeSocket","ignoreBeforeUnload","changeUserId","newUserId","facingMode","lastAudioDevice","lastVideoDevice","sourceId","VoiceActivityDetection","DtlsSrtpKeyAgreement","googImprovedWifiBwe","googScreencastMinBitrate","googIPv6","googDscp","googCpuUnderuseThreshold","googCpuOveruseThreshold","googSuspendBelowMinBitrate","googCpuOveruseDetection","disconnect","closeEntireSession","videosContainer","gumCallback","streamCallback","videoConstraints","alert","resetTrack","remoteUsersIds","isRemote","alreadySetEndHandler","participantId","acceptParticipationRequest","invokeSelectFileDialog","selector","FileSelector","accept","selectSingleFile","paused","poster","snapshot","getSocket","skipStreams","local","remote","setCustomSocketEvent","customEvent","getNumberOfBroadcastViewers","broadcastId","numberOfBroadcastViewers","dontWriteLogs","setCustomSocketHandler","customSocketHandler","_roomid","SSEConnection","dontAttachStream","updateExtraData","beforeRemovingStream","isChromeExtensionAvailable","checkIfChromeExtensionAvailable","isFirefoxExtensionAvailable","getChromeExtensionStatus","modifyScreenConstraints","screen_constraints","isOnline","isLowBandwidth","opt","getExtraData","autoOpenOrJoin","resetScreen","setPassword","errors","ROOM_NOT_AVAILABLE","INVALID_PASSWORD","USERID_NOT_AVAILABLE","ROOM_PERMISSION_DENIED","ROOM_FULL","DID_NOT_JOIN_ANY_ROOM","INVALID_SOCKET","PUBLIC_IDENTIFIER_MISSING","INVALID_ADMIN_CREDENTIAL","logDisabled_","deprecationWarnings_","extractVersion","uastring","expr","pos","wrapPeerConnectionEvent","eventNameToWrap","wrapper","nativeAddEventListener","nativeEventName","wrappedCallback","modifiedEvent","_eventMap","nativeRemoveEventListener","unwrappedCb","disableLog","bool","disableWarnings","deprecated","oldMethod","newMethod","detectBrowser","isSecureContext","supportsUnifiedPlan","val","compactObject","reduce","accumulator","isObj","isEmptyObject","assign","walkStats","stats","base","resultSet","endsWith","filterStats","outbound","streamStatsType","filteredResult","Map","trackStats","trackIdentifier","trackStat","trackId","shimGetUserMedia","browserDetails","constraintsToChrome_","c","cc","ideal","exact","oldname_","oc","mix","advanced","shimConstraints_","func","remap","face","getSupportedFacingModeLies","getSupportedConstraints","matches","dev","includes","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","constraint","constraintName","getUserMedia_","onSuccess","onError","origGetUserMedia","getAudioTracks","getVideoTracks","DOMException","shimGetDisplayMedia","getSourceId","widthSpecified","heightSpecified","frameRateSpecified","frameRate","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","shimMediaStream","shimOnTrack","_ontrack","origSetRemoteDescription","_ontrackpoly","te","Event","shimGetSendersWithDtmf","shimSenderWithDtmf","_dtmf","createDTMFSender","_pc","_senders","origAddTrack","origRemoveTrack","origAddStream","origRemoveStream","RTCRtpSender","origGetSenders","senders","shimGetStats","origGetStats","getStats","onSucc","onErr","fixChromeStats_","standardReport","reports","report","standardStats","timestamp","localcandidate","remotecandidate","names","stat","makeMapStats","successCallbackWrapper_","shimSenderReceiverGetStats","RTCRtpReceiver","origGetReceivers","receivers","srcElement","shimAddTrackRemoveTrackWithNative","_shimmedLocalStreams","streamId","alreadyExists","existingSenders","newSenders","newSender","shimAddTrackRemoveTrack","origGetLocalStreams","nativeStreams","_reverseStreams","_streams","newStream","replaceInternalStreamId","internalId","externalStream","internalStream","replaceExternalStreamId","oldStream","nativeMethod","methodObj","isLegacyCall","desc","origSetLocalDescription","origLocalDescription","getOwnPropertyDescriptor","isLocal","hasTrack","shimPeerConnection","addIceCandidateNullSupported","nativeAddIceCandidate","fixNegotiationNeeded","filterIceServers","edgeVersion","hasTurn","server","validTurn","startsWith","origMSTEnabled","ev","RTCDtmfSender","RTCDTMFSender","RTCPeerConnectionShim","shimReplaceTrack","setTrack","nativeGetUserMedia","getSettings","nativeGetSettings","nativeApplyConstraints","preferredMediaSource","code","RTCTrackEvent","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","shimSenderGetStats","shimReceiverGetStats","shimRemoveStream","shimRTCDataChannel","DataChannel","RTCDataChannel","shimAddTransceiver","origAddTransceiver","setParametersPromises","initParameters","shouldPerformCheck","sendEncodings","encodingParam","ridRegex","rid","scaleResolutionDownBy","RangeError","maxFramerate","shimCreateOffer","origCreateOffer","all","finally","shimCreateAnswer","origCreateAnswer","createAnswer","shimLocalStreamsAPI","_localStreams","_addTrack","shimRemoteStreamsAPI","_remoteStreams","_onaddstream","_onaddstreampoly","shimCallbacksAPI","failureCallback","promise","withCallback","_getUserMedia","shimConstraints","errcb","shimRTCIceServerUrls","OrigPeerConnection","pcConfig","pcConstraints","newIceServers","generateCertificate","shimTrackEventTransceiver","shimCreateOfferLegacy","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","setDirection","offerToReceiveVideo","videoTransceiver","shimRTCIceCandidate","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","augmentedCandidate","toJSON","writable","shimMaxMessageSize","_sctp","sctpInDescription","mLine","getRemoteFirefoxVersion","getCanSendMaxMessageSize","remoteIsFirefox","canSendMaxMessageSize","getMaxMessageSize","canSendMMS","remoteMMS","Number","POSITIVE_INFINITY","shimSendThrowTypeError","wrapDcSend","dc","origDataChannelSend","byteLength","origCreateDataChannel","dataChannel","shimConnectionState","completed","checking","_onconnectionstatechange","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","removeAllowExtmapMixed","nativeSRD","adapterFactory","shimChrome","shimFirefox","shimEdge","shimSafari","logging","adapter","commonShim","browserShim","normalizeArray","allowAboveRoot","up","basename","end","matchedSlash","charCodeAt","xs","resolvedPath","resolvedAbsolute","normalize","isAbsolute","trailingSlash","paths","relative","arr","fromParts","toParts","samePartsLength","outputParts","sep","delimiter","dirname","hasRoot","ext","extname","startDot","startPart","preDotState","str","credential","fixStatsType","dtlsRole","_initialTrackId","getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","findCodecByPayloadType","rtxCapabilityMatches","lRtx","rRtx","lCodecs","rCodecs","lCodec","rCodec","lHeaderExtension","rHeaderExtension","isActionAllowedInSignalingState","offer","answer","maybeAddCandidate","iceTransport","alreadyAdded","getRemoteCandidates","makeError","NotSupportedError","InvalidAccessError","OperationError","addTrackToStreamAndFireEvent","MediaStreamTrackEvent","removeTrackFromStreamAndFireEvent","fireAddTrack","trackEvent","_dispatchEvent","_eventTarget","createDocumentFragment","canTrickleIceCandidates","needNegotiation","remoteStreams","_localDescription","_remoteDescription","usingBundle","_iceGatherers","gatherPolicy","_config","transceivers","_sdpSessionId","_sdpSessionVersion","_dtlsRole","_isClosed","onaddstream","onconnectionstatechange","onicegatheringstatechange","onnegotiationneeded","_emitGatheringStateChange","_createTransceiver","doNotAdd","hasBundleTransport","recvEncodingParameters","associatedRemoteMediaStreams","wantReceive","transports","_createIceAndDtlsTransports","_maybeFireNegotiationNeeded","clonedStream","clone","clonedTrack","_createIceGatherer","bufferedCandidateEvents","bufferCandidates","_gather","onlocalcandidate","evt","cand","serializedCandidate","RTCIceTransport","onicestatechange","_updateIceConnectionState","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","_disposeIceAndDtlsTransports","_transceive","recv","isIceLite","rejected","remoteIceParameters","remoteDtlsParameters","_updateSignalingState","receiverList","iceOptions","remoteMsid","isComplete","cands","setTransport","setRemoteCandidates","hasRtx","default","getCapabilities","isNewTrack","nativeTrack","sid","newState","closed","connected","disconnected","failed","new","connecting","numAudioTracks","numVideoTracks","remoteCodec","hdrExt","remoteExtensions","rHdrExt","getLocalCandidates","mediaSectionsInOffer","localTrack","candidateString","senderOrReceiver","promises","allStats","results","ortcObjects","ortcObjectName","nativeGetstats","nativeStats","mapStats","methods","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList"],"mappings":"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","file":"js/receiver~streamer.807b6f38.js","sourcesContent":["'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar isRegExp = require('../internals/is-regexp');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar speciesConstructor = require('../internals/species-constructor');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar toLength = require('../internals/to-length');\nvar callRegExpExec = require('../internals/regexp-exec-abstract');\nvar regexpExec = require('../internals/regexp-exec');\nvar fails = require('../internals/fails');\n\nvar arrayPush = [].push;\nvar min = Math.min;\nvar MAX_UINT32 = 0xFFFFFFFF;\n\n// babel-minify transpiles RegExp('x', 'y') -> /x/y and it causes SyntaxError\nvar SUPPORTS_Y = !fails(function () { return !RegExp(MAX_UINT32, 'y'); });\n\n// @@split logic\nfixRegExpWellKnownSymbolLogic('split', 2, function (SPLIT, nativeSplit, maybeCallNative) {\n  var internalSplit;\n  if (\n    'abbc'.split(/(b)*/)[1] == 'c' ||\n    'test'.split(/(?:)/, -1).length != 4 ||\n    'ab'.split(/(?:ab)*/).length != 2 ||\n    '.'.split(/(.?)(.?)/).length != 4 ||\n    '.'.split(/()()/).length > 1 ||\n    ''.split(/.?/).length\n  ) {\n    // based on es5-shim implementation, need to rework it\n    internalSplit = function (separator, limit) {\n      var string = String(requireObjectCoercible(this));\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (separator === undefined) return [string];\n      // If `separator` is not a regex, use native split\n      if (!isRegExp(separator)) {\n        return nativeSplit.call(string, separator, lim);\n      }\n      var output = [];\n      var flags = (separator.ignoreCase ? 'i' : '') +\n                  (separator.multiline ? 'm' : '') +\n                  (separator.unicode ? 'u' : '') +\n                  (separator.sticky ? 'y' : '');\n      var lastLastIndex = 0;\n      // Make `global` and avoid `lastIndex` issues by working with a copy\n      var separatorCopy = new RegExp(separator.source, flags + 'g');\n      var match, lastIndex, lastLength;\n      while (match = regexpExec.call(separatorCopy, string)) {\n        lastIndex = separatorCopy.lastIndex;\n        if (lastIndex > lastLastIndex) {\n          output.push(string.slice(lastLastIndex, match.index));\n          if (match.length > 1 && match.index < string.length) arrayPush.apply(output, match.slice(1));\n          lastLength = match[0].length;\n          lastLastIndex = lastIndex;\n          if (output.length >= lim) break;\n        }\n        if (separatorCopy.lastIndex === match.index) separatorCopy.lastIndex++; // Avoid an infinite loop\n      }\n      if (lastLastIndex === string.length) {\n        if (lastLength || !separatorCopy.test('')) output.push('');\n      } else output.push(string.slice(lastLastIndex));\n      return output.length > lim ? output.slice(0, lim) : output;\n    };\n  // Chakra, V8\n  } else if ('0'.split(undefined, 0).length) {\n    internalSplit = function (separator, limit) {\n      return separator === undefined && limit === 0 ? [] : nativeSplit.call(this, separator, limit);\n    };\n  } else internalSplit = nativeSplit;\n\n  return [\n    // `String.prototype.split` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.split\n    function split(separator, limit) {\n      var O = requireObjectCoercible(this);\n      var splitter = separator == undefined ? undefined : separator[SPLIT];\n      return splitter !== undefined\n        ? splitter.call(separator, O, limit)\n        : internalSplit.call(String(O), separator, limit);\n    },\n    // `RegExp.prototype[@@split]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@split\n    //\n    // NOTE: This cannot be properly polyfilled in engines that don't support\n    // the 'y' flag.\n    function (regexp, limit) {\n      var res = maybeCallNative(internalSplit, regexp, this, limit, internalSplit !== nativeSplit);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n      var C = speciesConstructor(rx, RegExp);\n\n      var unicodeMatching = rx.unicode;\n      var flags = (rx.ignoreCase ? 'i' : '') +\n                  (rx.multiline ? 'm' : '') +\n                  (rx.unicode ? 'u' : '') +\n                  (SUPPORTS_Y ? 'y' : 'g');\n\n      // ^(? + rx + ) is needed, in combination with some S slicing, to\n      // simulate the 'y' flag.\n      var splitter = new C(SUPPORTS_Y ? rx : '^(?:' + rx.source + ')', flags);\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];\n      var p = 0;\n      var q = 0;\n      var A = [];\n      while (q < S.length) {\n        splitter.lastIndex = SUPPORTS_Y ? q : 0;\n        var z = callRegExpExec(splitter, SUPPORTS_Y ? S : S.slice(q));\n        var e;\n        if (\n          z === null ||\n          (e = min(toLength(splitter.lastIndex + (SUPPORTS_Y ? 0 : q)), S.length)) === p\n        ) {\n          q = advanceStringIndex(S, q, unicodeMatching);\n        } else {\n          A.push(S.slice(p, q));\n          if (A.length === lim) return A;\n          for (var i = 1; i <= z.length - 1; i++) {\n            A.push(z[i]);\n            if (A.length === lim) return A;\n          }\n          q = p = e;\n        }\n      }\n      A.push(S.slice(p));\n      return A;\n    }\n  ];\n}, !SUPPORTS_Y);\n","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar forEach = require('../internals/array-for-each');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  // some Chrome versions have non-configurable methods on DOMTokenList\n  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {\n    createNonEnumerableProperty(CollectionPrototype, 'forEach', forEach);\n  } catch (error) {\n    CollectionPrototype.forEach = forEach;\n  }\n}\n","'use strict';\nvar $forEach = require('../internals/array-iteration').forEach;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('forEach');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('forEach');\n\n// `Array.prototype.forEach` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\nmodule.exports = (!STRICT_METHOD || !USES_TO_LENGTH) ? function forEach(callbackfn /* , thisArg */) {\n  return $forEach(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n} : [].forEach;\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (METHOD_NAME) {\n  // We can't use this feature detection in V8 since it causes\n  // deoptimization and serious performance degradation\n  // https://github.com/zloirock/core-js/issues/677\n  return V8_VERSION >= 51 || !fails(function () {\n    var array = [];\n    var constructor = array.constructor = {};\n    constructor[SPECIES] = function () {\n      return { foo: 1 };\n    };\n    return array[METHOD_NAME](Boolean).foo !== 1;\n  });\n};\n","'use strict';\nvar redefine = require('../internals/redefine');\nvar anObject = require('../internals/an-object');\nvar fails = require('../internals/fails');\nvar flags = require('../internals/regexp-flags');\n\nvar TO_STRING = 'toString';\nvar RegExpPrototype = RegExp.prototype;\nvar nativeToString = RegExpPrototype[TO_STRING];\n\nvar NOT_GENERIC = fails(function () { return nativeToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = nativeToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.github.io/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  redefine(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    var p = String(R.source);\n    var rf = R.flags;\n    var f = String(rf === undefined && R instanceof RegExp && !('flags' in RegExpPrototype) ? flags.call(R) : rf);\n    return '/' + p + '/' + f;\n  }, { unsafe: true });\n}\n","/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// returns the session description.\nSDPUtils.getDescription = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n};\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      if (codec.parameters[param]) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\nSDPUtils.parseSsrcGroup = function(line) {\n  var parts = line.substr(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function(ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n};\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  var parts = keyParams.substr(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES paramters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  var pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substr(12),\n    password: pwd.substr(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function(extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(parts) {\n      return parts.attribute === 'cname';\n    });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(function(line) {\n      var parts = line.substr(17).split(' ');\n      return parts.map(function(part) {\n        return parseInt(part, 10);\n      });\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note tha with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(obj) {\n      return obj.attribute === 'cname';\n    })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(msidParts) {\n      return msidParts.attribute === 'msid';\n    });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  var mline = SDPUtils.parseMLine(mediaSection);\n  var maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  var maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substr(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  var sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substr(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize: maxMessageSize\n    };\n  }\n  var sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    var parts = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:')[0]\n      .substr(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize: maxMessageSize\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  var output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n'\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n'\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n    transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n    transceiver.dtlsTransport.getLocalParameters(),\n    type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substr(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substr(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","// CodecsHandler.js\n\nexport var CodecsHandler = (function() {\n  function preferCodec(sdp, codecName) {\n    var info = splitLines(sdp);\n\n    if (!info.videoCodecNumbers) {\n      return sdp;\n    }\n\n    if (\n      codecName === 'vp8' &&\n      info.vp8LineNumber === info.videoCodecNumbers[0]\n    ) {\n      return sdp;\n    }\n\n    if (\n      codecName === 'vp9' &&\n      info.vp9LineNumber === info.videoCodecNumbers[0]\n    ) {\n      return sdp;\n    }\n\n    if (\n      codecName === 'h264' &&\n      info.h264LineNumber === info.videoCodecNumbers[0]\n    ) {\n      return sdp;\n    }\n\n    sdp = preferCodecHelper(sdp, codecName, info);\n\n    return sdp;\n  }\n\n  function preferCodecHelper(sdp, codec, info, ignore) {\n    var preferCodecNumber = '';\n\n    if (codec === 'vp8') {\n      if (!info.vp8LineNumber) {\n        return sdp;\n      }\n      preferCodecNumber = info.vp8LineNumber;\n    }\n\n    if (codec === 'vp9') {\n      if (!info.vp9LineNumber) {\n        return sdp;\n      }\n      preferCodecNumber = info.vp9LineNumber;\n    }\n\n    if (codec === 'h264') {\n      if (!info.h264LineNumber) {\n        return sdp;\n      }\n\n      preferCodecNumber = info.h264LineNumber;\n    }\n\n    var newLine = info.videoCodecNumbersOriginal.split('SAVPF')[0] + 'SAVPF ';\n\n    var newOrder = [preferCodecNumber];\n\n    if (ignore) {\n      newOrder = [];\n    }\n\n    info.videoCodecNumbers.forEach(function(codecNumber) {\n      if (codecNumber === preferCodecNumber) return;\n      newOrder.push(codecNumber);\n    });\n\n    newLine += newOrder.join(' ');\n\n    sdp = sdp.replace(info.videoCodecNumbersOriginal, newLine);\n    return sdp;\n  }\n\n  function splitLines(sdp) {\n    var info = {};\n    sdp.split('\\n').forEach(function(line) {\n      if (line.indexOf('m=video') === 0) {\n        info.videoCodecNumbers = [];\n        line\n          .split('SAVPF')[1]\n          .split(' ')\n          .forEach(function(codecNumber) {\n            codecNumber = codecNumber.trim();\n            if (!codecNumber || !codecNumber.length) return;\n            info.videoCodecNumbers.push(codecNumber);\n            info.videoCodecNumbersOriginal = line;\n          });\n      }\n\n      if (line.indexOf('VP8/90000') !== -1 && !info.vp8LineNumber) {\n        info.vp8LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\n      }\n\n      if (line.indexOf('VP9/90000') !== -1 && !info.vp9LineNumber) {\n        info.vp9LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\n      }\n\n      if (line.indexOf('H264/90000') !== -1 && !info.h264LineNumber) {\n        info.h264LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\n      }\n    });\n\n    return info;\n  }\n\n  function removeVPX(sdp) {\n    var info = splitLines(sdp);\n\n    // last parameter below means: ignore these codecs\n    sdp = preferCodecHelper(sdp, 'vp9', info, true);\n    sdp = preferCodecHelper(sdp, 'vp8', info, true);\n\n    return sdp;\n  }\n\n  function disableNACK(sdp) {\n    if (!sdp || typeof sdp !== 'string') {\n      throw 'Invalid arguments.';\n    }\n\n    sdp = sdp.replace('a=rtcp-fb:126 nack\\r\\n', '');\n    sdp = sdp.replace('a=rtcp-fb:126 nack pli\\r\\n', 'a=rtcp-fb:126 pli\\r\\n');\n    sdp = sdp.replace('a=rtcp-fb:97 nack\\r\\n', '');\n    sdp = sdp.replace('a=rtcp-fb:97 nack pli\\r\\n', 'a=rtcp-fb:97 pli\\r\\n');\n\n    return sdp;\n  }\n\n  function prioritize(codecMimeType, peer) {\n    if (!peer || !peer.getSenders || !peer.getSenders().length) {\n      return;\n    }\n\n    if (!codecMimeType || typeof codecMimeType !== 'string') {\n      throw 'Invalid arguments.';\n    }\n\n    peer.getSenders().forEach(function(sender) {\n      var params = sender.getParameters();\n      for (var i = 0; i < params.codecs.length; i++) {\n        if (params.codecs[i].mimeType == codecMimeType) {\n          params.codecs.unshift(params.codecs.splice(i, 1));\n          break;\n        }\n      }\n      sender.setParameters(params);\n    });\n  }\n\n  function removeNonG722(sdp) {\n    return sdp.replace(\n      /m=audio ([0-9]+) RTP\\/SAVPF ([0-9 ]*)/g,\n      'm=audio $1 RTP/SAVPF 9',\n    );\n  }\n\n  function setBAS(sdp, bandwidth, isScreen) {\n    if (!bandwidth) {\n      return sdp;\n    }\n\n    // eslint-disable-next-line no-undef\n    if (typeof isFirefox !== 'undefined' && isFirefox) {\n      return sdp;\n    }\n\n    if (isScreen) {\n      if (!bandwidth.screen) {\n        console.warn(\n          'It seems that you are not using bandwidth for screen.',\n          'Screen sharing is expected to fail.',\n        );\n      } else if (bandwidth.screen < 300) {\n        console.warn(\n          'It seems that you are using wrong bandwidth value for screen.',\n          'Screen sharing is expected to fail.',\n        );\n      }\n    }\n\n    // if screen; must use at least 300kbs\n    if (bandwidth.screen && isScreen) {\n      sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\n      sdp = sdp.replace(\n        /a=mid:video\\r\\n/g,\n        'a=mid:video\\r\\nb=AS:' + bandwidth.screen + '\\r\\n',\n      );\n    }\n\n    // remove existing bandwidth lines\n    if (bandwidth.audio || bandwidth.video) {\n      sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\n    }\n\n    if (bandwidth.audio) {\n      sdp = sdp.replace(\n        /a=mid:audio\\r\\n/g,\n        'a=mid:audio\\r\\nb=AS:' + bandwidth.audio + '\\r\\n',\n      );\n    }\n\n    if (bandwidth.screen) {\n      sdp = sdp.replace(\n        /a=mid:video\\r\\n/g,\n        'a=mid:video\\r\\nb=AS:' + bandwidth.screen + '\\r\\n',\n      );\n    } else if (bandwidth.video) {\n      sdp = sdp.replace(\n        /a=mid:video\\r\\n/g,\n        'a=mid:video\\r\\nb=AS:' + bandwidth.video + '\\r\\n',\n      );\n    }\n\n    return sdp;\n  }\n\n  // Find the line in sdpLines that starts with |prefix|, and, if specified,\n  // contains |substr| (case-insensitive search).\n  function findLine(sdpLines, prefix, substr) {\n    return findLineInRange(sdpLines, 0, -1, prefix, substr);\n  }\n\n  // Find the line in sdpLines[startLine...endLine - 1] that starts with |prefix|\n  // and, if specified, contains |substr| (case-insensitive search).\n  function findLineInRange(sdpLines, startLine, endLine, prefix, substr) {\n    var realEndLine = endLine !== -1 ? endLine : sdpLines.length;\n    for (var i = startLine; i < realEndLine; ++i) {\n      if (sdpLines[i].indexOf(prefix) === 0) {\n        if (\n          !substr ||\n          sdpLines[i].toLowerCase().indexOf(substr.toLowerCase()) !== -1\n        ) {\n          return i;\n        }\n      }\n    }\n    return null;\n  }\n\n  // Gets the codec payload type from an a=rtpmap:X line.\n  function getCodecPayloadType(sdpLine) {\n    var pattern = new RegExp('a=rtpmap:(\\\\d+) \\\\w+\\\\/\\\\d+');\n    var result = sdpLine.match(pattern);\n    return result && result.length === 2 ? result[1] : null;\n  }\n\n  function setVideoBitrates(sdp, params) {\n    params = params || {};\n    var xgoogle_min_bitrate = params.min;\n    var xgoogle_max_bitrate = params.max;\n\n    var sdpLines = sdp.split('\\r\\n');\n\n    // VP8\n    var vp8Index = findLine(sdpLines, 'a=rtpmap', 'VP8/90000');\n    var vp8Payload;\n    if (vp8Index) {\n      vp8Payload = getCodecPayloadType(sdpLines[vp8Index]);\n    }\n\n    if (!vp8Payload) {\n      return sdp;\n    }\n\n    var rtxIndex = findLine(sdpLines, 'a=rtpmap', 'rtx/90000');\n    var rtxPayload;\n    if (rtxIndex) {\n      rtxPayload = getCodecPayloadType(sdpLines[rtxIndex]);\n    }\n\n    if (!rtxIndex) {\n      return sdp;\n    }\n\n    var rtxFmtpLineIndex = findLine(\n      sdpLines,\n      'a=fmtp:' + rtxPayload.toString(),\n    );\n    if (rtxFmtpLineIndex !== null) {\n      var appendrtxNext = '\\r\\n';\n      appendrtxNext +=\n        'a=fmtp:' +\n        vp8Payload +\n        ' x-google-min-bitrate=' +\n        (xgoogle_min_bitrate || '228') +\n        '; x-google-max-bitrate=' +\n        (xgoogle_max_bitrate || '228');\n      sdpLines[rtxFmtpLineIndex] = sdpLines[rtxFmtpLineIndex].concat(\n        appendrtxNext,\n      );\n      sdp = sdpLines.join('\\r\\n');\n    }\n\n    return sdp;\n  }\n\n  function setOpusAttributes(sdp, params) {\n    params = params || {};\n\n    var sdpLines = sdp.split('\\r\\n');\n\n    // Opus\n    var opusIndex = findLine(sdpLines, 'a=rtpmap', 'opus/48000');\n    var opusPayload;\n    if (opusIndex) {\n      opusPayload = getCodecPayloadType(sdpLines[opusIndex]);\n    }\n\n    if (!opusPayload) {\n      return sdp;\n    }\n\n    var opusFmtpLineIndex = findLine(\n      sdpLines,\n      'a=fmtp:' + opusPayload.toString(),\n    );\n    if (opusFmtpLineIndex === null) {\n      return sdp;\n    }\n\n    var appendOpusNext = '';\n    appendOpusNext +=\n      '; stereo=' + (typeof params.stereo != 'undefined' ? params.stereo : '1');\n    appendOpusNext +=\n      '; sprop-stereo=' +\n      (typeof params['sprop-stereo'] != 'undefined'\n        ? params['sprop-stereo']\n        : '1');\n\n    if (typeof params.maxaveragebitrate != 'undefined') {\n      appendOpusNext +=\n        '; maxaveragebitrate=' + (params.maxaveragebitrate || 128 * 1024 * 8);\n    }\n\n    if (typeof params.maxplaybackrate != 'undefined') {\n      appendOpusNext +=\n        '; maxplaybackrate=' + (params.maxplaybackrate || 128 * 1024 * 8);\n    }\n\n    if (typeof params.cbr != 'undefined') {\n      appendOpusNext +=\n        '; cbr=' + (typeof params.cbr != 'undefined' ? params.cbr : '1');\n    }\n\n    if (typeof params.useinbandfec != 'undefined') {\n      appendOpusNext += '; useinbandfec=' + params.useinbandfec;\n    }\n\n    if (typeof params.usedtx != 'undefined') {\n      appendOpusNext += '; usedtx=' + params.usedtx;\n    }\n\n    if (typeof params.maxptime != 'undefined') {\n      appendOpusNext += '\\r\\na=maxptime:' + params.maxptime;\n    }\n\n    sdpLines[opusFmtpLineIndex] = sdpLines[opusFmtpLineIndex].concat(\n      appendOpusNext,\n    );\n\n    sdp = sdpLines.join('\\r\\n');\n    return sdp;\n  }\n\n  // TODO: from Sam: extractSdp is not defined, so this is commented out.\n  // forceStereoAudio => via webrtcexample.com\n  // requires getUserMedia => echoCancellation:false\n  function forceStereoAudio(sdp) {\n    // var sdpLines = sdp.split('\\r\\n');\n    // var fmtpLineIndex = null;\n    // for (var i = 0; i < sdpLines.length; i++) {\n    //   if (sdpLines[i].search('opus/48000') !== -1) {\n    //     var opusPayload = extractSdp(sdpLines[i], /:(\\d+) opus\\/48000/i);\n    //     break;\n    //   }\n    // }\n    // for (var i = 0; i < sdpLines.length; i++) {\n    //   if (sdpLines[i].search('a=fmtp') !== -1) {\n    //     var payload = extractSdp(sdpLines[i], /a=fmtp:(\\d+)/);\n    //     if (payload === opusPayload) {\n    //       fmtpLineIndex = i;\n    //       break;\n    //     }\n    //   }\n    // }\n    // if (fmtpLineIndex === null) return sdp;\n    // sdpLines[fmtpLineIndex] = sdpLines[fmtpLineIndex].concat(\n    //   '; stereo=1; sprop-stereo=1',\n    // );\n    // sdp = sdpLines.join('\\r\\n');\n    console.warn('forceStereoAudio not implemented; forwarding provided sdp');\n    return sdp;\n  }\n\n  return {\n    removeVPX: removeVPX,\n    disableNACK: disableNACK,\n    prioritize: prioritize,\n    removeNonG722: removeNonG722,\n    setApplicationSpecificBandwidth: function(sdp, bandwidth, isScreen) {\n      return setBAS(sdp, bandwidth, isScreen);\n    },\n    setVideoBitrates: function(sdp, params) {\n      return setVideoBitrates(sdp, params);\n    },\n    setOpusAttributes: function(sdp, params) {\n      return setOpusAttributes(sdp, params);\n    },\n    preferVP9: function(sdp) {\n      return preferCodec(sdp, 'vp9');\n    },\n    preferCodec: preferCodec,\n    forceStereoAudio: forceStereoAudio,\n  };\n})();\n\n// backward compatibility\nwindow.BandwidthHandler = CodecsHandler;\n","'use strict';\nvar $ = require('../internals/export');\nvar forEach = require('../internals/array-for-each');\n\n// `Array.prototype.forEach` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n$({ target: 'Array', proto: true, forced: [].forEach != forEach }, {\n  forEach: forEach\n});\n","exports.nextTick = function nextTick(fn) {\n    var args = Array.prototype.slice.call(arguments);\n    args.shift();\n    setTimeout(function () {\n        fn.apply(null, args);\n    }, 0);\n};\n\nexports.platform = exports.arch = \nexports.execPath = exports.title = 'browser';\nexports.pid = 1;\nexports.browser = true;\nexports.env = {};\nexports.argv = [];\n\nexports.binding = function (name) {\n\tthrow new Error('No such module. (Possibly not yet loaded)')\n};\n\n(function () {\n    var cwd = '/';\n    var path;\n    exports.cwd = function () { return cwd };\n    exports.chdir = function (dir) {\n        if (!path) path = require('path');\n        cwd = path.resolve(dir, cwd);\n    };\n})();\n\nexports.exit = exports.kill = \nexports.umask = exports.dlopen = \nexports.uptime = exports.memoryUsage = \nexports.uvCounters = function() {};\nexports.features = {};\n","var isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\n// `IsRegExp` abstract operation\n// https://tc39.github.io/ecma262/#sec-isregexp\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');\n};\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar toLength = require('../internals/to-length');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@match logic\nfixRegExpWellKnownSymbolLogic('match', 1, function (MATCH, nativeMatch, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = requireObjectCoercible(this);\n      var matcher = regexp == undefined ? undefined : regexp[MATCH];\n      return matcher !== undefined ? matcher.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match\n    function (regexp) {\n      var res = maybeCallNative(nativeMatch, regexp, this);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n\n      if (!rx.global) return regExpExec(rx, S);\n\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = String(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isForced = require('../internals/is-forced');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar defineProperty = require('../internals/object-define-property').f;\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar isRegExp = require('../internals/is-regexp');\nvar getFlags = require('../internals/regexp-flags');\nvar stickyHelpers = require('../internals/regexp-sticky-helpers');\nvar redefine = require('../internals/redefine');\nvar fails = require('../internals/fails');\nvar setInternalState = require('../internals/internal-state').set;\nvar setSpecies = require('../internals/set-species');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\nvar NativeRegExp = global.RegExp;\nvar RegExpPrototype = NativeRegExp.prototype;\nvar re1 = /a/g;\nvar re2 = /a/g;\n\n// \"new\" should create a new object, old webkit bug\nvar CORRECT_NEW = new NativeRegExp(re1) !== re1;\n\nvar UNSUPPORTED_Y = stickyHelpers.UNSUPPORTED_Y;\n\nvar FORCED = DESCRIPTORS && isForced('RegExp', (!CORRECT_NEW || UNSUPPORTED_Y || fails(function () {\n  re2[MATCH] = false;\n  // RegExp constructor can alter flags and IsRegExp works correct with @@match\n  return NativeRegExp(re1) != re1 || NativeRegExp(re2) == re2 || NativeRegExp(re1, 'i') != '/a/i';\n})));\n\n// `RegExp` constructor\n// https://tc39.github.io/ecma262/#sec-regexp-constructor\nif (FORCED) {\n  var RegExpWrapper = function RegExp(pattern, flags) {\n    var thisIsRegExp = this instanceof RegExpWrapper;\n    var patternIsRegExp = isRegExp(pattern);\n    var flagsAreUndefined = flags === undefined;\n    var sticky;\n\n    if (!thisIsRegExp && patternIsRegExp && pattern.constructor === RegExpWrapper && flagsAreUndefined) {\n      return pattern;\n    }\n\n    if (CORRECT_NEW) {\n      if (patternIsRegExp && !flagsAreUndefined) pattern = pattern.source;\n    } else if (pattern instanceof RegExpWrapper) {\n      if (flagsAreUndefined) flags = getFlags.call(pattern);\n      pattern = pattern.source;\n    }\n\n    if (UNSUPPORTED_Y) {\n      sticky = !!flags && flags.indexOf('y') > -1;\n      if (sticky) flags = flags.replace(/y/g, '');\n    }\n\n    var result = inheritIfRequired(\n      CORRECT_NEW ? new NativeRegExp(pattern, flags) : NativeRegExp(pattern, flags),\n      thisIsRegExp ? this : RegExpPrototype,\n      RegExpWrapper\n    );\n\n    if (UNSUPPORTED_Y && sticky) setInternalState(result, { sticky: sticky });\n\n    return result;\n  };\n  var proxy = function (key) {\n    key in RegExpWrapper || defineProperty(RegExpWrapper, key, {\n      configurable: true,\n      get: function () { return NativeRegExp[key]; },\n      set: function (it) { NativeRegExp[key] = it; }\n    });\n  };\n  var keys = getOwnPropertyNames(NativeRegExp);\n  var index = 0;\n  while (keys.length > index) proxy(keys[index++]);\n  RegExpPrototype.constructor = RegExpWrapper;\n  RegExpWrapper.prototype = RegExpPrototype;\n  redefine(global, 'RegExp', RegExpWrapper);\n}\n\n// https://tc39.github.io/ecma262/#sec-get-regexp-@@species\nsetSpecies('RegExp');\n","var isObject = require('../internals/is-object');\nvar isArray = require('../internals/is-array');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.github.io/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return new (C === undefined ? Array : C)(length === 0 ? 0 : length);\n};\n","var isObject = require('../internals/is-object');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// makes subclassing work correct for wrapped built-ins\nmodule.exports = function ($this, dummy, Wrapper) {\n  var NewTarget, NewTargetPrototype;\n  if (\n    // it can work only with native `setPrototypeOf`\n    setPrototypeOf &&\n    // we haven't completely correct pre-ES6 way for getting `new.target`, so use this\n    typeof (NewTarget = dummy.constructor) == 'function' &&\n    NewTarget !== Wrapper &&\n    isObject(NewTargetPrototype = NewTarget.prototype) &&\n    NewTargetPrototype !== Wrapper.prototype\n  ) setPrototypeOf($this, NewTargetPrototype);\n  return $this;\n};\n","'use strict';\nvar toPrimitive = require('../internals/to-primitive');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPrimitive(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isObject = require('../internals/is-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar IS_CONCAT_SPREADABLE = wellKnownSymbol('isConcatSpreadable');\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';\n\n// We can't use this feature detection in V8 since it causes\n// deoptimization and serious performance degradation\n// https://github.com/zloirock/core-js/issues/679\nvar IS_CONCAT_SPREADABLE_SUPPORT = V8_VERSION >= 51 || !fails(function () {\n  var array = [];\n  array[IS_CONCAT_SPREADABLE] = false;\n  return array.concat()[0] !== array;\n});\n\nvar SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('concat');\n\nvar isConcatSpreadable = function (O) {\n  if (!isObject(O)) return false;\n  var spreadable = O[IS_CONCAT_SPREADABLE];\n  return spreadable !== undefined ? !!spreadable : isArray(O);\n};\n\nvar FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;\n\n// `Array.prototype.concat` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.concat\n// with adding support of @@isConcatSpreadable and @@species\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  concat: function concat(arg) { // eslint-disable-line no-unused-vars\n    var O = toObject(this);\n    var A = arraySpeciesCreate(O, 0);\n    var n = 0;\n    var i, k, length, len, E;\n    for (i = -1, length = arguments.length; i < length; i++) {\n      E = i === -1 ? O : arguments[i];\n      if (isConcatSpreadable(E)) {\n        len = toLength(E.length);\n        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);\n      } else {\n        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        createProperty(A, n++, E);\n      }\n    }\n    A.length = n;\n    return A;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar nativeJoin = [].join;\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return nativeJoin.call(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toInteger = require('../internals/to-integer');\nvar toLength = require('../internals/to-length');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar createProperty = require('../internals/create-property');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('splice');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('splice', { ACCESSORS: true, 0: 0, 1: 2 });\n\nvar max = Math.max;\nvar min = Math.min;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_LENGTH_EXCEEDED = 'Maximum allowed length exceeded';\n\n// `Array.prototype.splice` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.splice\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  splice: function splice(start, deleteCount /* , ...items */) {\n    var O = toObject(this);\n    var len = toLength(O.length);\n    var actualStart = toAbsoluteIndex(start, len);\n    var argumentsLength = arguments.length;\n    var insertCount, actualDeleteCount, A, k, from, to;\n    if (argumentsLength === 0) {\n      insertCount = actualDeleteCount = 0;\n    } else if (argumentsLength === 1) {\n      insertCount = 0;\n      actualDeleteCount = len - actualStart;\n    } else {\n      insertCount = argumentsLength - 2;\n      actualDeleteCount = min(max(toInteger(deleteCount), 0), len - actualStart);\n    }\n    if (len + insertCount - actualDeleteCount > MAX_SAFE_INTEGER) {\n      throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);\n    }\n    A = arraySpeciesCreate(O, actualDeleteCount);\n    for (k = 0; k < actualDeleteCount; k++) {\n      from = actualStart + k;\n      if (from in O) createProperty(A, k, O[from]);\n    }\n    A.length = actualDeleteCount;\n    if (insertCount < actualDeleteCount) {\n      for (k = actualStart; k < len - actualDeleteCount; k++) {\n        from = k + actualDeleteCount;\n        to = k + insertCount;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n      for (k = len; k > len - actualDeleteCount + insertCount; k--) delete O[k - 1];\n    } else if (insertCount > actualDeleteCount) {\n      for (k = len - actualDeleteCount; k > actualStart; k--) {\n        from = k + actualDeleteCount - 1;\n        to = k + insertCount - 1;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n    }\n    for (k = 0; k < insertCount; k++) {\n      O[k + actualStart] = arguments[k + 2];\n    }\n    O.length = len - actualDeleteCount + insertCount;\n    return A;\n  }\n});\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar has = require('../internals/has');\n\nvar defineProperty = Object.defineProperty;\nvar cache = {};\n\nvar thrower = function (it) { throw it; };\n\nmodule.exports = function (METHOD_NAME, options) {\n  if (has(cache, METHOD_NAME)) return cache[METHOD_NAME];\n  if (!options) options = {};\n  var method = [][METHOD_NAME];\n  var ACCESSORS = has(options, 'ACCESSORS') ? options.ACCESSORS : false;\n  var argument0 = has(options, 0) ? options[0] : thrower;\n  var argument1 = has(options, 1) ? options[1] : undefined;\n\n  return cache[METHOD_NAME] = !!method && !fails(function () {\n    if (ACCESSORS && !DESCRIPTORS) return true;\n    var O = { length: -1 };\n\n    if (ACCESSORS) defineProperty(O, 1, { enumerable: true, get: thrower });\n    else O[1] = 1;\n\n    method.call(O, argument0, argument1);\n  });\n};\n","var bind = require('../internals/function-bind-context');\nvar IndexedObject = require('../internals/indexed-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar push = [].push;\n\n// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex }` methods implementation\nvar createMethod = function (TYPE) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  return function ($this, callbackfn, that, specificCreate) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var create = specificCreate || arraySpeciesCreate;\n    var target = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var value, result;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (TYPE) {\n        if (IS_MAP) target[index] = result; // map\n        else if (result) switch (TYPE) {\n          case 3: return true;              // some\n          case 5: return value;             // find\n          case 6: return index;             // findIndex\n          case 2: push.call(target, value); // filter\n        } else if (IS_EVERY) return false;  // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.forEach` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n  forEach: createMethod(0),\n  // `Array.prototype.map` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.map\n  map: createMethod(1),\n  // `Array.prototype.filter` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.filter\n  filter: createMethod(2),\n  // `Array.prototype.some` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.some\n  some: createMethod(3),\n  // `Array.prototype.every` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.every\n  every: createMethod(4),\n  // `Array.prototype.find` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.find\n  find: createMethod(5),\n  // `Array.prototype.findIndex` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.findIndex\n  findIndex: createMethod(6)\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\r\n\r\n// Last time updated: 2019-06-15 4:26:11 PM UTC\r\n\r\n// _________________________\r\n// RTCMultiConnection v3.6.9\r\n\r\n// Open-Sourced: https://github.com/muaz-khan/RTCMultiConnection\r\n\r\n// --------------------------------------------------\r\n// Muaz Khan     - www.MuazKhan.com\r\n// MIT License   - www.WebRTC-Experiment.com/licence\r\n// --------------------------------------------------\r\n\r\nvar RTCMultiConnection = function(roomid, forceOptions) {\r\n\r\n    var browserFakeUserAgent = 'Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45';\r\n\r\n    (function(that) {\r\n        if (!that) {\r\n            return;\r\n        }\r\n\r\n        if (typeof window !== 'undefined') {\r\n            return;\r\n        }\r\n\r\n        if (typeof global === 'undefined') {\r\n            return;\r\n        }\r\n\r\n        global.navigator = {\r\n            userAgent: browserFakeUserAgent,\r\n            getUserMedia: function() {}\r\n        };\r\n\r\n        if (!global.console) {\r\n            global.console = {};\r\n        }\r\n\r\n        if (typeof global.console.debug === 'undefined') {\r\n            global.console.debug = global.console.info = global.console.error = global.console.log = global.console.log || function() {\r\n                console.log(arguments);\r\n            };\r\n        }\r\n\r\n        if (typeof document === 'undefined') {\r\n            /*global document:true */\r\n            that.document = {};\r\n\r\n            document.createElement = document.captureStream = document.mozCaptureStream = function() {\r\n                var obj = {\r\n                    getContext: function() {\r\n                        return obj;\r\n                    },\r\n                    play: function() {},\r\n                    pause: function() {},\r\n                    drawImage: function() {},\r\n                    toDataURL: function() {\r\n                        return '';\r\n                    }\r\n                };\r\n                return obj;\r\n            };\r\n\r\n            document.addEventListener = document.removeEventListener = that.addEventListener = that.removeEventListener = function() {};\r\n\r\n            that.HTMLVideoElement = that.HTMLMediaElement = function() {};\r\n        }\r\n\r\n        if (typeof io === 'undefined') {\r\n            that.io = function() {\r\n                return {\r\n                    on: function(eventName, callback) {\r\n                        callback = callback || function() {};\r\n\r\n                        if (eventName === 'connect') {\r\n                            callback();\r\n                        }\r\n                    },\r\n                    emit: function(eventName, data, callback) {\r\n                        callback = callback || function() {};\r\n                        if (eventName === 'open-room' || eventName === 'join-room') {\r\n                            callback(true, data.sessionid, null);\r\n                        }\r\n                    }\r\n                };\r\n            };\r\n        }\r\n\r\n        if (typeof location === 'undefined') {\r\n            /*global location:true */\r\n            that.location = {\r\n                protocol: 'file:',\r\n                href: '',\r\n                hash: '',\r\n                origin: 'self'\r\n            };\r\n        }\r\n\r\n        if (typeof screen === 'undefined') {\r\n            /*global screen:true */\r\n            that.screen = {\r\n                width: 0,\r\n                height: 0\r\n            };\r\n        }\r\n\r\n        if (typeof URL === 'undefined') {\r\n            /*global screen:true */\r\n            that.URL = {\r\n                createObjectURL: function() {\r\n                    return '';\r\n                },\r\n                revokeObjectURL: function() {\r\n                    return '';\r\n                }\r\n            };\r\n        }\r\n\r\n        /*global window:true */\r\n        that.window = global;\r\n    })(typeof global !== 'undefined' ? global : null);\r\n\r\n    function SocketConnection(connection, connectCallback) {\r\n        function isData(session) {\r\n            return !session.audio && !session.video && !session.screen && session.data;\r\n        }\r\n\r\n        var parameters = '';\r\n\r\n        parameters += '?userid=' + connection.userid;\r\n        parameters += '&sessionid=' + connection.sessionid;\r\n        parameters += '&msgEvent=' + connection.socketMessageEvent;\r\n        parameters += '&socketCustomEvent=' + connection.socketCustomEvent;\r\n        parameters += '&autoCloseEntireSession=' + !!connection.autoCloseEntireSession;\r\n\r\n        if (connection.session.broadcast === true) {\r\n            parameters += '&oneToMany=true';\r\n        }\r\n\r\n        parameters += '&maxParticipantsAllowed=' + connection.maxParticipantsAllowed;\r\n\r\n        if (connection.enableScalableBroadcast) {\r\n            parameters += '&enableScalableBroadcast=true';\r\n            parameters += '&maxRelayLimitPerUser=' + (connection.maxRelayLimitPerUser || 2);\r\n        }\r\n\r\n        parameters += '&extra=' + JSON.stringify(connection.extra || {});\r\n\r\n        if (connection.socketCustomParameters) {\r\n            parameters += connection.socketCustomParameters;\r\n        }\r\n\r\n        try {\r\n            io.sockets = {};\r\n        } catch (e) {};\r\n\r\n        if (!connection.socketURL) {\r\n            connection.socketURL = '/';\r\n        }\r\n\r\n        if (connection.socketURL.substr(connection.socketURL.length - 1, 1) != '/') {\r\n            // connection.socketURL = 'https://domain.com:9001/';\r\n            throw '\"socketURL\" MUST end with a slash.';\r\n        }\r\n\r\n        if (connection.enableLogs) {\r\n            if (connection.socketURL == '/') {\r\n                console.info('socket.io url is: ', location.origin + '/');\r\n            } else {\r\n                console.info('socket.io url is: ', connection.socketURL);\r\n            }\r\n        }\r\n\r\n        try {\r\n            connection.socket = io(connection.socketURL + parameters);\r\n        } catch (e) {\r\n            connection.socket = io.connect(connection.socketURL + parameters, connection.socketOptions);\r\n        }\r\n\r\n        var mPeer = connection.multiPeersHandler;\r\n\r\n        connection.socket.on('extra-data-updated', function(remoteUserId, extra) {\r\n            if (!connection.peers[remoteUserId]) return;\r\n            connection.peers[remoteUserId].extra = extra;\r\n\r\n            connection.onExtraDataUpdated({\r\n                userid: remoteUserId,\r\n                extra: extra\r\n            });\r\n\r\n            updateExtraBackup(remoteUserId, extra);\r\n        });\r\n\r\n        function updateExtraBackup(remoteUserId, extra) {\r\n            if (!connection.peersBackup[remoteUserId]) {\r\n                connection.peersBackup[remoteUserId] = {\r\n                    userid: remoteUserId,\r\n                    extra: {}\r\n                };\r\n            }\r\n\r\n            connection.peersBackup[remoteUserId].extra = extra;\r\n        }\r\n\r\n        function onMessageEvent(message) {\r\n            if (message.remoteUserId != connection.userid) return;\r\n\r\n            if (connection.peers[message.sender] && connection.peers[message.sender].extra != message.message.extra) {\r\n                connection.peers[message.sender].extra = message.extra;\r\n                connection.onExtraDataUpdated({\r\n                    userid: message.sender,\r\n                    extra: message.extra\r\n                });\r\n\r\n                updateExtraBackup(message.sender, message.extra);\r\n            }\r\n\r\n            if (message.message.streamSyncNeeded && connection.peers[message.sender]) {\r\n                var stream = connection.streamEvents[message.message.streamid];\r\n                if (!stream || !stream.stream) {\r\n                    return;\r\n                }\r\n\r\n                var action = message.message.action;\r\n\r\n                if (action === 'ended' || action === 'inactive' || action === 'stream-removed') {\r\n                    if (connection.peersBackup[stream.userid]) {\r\n                        stream.extra = connection.peersBackup[stream.userid].extra;\r\n                    }\r\n                    connection.onstreamended(stream);\r\n                    return;\r\n                }\r\n\r\n                var type = message.message.type != 'both' ? message.message.type : null;\r\n\r\n                if (typeof stream.stream[action] == 'function') {\r\n                    stream.stream[action](type);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (message.message === 'dropPeerConnection') {\r\n                connection.deletePeer(message.sender);\r\n                return;\r\n            }\r\n\r\n            if (message.message.allParticipants) {\r\n                if (message.message.allParticipants.indexOf(message.sender) === -1) {\r\n                    message.message.allParticipants.push(message.sender);\r\n                }\r\n\r\n                message.message.allParticipants.forEach(function(participant) {\r\n                    mPeer[!connection.peers[participant] ? 'createNewPeer' : 'renegotiatePeer'](participant, {\r\n                        localPeerSdpConstraints: {\r\n                            OfferToReceiveAudio: connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                            OfferToReceiveVideo: connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                        },\r\n                        remotePeerSdpConstraints: {\r\n                            OfferToReceiveAudio: connection.session.oneway ? !!connection.session.audio : connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                            OfferToReceiveVideo: connection.session.oneway ? !!connection.session.video || !!connection.session.screen : connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                        },\r\n                        isOneWay: !!connection.session.oneway || connection.direction === 'one-way',\r\n                        isDataOnly: isData(connection.session)\r\n                    });\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (message.message.newParticipant) {\r\n                if (message.message.newParticipant == connection.userid) return;\r\n                if (!!connection.peers[message.message.newParticipant]) return;\r\n\r\n                mPeer.createNewPeer(message.message.newParticipant, message.message.userPreferences || {\r\n                    localPeerSdpConstraints: {\r\n                        OfferToReceiveAudio: connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    },\r\n                    remotePeerSdpConstraints: {\r\n                        OfferToReceiveAudio: connection.session.oneway ? !!connection.session.audio : connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: connection.session.oneway ? !!connection.session.video || !!connection.session.screen : connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    },\r\n                    isOneWay: !!connection.session.oneway || connection.direction === 'one-way',\r\n                    isDataOnly: isData(connection.session)\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (message.message.readyForOffer) {\r\n                if (connection.attachStreams.length) {\r\n                    connection.waitingForLocalMedia = false;\r\n                }\r\n\r\n                if (connection.waitingForLocalMedia) {\r\n                    // if someone is waiting to join you\r\n                    // make sure that we've local media before making a handshake\r\n                    setTimeout(function() {\r\n                        onMessageEvent(message);\r\n                    }, 1);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if (message.message.newParticipationRequest && message.sender !== connection.userid) {\r\n                if (connection.peers[message.sender]) {\r\n                    connection.deletePeer(message.sender);\r\n                }\r\n\r\n                var userPreferences = {\r\n                    extra: message.extra || {},\r\n                    localPeerSdpConstraints: message.message.remotePeerSdpConstraints || {\r\n                        OfferToReceiveAudio: connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    },\r\n                    remotePeerSdpConstraints: message.message.localPeerSdpConstraints || {\r\n                        OfferToReceiveAudio: connection.session.oneway ? !!connection.session.audio : connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: connection.session.oneway ? !!connection.session.video || !!connection.session.screen : connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    },\r\n                    isOneWay: typeof message.message.isOneWay !== 'undefined' ? message.message.isOneWay : !!connection.session.oneway || connection.direction === 'one-way',\r\n                    isDataOnly: typeof message.message.isDataOnly !== 'undefined' ? message.message.isDataOnly : isData(connection.session),\r\n                    dontGetRemoteStream: typeof message.message.isOneWay !== 'undefined' ? message.message.isOneWay : !!connection.session.oneway || connection.direction === 'one-way',\r\n                    dontAttachLocalStream: !!message.message.dontGetRemoteStream,\r\n                    connectionDescription: message,\r\n                    successCallback: function() {}\r\n                };\r\n\r\n                connection.onNewParticipant(message.sender, userPreferences);\r\n                return;\r\n            }\r\n\r\n            if (message.message.changedUUID) {\r\n                if (connection.peers[message.message.oldUUID]) {\r\n                    connection.peers[message.message.newUUID] = connection.peers[message.message.oldUUID];\r\n                    delete connection.peers[message.message.oldUUID];\r\n                }\r\n            }\r\n\r\n            if (message.message.userLeft) {\r\n                mPeer.onUserLeft(message.sender);\r\n\r\n                if (!!message.message.autoCloseEntireSession) {\r\n                    connection.leave();\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            mPeer.addNegotiatedMessage(message.message, message.sender);\r\n        }\r\n\r\n        connection.socket.on(connection.socketMessageEvent, onMessageEvent);\r\n\r\n        var alreadyConnected = false;\r\n\r\n        connection.socket.resetProps = function() {\r\n            alreadyConnected = false;\r\n        };\r\n\r\n        connection.socket.on('connect', function() {\r\n            if (alreadyConnected) {\r\n                return;\r\n            }\r\n            alreadyConnected = true;\r\n\r\n            if (connection.enableLogs) {\r\n                console.info('socket.io connection is opened.');\r\n            }\r\n\r\n            setTimeout(function() {\r\n                connection.socket.emit('extra-data-updated', connection.extra);\r\n            }, 1000);\r\n\r\n            if (connectCallback) {\r\n                connectCallback(connection.socket);\r\n            }\r\n        });\r\n\r\n        connection.socket.on('disconnect', function(event) {\r\n            connection.onSocketDisconnect(event);\r\n        });\r\n\r\n        connection.socket.on('error', function(event) {\r\n            connection.onSocketError(event);\r\n        });\r\n\r\n        connection.socket.on('user-disconnected', function(remoteUserId) {\r\n            if (remoteUserId === connection.userid) {\r\n                return;\r\n            }\r\n\r\n            connection.onUserStatusChanged({\r\n                userid: remoteUserId,\r\n                status: 'offline',\r\n                extra: connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra || {} : {}\r\n            });\r\n\r\n            connection.deletePeer(remoteUserId);\r\n        });\r\n\r\n        connection.socket.on('user-connected', function(userid) {\r\n            if (userid === connection.userid) {\r\n                return;\r\n            }\r\n\r\n            connection.onUserStatusChanged({\r\n                userid: userid,\r\n                status: 'online',\r\n                extra: connection.peers[userid] ? connection.peers[userid].extra || {} : {}\r\n            });\r\n        });\r\n\r\n        connection.socket.on('closed-entire-session', function(sessionid, extra) {\r\n            connection.leave();\r\n            connection.onEntireSessionClosed({\r\n                sessionid: sessionid,\r\n                userid: sessionid,\r\n                extra: extra\r\n            });\r\n        });\r\n\r\n        connection.socket.on('userid-already-taken', function(useridAlreadyTaken, yourNewUserId) {\r\n            connection.onUserIdAlreadyTaken(useridAlreadyTaken, yourNewUserId);\r\n        });\r\n\r\n        connection.socket.on('logs', function(log) {\r\n            if (!connection.enableLogs) return;\r\n            console.debug('server-logs', log);\r\n        });\r\n\r\n        connection.socket.on('number-of-broadcast-viewers-updated', function(data) {\r\n            connection.onNumberOfBroadcastViewersUpdated(data);\r\n        });\r\n\r\n        connection.socket.on('set-isInitiator-true', function(sessionid) {\r\n            if (sessionid != connection.sessionid) return;\r\n            connection.isInitiator = true;\r\n        });\r\n    }\r\n\r\n    function MultiPeers(connection) {\r\n        var self = this;\r\n\r\n        var skipPeers = ['getAllParticipants', 'getLength', 'selectFirst', 'streams', 'send', 'forEach'];\r\n        connection.peers = {\r\n            getLength: function() {\r\n                var numberOfPeers = 0;\r\n                for (var peer in this) {\r\n                    if (skipPeers.indexOf(peer) == -1) {\r\n                        numberOfPeers++;\r\n                    }\r\n                }\r\n                return numberOfPeers;\r\n            },\r\n            selectFirst: function() {\r\n                var firstPeer;\r\n                for (var peer in this) {\r\n                    if (skipPeers.indexOf(peer) == -1) {\r\n                        firstPeer = this[peer];\r\n                    }\r\n                }\r\n                return firstPeer;\r\n            },\r\n            getAllParticipants: function(sender) {\r\n                var allPeers = [];\r\n                for (var peer in this) {\r\n                    if (skipPeers.indexOf(peer) == -1 && peer != sender) {\r\n                        allPeers.push(peer);\r\n                    }\r\n                }\r\n                return allPeers;\r\n            },\r\n            forEach: function(callbcak) {\r\n                this.getAllParticipants().forEach(function(participant) {\r\n                    callbcak(connection.peers[participant]);\r\n                });\r\n            },\r\n            send: function(data, remoteUserId) {\r\n                var that = this;\r\n\r\n                if (!isNull(data.size) && !isNull(data.type)) {\r\n                    if (connection.enableFileSharing) {\r\n                        self.shareFile(data, remoteUserId);\r\n                        return;\r\n                    }\r\n\r\n                    if (typeof data !== 'string') {\r\n                        data = JSON.stringify(data);\r\n                    }\r\n                }\r\n\r\n                if (data.type !== 'text' && !(data instanceof ArrayBuffer) && !(data instanceof DataView)) {\r\n                    TextSender.send({\r\n                        text: data,\r\n                        channel: this,\r\n                        connection: connection,\r\n                        remoteUserId: remoteUserId\r\n                    });\r\n                    return;\r\n                }\r\n\r\n                if (data.type === 'text') {\r\n                    data = JSON.stringify(data);\r\n                }\r\n\r\n                if (remoteUserId) {\r\n                    var remoteUser = connection.peers[remoteUserId];\r\n                    if (remoteUser) {\r\n                        if (!remoteUser.channels.length) {\r\n                            connection.peers[remoteUserId].createDataChannel();\r\n                            connection.renegotiate(remoteUserId);\r\n                            setTimeout(function() {\r\n                                that.send(data, remoteUserId);\r\n                            }, 3000);\r\n                            return;\r\n                        }\r\n\r\n                        remoteUser.channels.forEach(function(channel) {\r\n                            channel.send(data);\r\n                        });\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                this.getAllParticipants().forEach(function(participant) {\r\n                    if (!that[participant].channels.length) {\r\n                        connection.peers[participant].createDataChannel();\r\n                        connection.renegotiate(participant);\r\n                        setTimeout(function() {\r\n                            that[participant].channels.forEach(function(channel) {\r\n                                channel.send(data);\r\n                            });\r\n                        }, 3000);\r\n                        return;\r\n                    }\r\n\r\n                    that[participant].channels.forEach(function(channel) {\r\n                        channel.send(data);\r\n                    });\r\n                });\r\n            }\r\n        };\r\n\r\n        this.uuid = connection.userid;\r\n\r\n        this.getLocalConfig = function(remoteSdp, remoteUserId, userPreferences) {\r\n            if (!userPreferences) {\r\n                userPreferences = {};\r\n            }\r\n\r\n            return {\r\n                streamsToShare: userPreferences.streamsToShare || {},\r\n                rtcMultiConnection: connection,\r\n                connectionDescription: userPreferences.connectionDescription,\r\n                userid: remoteUserId,\r\n                localPeerSdpConstraints: userPreferences.localPeerSdpConstraints,\r\n                remotePeerSdpConstraints: userPreferences.remotePeerSdpConstraints,\r\n                dontGetRemoteStream: !!userPreferences.dontGetRemoteStream,\r\n                dontAttachLocalStream: !!userPreferences.dontAttachLocalStream,\r\n                renegotiatingPeer: !!userPreferences.renegotiatingPeer,\r\n                peerRef: userPreferences.peerRef,\r\n                channels: userPreferences.channels || [],\r\n                onLocalSdp: function(localSdp) {\r\n                    self.onNegotiationNeeded(localSdp, remoteUserId);\r\n                },\r\n                onLocalCandidate: function(localCandidate) {\r\n                    localCandidate = OnIceCandidateHandler.processCandidates(connection, localCandidate)\r\n                    if (localCandidate) {\r\n                        self.onNegotiationNeeded(localCandidate, remoteUserId);\r\n                    }\r\n                },\r\n                remoteSdp: remoteSdp,\r\n                onDataChannelMessage: function(message) {\r\n                    if (!connection.fbr && connection.enableFileSharing) initFileBufferReader();\r\n\r\n                    if (typeof message == 'string' || !connection.enableFileSharing) {\r\n                        self.onDataChannelMessage(message, remoteUserId);\r\n                        return;\r\n                    }\r\n\r\n                    var that = this;\r\n\r\n                    if (message instanceof ArrayBuffer || message instanceof DataView) {\r\n                        connection.fbr.convertToObject(message, function(object) {\r\n                            that.onDataChannelMessage(object);\r\n                        });\r\n                        return;\r\n                    }\r\n\r\n                    if (message.readyForNextChunk) {\r\n                        connection.fbr.getNextChunk(message, function(nextChunk, isLastChunk) {\r\n                            connection.peers[remoteUserId].channels.forEach(function(channel) {\r\n                                channel.send(nextChunk);\r\n                            });\r\n                        }, remoteUserId);\r\n                        return;\r\n                    }\r\n\r\n                    if (message.chunkMissing) {\r\n                        connection.fbr.chunkMissing(message);\r\n                        return;\r\n                    }\r\n\r\n                    connection.fbr.addChunk(message, function(promptNextChunk) {\r\n                        connection.peers[remoteUserId].peer.channel.send(promptNextChunk);\r\n                    });\r\n                },\r\n                onDataChannelError: function(error) {\r\n                    self.onDataChannelError(error, remoteUserId);\r\n                },\r\n                onDataChannelOpened: function(channel) {\r\n                    self.onDataChannelOpened(channel, remoteUserId);\r\n                },\r\n                onDataChannelClosed: function(event) {\r\n                    self.onDataChannelClosed(event, remoteUserId);\r\n                },\r\n                onRemoteStream: function(stream) {\r\n                    if (connection.peers[remoteUserId]) {\r\n                        connection.peers[remoteUserId].streams.push(stream);\r\n                    }\r\n\r\n                    self.onGettingRemoteMedia(stream, remoteUserId);\r\n                },\r\n                onRemoteStreamRemoved: function(stream) {\r\n                    self.onRemovingRemoteMedia(stream, remoteUserId);\r\n                },\r\n                onPeerStateChanged: function(states) {\r\n                    self.onPeerStateChanged(states);\r\n\r\n                    if (states.iceConnectionState === 'new') {\r\n                        self.onNegotiationStarted(remoteUserId, states);\r\n                    }\r\n\r\n                    if (states.iceConnectionState === 'connected') {\r\n                        self.onNegotiationCompleted(remoteUserId, states);\r\n                    }\r\n\r\n                    if (states.iceConnectionState.search(/closed|failed/gi) !== -1) {\r\n                        self.onUserLeft(remoteUserId);\r\n                        self.disconnectWith(remoteUserId);\r\n                    }\r\n                }\r\n            };\r\n        };\r\n\r\n        this.createNewPeer = function(remoteUserId, userPreferences) {\r\n            if (connection.maxParticipantsAllowed <= connection.getAllParticipants().length) {\r\n                return;\r\n            }\r\n\r\n            userPreferences = userPreferences || {};\r\n\r\n            if (connection.isInitiator && !!connection.session.audio && connection.session.audio === 'two-way' && !userPreferences.streamsToShare) {\r\n                userPreferences.isOneWay = false;\r\n                userPreferences.isDataOnly = false;\r\n                userPreferences.session = connection.session;\r\n            }\r\n\r\n            if (!userPreferences.isOneWay && !userPreferences.isDataOnly) {\r\n                userPreferences.isOneWay = true;\r\n                this.onNegotiationNeeded({\r\n                    enableMedia: true,\r\n                    userPreferences: userPreferences\r\n                }, remoteUserId);\r\n                return;\r\n            }\r\n\r\n            userPreferences = connection.setUserPreferences(userPreferences, remoteUserId);\r\n            var localConfig = this.getLocalConfig(null, remoteUserId, userPreferences);\r\n            connection.peers[remoteUserId] = new PeerInitiator(localConfig);\r\n        };\r\n\r\n        this.createAnsweringPeer = function(remoteSdp, remoteUserId, userPreferences) {\r\n            userPreferences = connection.setUserPreferences(userPreferences || {}, remoteUserId);\r\n\r\n            var localConfig = this.getLocalConfig(remoteSdp, remoteUserId, userPreferences);\r\n            connection.peers[remoteUserId] = new PeerInitiator(localConfig);\r\n        };\r\n\r\n        this.renegotiatePeer = function(remoteUserId, userPreferences, remoteSdp) {\r\n            if (!connection.peers[remoteUserId]) {\r\n                if (connection.enableLogs) {\r\n                    console.error('Peer (' + remoteUserId + ') does not exist. Renegotiation skipped.');\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (!userPreferences) {\r\n                userPreferences = {};\r\n            }\r\n\r\n            userPreferences.renegotiatingPeer = true;\r\n            userPreferences.peerRef = connection.peers[remoteUserId].peer;\r\n            userPreferences.channels = connection.peers[remoteUserId].channels;\r\n\r\n            var localConfig = this.getLocalConfig(remoteSdp, remoteUserId, userPreferences);\r\n\r\n            connection.peers[remoteUserId] = new PeerInitiator(localConfig);\r\n        };\r\n\r\n        this.replaceTrack = function(track, remoteUserId, isVideoTrack) {\r\n            if (!connection.peers[remoteUserId]) {\r\n                throw 'This peer (' + remoteUserId + ') does not exist.';\r\n            }\r\n\r\n            var peer = connection.peers[remoteUserId].peer;\r\n\r\n            if (!!peer.getSenders && typeof peer.getSenders === 'function' && peer.getSenders().length) {\r\n                peer.getSenders().forEach(function(rtpSender) {\r\n                    if (isVideoTrack && rtpSender.track.kind === 'video') {\r\n                        connection.peers[remoteUserId].peer.lastVideoTrack = rtpSender.track;\r\n                        rtpSender.replaceTrack(track);\r\n                    }\r\n\r\n                    if (!isVideoTrack && rtpSender.track.kind === 'audio') {\r\n                        connection.peers[remoteUserId].peer.lastAudioTrack = rtpSender.track;\r\n                        rtpSender.replaceTrack(track);\r\n                    }\r\n                });\r\n                return;\r\n            }\r\n\r\n            console.warn('RTPSender.replaceTrack is NOT supported.');\r\n            this.renegotiatePeer(remoteUserId);\r\n        };\r\n\r\n        this.onNegotiationNeeded = function(message, remoteUserId) {};\r\n        this.addNegotiatedMessage = function(message, remoteUserId) {\r\n            if (message.type && message.sdp) {\r\n                if (message.type == 'answer') {\r\n                    if (connection.peers[remoteUserId]) {\r\n                        connection.peers[remoteUserId].addRemoteSdp(message);\r\n                    }\r\n                }\r\n\r\n                if (message.type == 'offer') {\r\n                    if (message.renegotiatingPeer) {\r\n                        this.renegotiatePeer(remoteUserId, null, message);\r\n                    } else {\r\n                        this.createAnsweringPeer(message, remoteUserId);\r\n                    }\r\n                }\r\n\r\n                if (connection.enableLogs) {\r\n                    console.log('Remote peer\\'s sdp:', message.sdp);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (message.candidate) {\r\n                if (connection.peers[remoteUserId]) {\r\n                    connection.peers[remoteUserId].addRemoteCandidate(message);\r\n                }\r\n\r\n                if (connection.enableLogs) {\r\n                    console.log('Remote peer\\'s candidate pairs:', message.candidate);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (message.enableMedia) {\r\n                connection.session = message.userPreferences.session || connection.session;\r\n\r\n                if (connection.session.oneway && connection.attachStreams.length) {\r\n                    connection.attachStreams = [];\r\n                }\r\n\r\n                if (message.userPreferences.isDataOnly && connection.attachStreams.length) {\r\n                    connection.attachStreams.length = [];\r\n                }\r\n\r\n                var streamsToShare = {};\r\n                connection.attachStreams.forEach(function(stream) {\r\n                    streamsToShare[stream.streamid] = {\r\n                        isAudio: !!stream.isAudio,\r\n                        isVideo: !!stream.isVideo,\r\n                        isScreen: !!stream.isScreen\r\n                    };\r\n                });\r\n                message.userPreferences.streamsToShare = streamsToShare;\r\n\r\n                self.onNegotiationNeeded({\r\n                    readyForOffer: true,\r\n                    userPreferences: message.userPreferences\r\n                }, remoteUserId);\r\n            }\r\n\r\n            if (message.readyForOffer) {\r\n                connection.onReadyForOffer(remoteUserId, message.userPreferences);\r\n            }\r\n\r\n            function cb(stream) {\r\n                gumCallback(stream, message, remoteUserId);\r\n            }\r\n        };\r\n\r\n        function gumCallback(stream, message, remoteUserId) {\r\n            var streamsToShare = {};\r\n            connection.attachStreams.forEach(function(stream) {\r\n                streamsToShare[stream.streamid] = {\r\n                    isAudio: !!stream.isAudio,\r\n                    isVideo: !!stream.isVideo,\r\n                    isScreen: !!stream.isScreen\r\n                };\r\n            });\r\n            message.userPreferences.streamsToShare = streamsToShare;\r\n\r\n            self.onNegotiationNeeded({\r\n                readyForOffer: true,\r\n                userPreferences: message.userPreferences\r\n            }, remoteUserId);\r\n        }\r\n\r\n        this.onGettingRemoteMedia = function(stream, remoteUserId) {};\r\n        this.onRemovingRemoteMedia = function(stream, remoteUserId) {};\r\n        this.onGettingLocalMedia = function(localStream) {};\r\n        this.onLocalMediaError = function(error, constraints) {\r\n            connection.onMediaError(error, constraints);\r\n        };\r\n\r\n        function initFileBufferReader() {\r\n            connection.fbr = new FileBufferReader();\r\n            connection.fbr.onProgress = function(chunk) {\r\n                connection.onFileProgress(chunk);\r\n            };\r\n            connection.fbr.onBegin = function(file) {\r\n                connection.onFileStart(file);\r\n            };\r\n            connection.fbr.onEnd = function(file) {\r\n                connection.onFileEnd(file);\r\n            };\r\n        }\r\n\r\n        this.shareFile = function(file, remoteUserId) {\r\n            initFileBufferReader();\r\n\r\n            connection.fbr.readAsArrayBuffer(file, function(uuid) {\r\n                var arrayOfUsers = connection.getAllParticipants();\r\n\r\n                if (remoteUserId) {\r\n                    arrayOfUsers = [remoteUserId];\r\n                }\r\n\r\n                arrayOfUsers.forEach(function(participant) {\r\n                    connection.fbr.getNextChunk(uuid, function(nextChunk) {\r\n                        connection.peers[participant].channels.forEach(function(channel) {\r\n                            channel.send(nextChunk);\r\n                        });\r\n                    }, participant);\r\n                });\r\n            }, {\r\n                userid: connection.userid,\r\n                // extra: connection.extra,\r\n                chunkSize: DetectRTC.browser.name === 'Firefox' ? 15 * 1000 : connection.chunkSize || 0\r\n            });\r\n        };\r\n\r\n        if (typeof 'TextReceiver' !== 'undefined') {\r\n            var textReceiver = new TextReceiver(connection);\r\n        }\r\n\r\n        this.onDataChannelMessage = function(message, remoteUserId) {\r\n            textReceiver.receive(JSON.parse(message), remoteUserId, connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {});\r\n        };\r\n\r\n        this.onDataChannelClosed = function(event, remoteUserId) {\r\n            event.userid = remoteUserId;\r\n            event.extra = connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {};\r\n            connection.onclose(event);\r\n        };\r\n\r\n        this.onDataChannelError = function(error, remoteUserId) {\r\n            error.userid = remoteUserId;\r\n            event.extra = connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {};\r\n            connection.onerror(error);\r\n        };\r\n\r\n        this.onDataChannelOpened = function(channel, remoteUserId) {\r\n            // keep last channel only; we are not expecting parallel/channels channels\r\n            if (connection.peers[remoteUserId].channels.length) {\r\n                connection.peers[remoteUserId].channels = [channel];\r\n                return;\r\n            }\r\n\r\n            connection.peers[remoteUserId].channels.push(channel);\r\n            connection.onopen({\r\n                userid: remoteUserId,\r\n                extra: connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {},\r\n                channel: channel\r\n            });\r\n        };\r\n\r\n        this.onPeerStateChanged = function(state) {\r\n            connection.onPeerStateChanged(state);\r\n        };\r\n\r\n        this.onNegotiationStarted = function(remoteUserId, states) {};\r\n        this.onNegotiationCompleted = function(remoteUserId, states) {};\r\n\r\n        this.getRemoteStreams = function(remoteUserId) {\r\n            remoteUserId = remoteUserId || connection.peers.getAllParticipants()[0];\r\n            return connection.peers[remoteUserId] ? connection.peers[remoteUserId].streams : [];\r\n        };\r\n    }\r\n\r\n    'use strict';\r\n\r\n    // Last Updated On: 2019-01-10 5:32:55 AM UTC\r\n\r\n    // ________________\r\n    // DetectRTC v1.3.9\r\n\r\n    // Open-Sourced: https://github.com/muaz-khan/DetectRTC\r\n\r\n    // --------------------------------------------------\r\n    // Muaz Khan     - www.MuazKhan.com\r\n    // MIT License   - www.WebRTC-Experiment.com/licence\r\n    // --------------------------------------------------\r\n\r\n    (function() {\r\n\r\n        var browserFakeUserAgent = 'Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45';\r\n\r\n        var isNodejs = typeof process === 'object' && typeof process.versions === 'object' && process.versions.node && /*node-process*/ !process.browser;\r\n        if (isNodejs) {\r\n            var version = process.versions.node.toString().replace('v', '');\r\n            browserFakeUserAgent = 'Nodejs/' + version + ' (NodeOS) AppleWebKit/' + version + ' (KHTML, like Gecko) Nodejs/' + version + ' Nodejs/' + version\r\n        }\r\n\r\n        (function(that) {\r\n            if (typeof window !== 'undefined') {\r\n                return;\r\n            }\r\n\r\n            if (typeof window === 'undefined' && typeof global !== 'undefined') {\r\n                global.navigator = {\r\n                    userAgent: browserFakeUserAgent,\r\n                    getUserMedia: function() {}\r\n                };\r\n\r\n                /*global window:true */\r\n                that.window = global;\r\n            } else if (typeof window === 'undefined') {\r\n                // window = this;\r\n            }\r\n\r\n            if (typeof location === 'undefined') {\r\n                /*global location:true */\r\n                that.location = {\r\n                    protocol: 'file:',\r\n                    href: '',\r\n                    hash: ''\r\n                };\r\n            }\r\n\r\n            if (typeof screen === 'undefined') {\r\n                /*global screen:true */\r\n                that.screen = {\r\n                    width: 0,\r\n                    height: 0\r\n                };\r\n            }\r\n        })(typeof global !== 'undefined' ? global : window);\r\n\r\n        /*global navigator:true */\r\n        var navigator = window.navigator;\r\n\r\n        if (typeof navigator !== 'undefined') {\r\n            if (typeof navigator.webkitGetUserMedia !== 'undefined') {\r\n                navigator.getUserMedia = navigator.webkitGetUserMedia;\r\n            }\r\n\r\n            if (typeof navigator.mozGetUserMedia !== 'undefined') {\r\n                navigator.getUserMedia = navigator.mozGetUserMedia;\r\n            }\r\n        } else {\r\n            navigator = {\r\n                getUserMedia: function() {},\r\n                userAgent: browserFakeUserAgent\r\n            };\r\n        }\r\n\r\n        var isMobileDevice = !!(/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(navigator.userAgent || ''));\r\n\r\n        var isEdge = navigator.userAgent.indexOf('Edge') !== -1 && (!!navigator.msSaveOrOpenBlob || !!navigator.msSaveBlob);\r\n\r\n        var isOpera = !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;\r\n        var isFirefox = typeof window.InstallTrigger !== 'undefined';\r\n        var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\r\n        var isChrome = !!window.chrome && !isOpera;\r\n        var isIE = typeof document !== 'undefined' && !!document.documentMode && !isEdge;\r\n\r\n        // this one can also be used:\r\n        // https://www.websocket.org/js/stuff.js (DetectBrowser.js)\r\n\r\n        function getBrowserInfo() {\r\n            var nVer = navigator.appVersion;\r\n            var nAgt = navigator.userAgent;\r\n            var browserName = navigator.appName;\r\n            var fullVersion = '' + parseFloat(navigator.appVersion);\r\n            var majorVersion = parseInt(navigator.appVersion, 10);\r\n            var nameOffset, verOffset, ix;\r\n\r\n            // both and safri and chrome has same userAgent\r\n            if (isSafari && !isChrome && nAgt.indexOf('CriOS') !== -1) {\r\n                isSafari = false;\r\n                isChrome = true;\r\n            }\r\n\r\n            // In Opera, the true version is after 'Opera' or after 'Version'\r\n            if (isOpera) {\r\n                browserName = 'Opera';\r\n                try {\r\n                    fullVersion = navigator.userAgent.split('OPR/')[1].split(' ')[0];\r\n                    majorVersion = fullVersion.split('.')[0];\r\n                } catch (e) {\r\n                    fullVersion = '0.0.0.0';\r\n                    majorVersion = 0;\r\n                }\r\n            }\r\n            // In MSIE version <=10, the true version is after 'MSIE' in userAgent\r\n            // In IE 11, look for the string after 'rv:'\r\n            else if (isIE) {\r\n                verOffset = nAgt.indexOf('rv:');\r\n                if (verOffset > 0) { //IE 11\r\n                    fullVersion = nAgt.substring(verOffset + 3);\r\n                } else { //IE 10 or earlier\r\n                    verOffset = nAgt.indexOf('MSIE');\r\n                    fullVersion = nAgt.substring(verOffset + 5);\r\n                }\r\n                browserName = 'IE';\r\n            }\r\n            // In Chrome, the true version is after 'Chrome' \r\n            else if (isChrome) {\r\n                verOffset = nAgt.indexOf('Chrome');\r\n                browserName = 'Chrome';\r\n                fullVersion = nAgt.substring(verOffset + 7);\r\n            }\r\n            // In Safari, the true version is after 'Safari' or after 'Version' \r\n            else if (isSafari) {\r\n                verOffset = nAgt.indexOf('Safari');\r\n\r\n                browserName = 'Safari';\r\n                fullVersion = nAgt.substring(verOffset + 7);\r\n\r\n                if ((verOffset = nAgt.indexOf('Version')) !== -1) {\r\n                    fullVersion = nAgt.substring(verOffset + 8);\r\n                }\r\n\r\n                if (navigator.userAgent.indexOf('Version/') !== -1) {\r\n                    fullVersion = navigator.userAgent.split('Version/')[1].split(' ')[0];\r\n                }\r\n            }\r\n            // In Firefox, the true version is after 'Firefox' \r\n            else if (isFirefox) {\r\n                verOffset = nAgt.indexOf('Firefox');\r\n                browserName = 'Firefox';\r\n                fullVersion = nAgt.substring(verOffset + 8);\r\n            }\r\n\r\n            // In most other browsers, 'name/version' is at the end of userAgent \r\n            else if ((nameOffset = nAgt.lastIndexOf(' ') + 1) < (verOffset = nAgt.lastIndexOf('/'))) {\r\n                browserName = nAgt.substring(nameOffset, verOffset);\r\n                fullVersion = nAgt.substring(verOffset + 1);\r\n\r\n                if (browserName.toLowerCase() === browserName.toUpperCase()) {\r\n                    browserName = navigator.appName;\r\n                }\r\n            }\r\n\r\n            if (isEdge) {\r\n                browserName = 'Edge';\r\n                fullVersion = navigator.userAgent.split('Edge/')[1];\r\n                // fullVersion = parseInt(navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)[2], 10).toString();\r\n            }\r\n\r\n            // trim the fullVersion string at semicolon/space/bracket if present\r\n            if ((ix = fullVersion.search(/[; \\)]/)) !== -1) {\r\n                fullVersion = fullVersion.substring(0, ix);\r\n            }\r\n\r\n            majorVersion = parseInt('' + fullVersion, 10);\r\n\r\n            if (isNaN(majorVersion)) {\r\n                fullVersion = '' + parseFloat(navigator.appVersion);\r\n                majorVersion = parseInt(navigator.appVersion, 10);\r\n            }\r\n\r\n            return {\r\n                fullVersion: fullVersion,\r\n                version: majorVersion,\r\n                name: browserName,\r\n                isPrivateBrowsing: false\r\n            };\r\n        }\r\n\r\n        // via: https://gist.github.com/cou929/7973956\r\n\r\n        function retry(isDone, next) {\r\n            var currentTrial = 0,\r\n                maxRetry = 50,\r\n                interval = 10,\r\n                isTimeout = false;\r\n            var id = window.setInterval(\r\n                function() {\r\n                    if (isDone()) {\r\n                        window.clearInterval(id);\r\n                        next(isTimeout);\r\n                    }\r\n                    if (currentTrial++ > maxRetry) {\r\n                        window.clearInterval(id);\r\n                        isTimeout = true;\r\n                        next(isTimeout);\r\n                    }\r\n                },\r\n                10\r\n            );\r\n        }\r\n\r\n        function isIE10OrLater(userAgent) {\r\n            var ua = userAgent.toLowerCase();\r\n            if (ua.indexOf('msie') === 0 && ua.indexOf('trident') === 0) {\r\n                return false;\r\n            }\r\n            var match = /(?:msie|rv:)\\s?([\\d\\.]+)/.exec(ua);\r\n            if (match && parseInt(match[1], 10) >= 10) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n\r\n        function detectPrivateMode(callback) {\r\n            var isPrivate;\r\n\r\n            try {\r\n\r\n                if (window.webkitRequestFileSystem) {\r\n                    window.webkitRequestFileSystem(\r\n                        window.TEMPORARY, 1,\r\n                        function() {\r\n                            isPrivate = false;\r\n                        },\r\n                        function(e) {\r\n                            isPrivate = true;\r\n                        }\r\n                    );\r\n                } else if (window.indexedDB && /Firefox/.test(window.navigator.userAgent)) {\r\n                    var db;\r\n                    try {\r\n                        db = window.indexedDB.open('test');\r\n                        db.onerror = function() {\r\n                            return true;\r\n                        };\r\n                    } catch (e) {\r\n                        isPrivate = true;\r\n                    }\r\n\r\n                    if (typeof isPrivate === 'undefined') {\r\n                        retry(\r\n                            function isDone() {\r\n                                return db.readyState === 'done' ? true : false;\r\n                            },\r\n                            function next(isTimeout) {\r\n                                if (!isTimeout) {\r\n                                    isPrivate = db.result ? false : true;\r\n                                }\r\n                            }\r\n                        );\r\n                    }\r\n                } else if (isIE10OrLater(window.navigator.userAgent)) {\r\n                    isPrivate = false;\r\n                    try {\r\n                        if (!window.indexedDB) {\r\n                            isPrivate = true;\r\n                        }\r\n                    } catch (e) {\r\n                        isPrivate = true;\r\n                    }\r\n                } else if (window.localStorage && /Safari/.test(window.navigator.userAgent)) {\r\n                    try {\r\n                        window.localStorage.setItem('test', 1);\r\n                    } catch (e) {\r\n                        isPrivate = true;\r\n                    }\r\n\r\n                    if (typeof isPrivate === 'undefined') {\r\n                        isPrivate = false;\r\n                        window.localStorage.removeItem('test');\r\n                    }\r\n                }\r\n\r\n            } catch (e) {\r\n                isPrivate = false;\r\n            }\r\n\r\n            retry(\r\n                function isDone() {\r\n                    return typeof isPrivate !== 'undefined' ? true : false;\r\n                },\r\n                function next(isTimeout) {\r\n                    callback(isPrivate);\r\n                }\r\n            );\r\n        }\r\n\r\n        var isMobile = {\r\n            Android: function() {\r\n                return navigator.userAgent.match(/Android/i);\r\n            },\r\n            BlackBerry: function() {\r\n                return navigator.userAgent.match(/BlackBerry|BB10/i);\r\n            },\r\n            iOS: function() {\r\n                return navigator.userAgent.match(/iPhone|iPad|iPod/i);\r\n            },\r\n            Opera: function() {\r\n                return navigator.userAgent.match(/Opera Mini/i);\r\n            },\r\n            Windows: function() {\r\n                return navigator.userAgent.match(/IEMobile/i);\r\n            },\r\n            any: function() {\r\n                return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());\r\n            },\r\n            getOsName: function() {\r\n                var osName = 'Unknown OS';\r\n                if (isMobile.Android()) {\r\n                    osName = 'Android';\r\n                }\r\n\r\n                if (isMobile.BlackBerry()) {\r\n                    osName = 'BlackBerry';\r\n                }\r\n\r\n                if (isMobile.iOS()) {\r\n                    osName = 'iOS';\r\n                }\r\n\r\n                if (isMobile.Opera()) {\r\n                    osName = 'Opera Mini';\r\n                }\r\n\r\n                if (isMobile.Windows()) {\r\n                    osName = 'Windows';\r\n                }\r\n\r\n                return osName;\r\n            }\r\n        };\r\n\r\n        // via: http://jsfiddle.net/ChristianL/AVyND/\r\n        function detectDesktopOS() {\r\n            var unknown = '-';\r\n\r\n            var nVer = navigator.appVersion;\r\n            var nAgt = navigator.userAgent;\r\n\r\n            var os = unknown;\r\n            var clientStrings = [{\r\n                s: 'Windows 10',\r\n                r: /(Windows 10.0|Windows NT 10.0)/\r\n            }, {\r\n                s: 'Windows 8.1',\r\n                r: /(Windows 8.1|Windows NT 6.3)/\r\n            }, {\r\n                s: 'Windows 8',\r\n                r: /(Windows 8|Windows NT 6.2)/\r\n            }, {\r\n                s: 'Windows 7',\r\n                r: /(Windows 7|Windows NT 6.1)/\r\n            }, {\r\n                s: 'Windows Vista',\r\n                r: /Windows NT 6.0/\r\n            }, {\r\n                s: 'Windows Server 2003',\r\n                r: /Windows NT 5.2/\r\n            }, {\r\n                s: 'Windows XP',\r\n                r: /(Windows NT 5.1|Windows XP)/\r\n            }, {\r\n                s: 'Windows 2000',\r\n                r: /(Windows NT 5.0|Windows 2000)/\r\n            }, {\r\n                s: 'Windows ME',\r\n                r: /(Win 9x 4.90|Windows ME)/\r\n            }, {\r\n                s: 'Windows 98',\r\n                r: /(Windows 98|Win98)/\r\n            }, {\r\n                s: 'Windows 95',\r\n                r: /(Windows 95|Win95|Windows_95)/\r\n            }, {\r\n                s: 'Windows NT 4.0',\r\n                r: /(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/\r\n            }, {\r\n                s: 'Windows CE',\r\n                r: /Windows CE/\r\n            }, {\r\n                s: 'Windows 3.11',\r\n                r: /Win16/\r\n            }, {\r\n                s: 'Android',\r\n                r: /Android/\r\n            }, {\r\n                s: 'Open BSD',\r\n                r: /OpenBSD/\r\n            }, {\r\n                s: 'Sun OS',\r\n                r: /SunOS/\r\n            }, {\r\n                s: 'Linux',\r\n                r: /(Linux|X11)/\r\n            }, {\r\n                s: 'iOS',\r\n                r: /(iPhone|iPad|iPod)/\r\n            }, {\r\n                s: 'Mac OS X',\r\n                r: /Mac OS X/\r\n            }, {\r\n                s: 'Mac OS',\r\n                r: /(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/\r\n            }, {\r\n                s: 'QNX',\r\n                r: /QNX/\r\n            }, {\r\n                s: 'UNIX',\r\n                r: /UNIX/\r\n            }, {\r\n                s: 'BeOS',\r\n                r: /BeOS/\r\n            }, {\r\n                s: 'OS/2',\r\n                r: /OS\\/2/\r\n            }, {\r\n                s: 'Search Bot',\r\n                r: /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\\/Teoma|ia_archiver)/\r\n            }];\r\n            for (var i = 0, cs; cs = clientStrings[i]; i++) {\r\n                if (cs.r.test(nAgt)) {\r\n                    os = cs.s;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            var osVersion = unknown;\r\n\r\n            if (/Windows/.test(os)) {\r\n                if (/Windows (.*)/.test(os)) {\r\n                    osVersion = /Windows (.*)/.exec(os)[1];\r\n                }\r\n                os = 'Windows';\r\n            }\r\n\r\n            switch (os) {\r\n                case 'Mac OS X':\r\n                    if (/Mac OS X (10[\\.\\_\\d]+)/.test(nAgt)) {\r\n                        osVersion = /Mac OS X (10[\\.\\_\\d]+)/.exec(nAgt)[1];\r\n                    }\r\n                    break;\r\n                case 'Android':\r\n                    if (/Android ([\\.\\_\\d]+)/.test(nAgt)) {\r\n                        osVersion = /Android ([\\.\\_\\d]+)/.exec(nAgt)[1];\r\n                    }\r\n                    break;\r\n                case 'iOS':\r\n                    if (/OS (\\d+)_(\\d+)_?(\\d+)?/.test(nAgt)) {\r\n                        osVersion = /OS (\\d+)_(\\d+)_?(\\d+)?/.exec(nVer);\r\n                        osVersion = osVersion[1] + '.' + osVersion[2] + '.' + (osVersion[3] | 0);\r\n                    }\r\n                    break;\r\n            }\r\n\r\n            return {\r\n                osName: os,\r\n                osVersion: osVersion\r\n            };\r\n        }\r\n\r\n        var osName = 'Unknown OS';\r\n        var osVersion = 'Unknown OS Version';\r\n\r\n        function getAndroidVersion(ua) {\r\n            ua = (ua || navigator.userAgent).toLowerCase();\r\n            var match = ua.match(/android\\s([0-9\\.]*)/);\r\n            return match ? match[1] : false;\r\n        }\r\n\r\n        var osInfo = detectDesktopOS();\r\n\r\n        if (osInfo && osInfo.osName && osInfo.osName != '-') {\r\n            osName = osInfo.osName;\r\n            osVersion = osInfo.osVersion;\r\n        } else if (isMobile.any()) {\r\n            osName = isMobile.getOsName();\r\n\r\n            if (osName == 'Android') {\r\n                osVersion = getAndroidVersion();\r\n            }\r\n        }\r\n\r\n        var isNodejs = typeof process === 'object' && typeof process.versions === 'object' && process.versions.node;\r\n\r\n        if (osName === 'Unknown OS' && isNodejs) {\r\n            osName = 'Nodejs';\r\n            osVersion = process.versions.node.toString().replace('v', '');\r\n        }\r\n\r\n        var isCanvasSupportsStreamCapturing = false;\r\n        var isVideoSupportsStreamCapturing = false;\r\n        ['captureStream', 'mozCaptureStream', 'webkitCaptureStream'].forEach(function(item) {\r\n            if (typeof document === 'undefined' || typeof document.createElement !== 'function') {\r\n                return;\r\n            }\r\n\r\n            if (!isCanvasSupportsStreamCapturing && item in document.createElement('canvas')) {\r\n                isCanvasSupportsStreamCapturing = true;\r\n            }\r\n\r\n            if (!isVideoSupportsStreamCapturing && item in document.createElement('video')) {\r\n                isVideoSupportsStreamCapturing = true;\r\n            }\r\n        });\r\n\r\n        var regexIpv4Local = /^(192\\.168\\.|169\\.254\\.|10\\.|172\\.(1[6-9]|2\\d|3[01]))/,\r\n            regexIpv4 = /([0-9]{1,3}(\\.[0-9]{1,3}){3})/,\r\n            regexIpv6 = /[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/;\r\n\r\n        // via: https://github.com/diafygi/webrtc-ips\r\n        function DetectLocalIPAddress(callback, stream) {\r\n            if (!DetectRTC.isWebRTCSupported) {\r\n                return;\r\n            }\r\n\r\n            var isPublic = true,\r\n                isIpv4 = true;\r\n            getIPs(function(ip) {\r\n                if (!ip) {\r\n                    callback(); // Pass nothing to tell that ICE-gathering-ended\r\n                } else if (ip.match(regexIpv4Local)) {\r\n                    isPublic = false;\r\n                    callback('Local: ' + ip, isPublic, isIpv4);\r\n                } else if (ip.match(regexIpv6)) { //via https://ourcodeworld.com/articles/read/257/how-to-get-the-client-ip-address-with-javascript-only\r\n                    isIpv4 = false;\r\n                    callback('Public: ' + ip, isPublic, isIpv4);\r\n                } else {\r\n                    callback('Public: ' + ip, isPublic, isIpv4);\r\n                }\r\n            }, stream);\r\n        }\r\n\r\n        function getIPs(callback, stream) {\r\n            if (typeof document === 'undefined' || typeof document.getElementById !== 'function') {\r\n                return;\r\n            }\r\n\r\n            var ipDuplicates = {};\r\n\r\n            var RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;\r\n\r\n            if (!RTCPeerConnection) {\r\n                var iframe = document.getElementById('iframe');\r\n                if (!iframe) {\r\n                    return;\r\n                }\r\n                var win = iframe.contentWindow;\r\n                RTCPeerConnection = win.RTCPeerConnection || win.mozRTCPeerConnection || win.webkitRTCPeerConnection;\r\n            }\r\n\r\n            if (!RTCPeerConnection) {\r\n                return;\r\n            }\r\n\r\n            var peerConfig = null;\r\n\r\n            if (DetectRTC.browser === 'Chrome' && DetectRTC.browser.version < 58) {\r\n                // todo: add support for older Opera\r\n                peerConfig = {\r\n                    optional: [{\r\n                        RtpDataChannels: true\r\n                    }]\r\n                };\r\n            }\r\n\r\n            var servers = {\r\n                iceServers: [{\r\n                    urls: 'stun:stun.l.google.com:19302'\r\n                }]\r\n            };\r\n\r\n            var pc = new RTCPeerConnection(servers, peerConfig);\r\n\r\n            if (stream) {\r\n                if (pc.addStream) {\r\n                    pc.addStream(stream);\r\n                } else if (pc.addTrack && stream.getTracks()[0]) {\r\n                    pc.addTrack(stream.getTracks()[0], stream);\r\n                }\r\n            }\r\n\r\n            function handleCandidate(candidate) {\r\n                if (!candidate) {\r\n                    callback(); // Pass nothing to tell that ICE-gathering-ended\r\n                    return;\r\n                }\r\n\r\n                var match = regexIpv4.exec(candidate);\r\n                if (!match) {\r\n                    return;\r\n                }\r\n                var ipAddress = match[1];\r\n                var isPublic = (candidate.match(regexIpv4Local)),\r\n                    isIpv4 = true;\r\n\r\n                if (ipDuplicates[ipAddress] === undefined) {\r\n                    callback(ipAddress, isPublic, isIpv4);\r\n                }\r\n\r\n                ipDuplicates[ipAddress] = true;\r\n            }\r\n\r\n            // listen for candidate events\r\n            pc.onicecandidate = function(event) {\r\n                if (event.candidate && event.candidate.candidate) {\r\n                    handleCandidate(event.candidate.candidate);\r\n                } else {\r\n                    handleCandidate(); // Pass nothing to tell that ICE-gathering-ended\r\n                }\r\n            };\r\n\r\n            // create data channel\r\n            if (!stream) {\r\n                try {\r\n                    pc.createDataChannel('sctp', {});\r\n                } catch (e) {}\r\n            }\r\n\r\n            // create an offer sdp\r\n            if (DetectRTC.isPromisesSupported) {\r\n                pc.createOffer().then(function(result) {\r\n                    pc.setLocalDescription(result).then(afterCreateOffer);\r\n                });\r\n            } else {\r\n                pc.createOffer(function(result) {\r\n                    pc.setLocalDescription(result, afterCreateOffer, function() {});\r\n                }, function() {});\r\n            }\r\n\r\n            function afterCreateOffer() {\r\n                var lines = pc.localDescription.sdp.split('\\n');\r\n\r\n                lines.forEach(function(line) {\r\n                    if (line && line.indexOf('a=candidate:') === 0) {\r\n                        handleCandidate(line);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        var MediaDevices = [];\r\n\r\n        var audioInputDevices = [];\r\n        var audioOutputDevices = [];\r\n        var videoInputDevices = [];\r\n\r\n        if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\r\n            // Firefox 38+ seems having support of enumerateDevices\r\n            // Thanks @xdumaine/enumerateDevices\r\n            navigator.enumerateDevices = function(callback) {\r\n                var enumerateDevices = navigator.mediaDevices.enumerateDevices();\r\n                if (enumerateDevices && enumerateDevices.then) {\r\n                    navigator.mediaDevices.enumerateDevices().then(callback).catch(function() {\r\n                        callback([]);\r\n                    });\r\n                } else {\r\n                    callback([]);\r\n                }\r\n            };\r\n        }\r\n\r\n        // Media Devices detection\r\n        var canEnumerate = false;\r\n\r\n        /*global MediaStreamTrack:true */\r\n        if (typeof MediaStreamTrack !== 'undefined' && 'getSources' in MediaStreamTrack) {\r\n            canEnumerate = true;\r\n        } else if (navigator.mediaDevices && !!navigator.mediaDevices.enumerateDevices) {\r\n            canEnumerate = true;\r\n        }\r\n\r\n        var hasMicrophone = false;\r\n        var hasSpeakers = false;\r\n        var hasWebcam = false;\r\n\r\n        var isWebsiteHasMicrophonePermissions = false;\r\n        var isWebsiteHasWebcamPermissions = false;\r\n\r\n        // http://dev.w3.org/2011/webrtc/editor/getusermedia.html#mediadevices\r\n        function checkDeviceSupport(callback) {\r\n            if (!canEnumerate) {\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (!navigator.enumerateDevices && window.MediaStreamTrack && window.MediaStreamTrack.getSources) {\r\n                navigator.enumerateDevices = window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack);\r\n            }\r\n\r\n            if (!navigator.enumerateDevices && navigator.enumerateDevices) {\r\n                navigator.enumerateDevices = navigator.enumerateDevices.bind(navigator);\r\n            }\r\n\r\n            if (!navigator.enumerateDevices) {\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n                return;\r\n            }\r\n\r\n            MediaDevices = [];\r\n\r\n            audioInputDevices = [];\r\n            audioOutputDevices = [];\r\n            videoInputDevices = [];\r\n\r\n            hasMicrophone = false;\r\n            hasSpeakers = false;\r\n            hasWebcam = false;\r\n\r\n            isWebsiteHasMicrophonePermissions = false;\r\n            isWebsiteHasWebcamPermissions = false;\r\n\r\n            // to prevent duplication\r\n            var alreadyUsedDevices = {};\r\n\r\n            navigator.enumerateDevices(function(devices) {\r\n                devices.forEach(function(_device) {\r\n                    var device = {};\r\n                    for (var d in _device) {\r\n                        try {\r\n                            if (typeof _device[d] !== 'function') {\r\n                                device[d] = _device[d];\r\n                            }\r\n                        } catch (e) {}\r\n                    }\r\n\r\n                    if (alreadyUsedDevices[device.deviceId + device.label + device.kind]) {\r\n                        return;\r\n                    }\r\n\r\n                    // if it is MediaStreamTrack.getSources\r\n                    if (device.kind === 'audio') {\r\n                        device.kind = 'audioinput';\r\n                    }\r\n\r\n                    if (device.kind === 'video') {\r\n                        device.kind = 'videoinput';\r\n                    }\r\n\r\n                    if (!device.deviceId) {\r\n                        device.deviceId = device.id;\r\n                    }\r\n\r\n                    if (!device.id) {\r\n                        device.id = device.deviceId;\r\n                    }\r\n\r\n                    if (!device.label) {\r\n                        device.isCustomLabel = true;\r\n\r\n                        if (device.kind === 'videoinput') {\r\n                            device.label = 'Camera ' + (videoInputDevices.length + 1);\r\n                        } else if (device.kind === 'audioinput') {\r\n                            device.label = 'Microphone ' + (audioInputDevices.length + 1);\r\n                        } else if (device.kind === 'audiooutput') {\r\n                            device.label = 'Speaker ' + (audioOutputDevices.length + 1);\r\n                        } else {\r\n                            device.label = 'Please invoke getUserMedia once.';\r\n                        }\r\n\r\n                        if (typeof DetectRTC !== 'undefined' && DetectRTC.browser.isChrome && DetectRTC.browser.version >= 46 && !/^(https:|chrome-extension:)$/g.test(location.protocol || '')) {\r\n                            if (typeof document !== 'undefined' && typeof document.domain === 'string' && document.domain.search && document.domain.search(/localhost|127.0./g) === -1) {\r\n                                device.label = 'HTTPs is required to get label of this ' + device.kind + ' device.';\r\n                            }\r\n                        }\r\n                    } else {\r\n                        // Firefox on Android still returns empty label\r\n                        if (device.kind === 'videoinput' && !isWebsiteHasWebcamPermissions) {\r\n                            isWebsiteHasWebcamPermissions = true;\r\n                        }\r\n\r\n                        if (device.kind === 'audioinput' && !isWebsiteHasMicrophonePermissions) {\r\n                            isWebsiteHasMicrophonePermissions = true;\r\n                        }\r\n                    }\r\n\r\n                    if (device.kind === 'audioinput') {\r\n                        hasMicrophone = true;\r\n\r\n                        if (audioInputDevices.indexOf(device) === -1) {\r\n                            audioInputDevices.push(device);\r\n                        }\r\n                    }\r\n\r\n                    if (device.kind === 'audiooutput') {\r\n                        hasSpeakers = true;\r\n\r\n                        if (audioOutputDevices.indexOf(device) === -1) {\r\n                            audioOutputDevices.push(device);\r\n                        }\r\n                    }\r\n\r\n                    if (device.kind === 'videoinput') {\r\n                        hasWebcam = true;\r\n\r\n                        if (videoInputDevices.indexOf(device) === -1) {\r\n                            videoInputDevices.push(device);\r\n                        }\r\n                    }\r\n\r\n                    // there is no 'videoouput' in the spec.\r\n                    MediaDevices.push(device);\r\n\r\n                    alreadyUsedDevices[device.deviceId + device.label + device.kind] = device;\r\n                });\r\n\r\n                if (typeof DetectRTC !== 'undefined') {\r\n                    // to sync latest outputs\r\n                    DetectRTC.MediaDevices = MediaDevices;\r\n                    DetectRTC.hasMicrophone = hasMicrophone;\r\n                    DetectRTC.hasSpeakers = hasSpeakers;\r\n                    DetectRTC.hasWebcam = hasWebcam;\r\n\r\n                    DetectRTC.isWebsiteHasWebcamPermissions = isWebsiteHasWebcamPermissions;\r\n                    DetectRTC.isWebsiteHasMicrophonePermissions = isWebsiteHasMicrophonePermissions;\r\n\r\n                    DetectRTC.audioInputDevices = audioInputDevices;\r\n                    DetectRTC.audioOutputDevices = audioOutputDevices;\r\n                    DetectRTC.videoInputDevices = videoInputDevices;\r\n                }\r\n\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            });\r\n        }\r\n\r\n        var DetectRTC = window.DetectRTC || {};\r\n\r\n        // ----------\r\n        // DetectRTC.browser.name || DetectRTC.browser.version || DetectRTC.browser.fullVersion\r\n        DetectRTC.browser = getBrowserInfo();\r\n\r\n        detectPrivateMode(function(isPrivateBrowsing) {\r\n            DetectRTC.browser.isPrivateBrowsing = !!isPrivateBrowsing;\r\n        });\r\n\r\n        // DetectRTC.isChrome || DetectRTC.isFirefox || DetectRTC.isEdge\r\n        DetectRTC.browser['is' + DetectRTC.browser.name] = true;\r\n\r\n        // -----------\r\n        DetectRTC.osName = osName;\r\n        DetectRTC.osVersion = osVersion;\r\n\r\n        var isNodeWebkit = typeof process === 'object' && typeof process.versions === 'object' && process.versions['node-webkit'];\r\n\r\n        // --------- Detect if system supports WebRTC 1.0 or WebRTC 1.1.\r\n        var isWebRTCSupported = false;\r\n        ['RTCPeerConnection', 'webkitRTCPeerConnection', 'mozRTCPeerConnection', 'RTCIceGatherer'].forEach(function(item) {\r\n            if (isWebRTCSupported) {\r\n                return;\r\n            }\r\n\r\n            if (item in window) {\r\n                isWebRTCSupported = true;\r\n            }\r\n        });\r\n        DetectRTC.isWebRTCSupported = isWebRTCSupported;\r\n\r\n        //-------\r\n        DetectRTC.isORTCSupported = typeof RTCIceGatherer !== 'undefined';\r\n\r\n        // --------- Detect if system supports screen capturing API\r\n        var isScreenCapturingSupported = false;\r\n        if (DetectRTC.browser.isChrome && DetectRTC.browser.version >= 35) {\r\n            isScreenCapturingSupported = true;\r\n        } else if (DetectRTC.browser.isFirefox && DetectRTC.browser.version >= 34) {\r\n            isScreenCapturingSupported = true;\r\n        } else if (DetectRTC.browser.isEdge && DetectRTC.browser.version >= 17) {\r\n            isScreenCapturingSupported = true; // navigator.getDisplayMedia\r\n        } else if (DetectRTC.osName === 'Android' && DetectRTC.browser.isChrome) {\r\n            isScreenCapturingSupported = true;\r\n        }\r\n\r\n        if (!/^(https:|chrome-extension:)$/g.test(location.protocol || '')) {\r\n            var isNonLocalHost = typeof document !== 'undefined' && typeof document.domain === 'string' && document.domain.search && document.domain.search(/localhost|127.0./g) === -1;\r\n            if (isNonLocalHost && (DetectRTC.browser.isChrome || DetectRTC.browser.isEdge || DetectRTC.browser.isOpera)) {\r\n                isScreenCapturingSupported = false;\r\n            } else if (DetectRTC.browser.isFirefox) {\r\n                isScreenCapturingSupported = false;\r\n            }\r\n        }\r\n        DetectRTC.isScreenCapturingSupported = isScreenCapturingSupported;\r\n\r\n        // --------- Detect if WebAudio API are supported\r\n        var webAudio = {\r\n            isSupported: false,\r\n            isCreateMediaStreamSourceSupported: false\r\n        };\r\n\r\n        ['AudioContext', 'webkitAudioContext', 'mozAudioContext', 'msAudioContext'].forEach(function(item) {\r\n            if (webAudio.isSupported) {\r\n                return;\r\n            }\r\n\r\n            if (item in window) {\r\n                webAudio.isSupported = true;\r\n\r\n                if (window[item] && 'createMediaStreamSource' in window[item].prototype) {\r\n                    webAudio.isCreateMediaStreamSourceSupported = true;\r\n                }\r\n            }\r\n        });\r\n        DetectRTC.isAudioContextSupported = webAudio.isSupported;\r\n        DetectRTC.isCreateMediaStreamSourceSupported = webAudio.isCreateMediaStreamSourceSupported;\r\n\r\n        // ---------- Detect if SCTP/RTP channels are supported.\r\n\r\n        var isRtpDataChannelsSupported = false;\r\n        if (DetectRTC.browser.isChrome && DetectRTC.browser.version > 31) {\r\n            isRtpDataChannelsSupported = true;\r\n        }\r\n        DetectRTC.isRtpDataChannelsSupported = isRtpDataChannelsSupported;\r\n\r\n        var isSCTPSupportd = false;\r\n        if (DetectRTC.browser.isFirefox && DetectRTC.browser.version > 28) {\r\n            isSCTPSupportd = true;\r\n        } else if (DetectRTC.browser.isChrome && DetectRTC.browser.version > 25) {\r\n            isSCTPSupportd = true;\r\n        } else if (DetectRTC.browser.isOpera && DetectRTC.browser.version >= 11) {\r\n            isSCTPSupportd = true;\r\n        }\r\n        DetectRTC.isSctpDataChannelsSupported = isSCTPSupportd;\r\n\r\n        // ---------\r\n\r\n        DetectRTC.isMobileDevice = isMobileDevice; // \"isMobileDevice\" boolean is defined in \"getBrowserInfo.js\"\r\n\r\n        // ------\r\n        var isGetUserMediaSupported = false;\r\n        if (navigator.getUserMedia) {\r\n            isGetUserMediaSupported = true;\r\n        } else if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n            isGetUserMediaSupported = true;\r\n        }\r\n\r\n        if (DetectRTC.browser.isChrome && DetectRTC.browser.version >= 46 && !/^(https:|chrome-extension:)$/g.test(location.protocol || '')) {\r\n            if (typeof document !== 'undefined' && typeof document.domain === 'string' && document.domain.search && document.domain.search(/localhost|127.0./g) === -1) {\r\n                isGetUserMediaSupported = 'Requires HTTPs';\r\n            }\r\n        }\r\n\r\n        if (DetectRTC.osName === 'Nodejs') {\r\n            isGetUserMediaSupported = false;\r\n        }\r\n        DetectRTC.isGetUserMediaSupported = isGetUserMediaSupported;\r\n\r\n        var displayResolution = '';\r\n        if (screen.width) {\r\n            var width = (screen.width) ? screen.width : '';\r\n            var height = (screen.height) ? screen.height : '';\r\n            displayResolution += '' + width + ' x ' + height;\r\n        }\r\n        DetectRTC.displayResolution = displayResolution;\r\n\r\n        function getAspectRatio(w, h) {\r\n            function gcd(a, b) {\r\n                return (b == 0) ? a : gcd(b, a % b);\r\n            }\r\n            var r = gcd(w, h);\r\n            return (w / r) / (h / r);\r\n        }\r\n\r\n        DetectRTC.displayAspectRatio = getAspectRatio(screen.width, screen.height).toFixed(2);\r\n\r\n        // ----------\r\n        DetectRTC.isCanvasSupportsStreamCapturing = isCanvasSupportsStreamCapturing;\r\n        DetectRTC.isVideoSupportsStreamCapturing = isVideoSupportsStreamCapturing;\r\n\r\n        if (DetectRTC.browser.name == 'Chrome' && DetectRTC.browser.version >= 53) {\r\n            if (!DetectRTC.isCanvasSupportsStreamCapturing) {\r\n                DetectRTC.isCanvasSupportsStreamCapturing = 'Requires chrome flag: enable-experimental-web-platform-features';\r\n            }\r\n\r\n            if (!DetectRTC.isVideoSupportsStreamCapturing) {\r\n                DetectRTC.isVideoSupportsStreamCapturing = 'Requires chrome flag: enable-experimental-web-platform-features';\r\n            }\r\n        }\r\n\r\n        // ------\r\n        DetectRTC.DetectLocalIPAddress = DetectLocalIPAddress;\r\n\r\n        DetectRTC.isWebSocketsSupported = 'WebSocket' in window && 2 === window.WebSocket.CLOSING;\r\n        DetectRTC.isWebSocketsBlocked = !DetectRTC.isWebSocketsSupported;\r\n\r\n        if (DetectRTC.osName === 'Nodejs') {\r\n            DetectRTC.isWebSocketsSupported = true;\r\n            DetectRTC.isWebSocketsBlocked = false;\r\n        }\r\n\r\n        DetectRTC.checkWebSocketsSupport = function(callback) {\r\n            callback = callback || function() {};\r\n            try {\r\n                var starttime;\r\n                var websocket = new WebSocket('wss://echo.websocket.org:443/');\r\n                websocket.onopen = function() {\r\n                    DetectRTC.isWebSocketsBlocked = false;\r\n                    starttime = (new Date).getTime();\r\n                    websocket.send('ping');\r\n                };\r\n                websocket.onmessage = function() {\r\n                    DetectRTC.WebsocketLatency = (new Date).getTime() - starttime + 'ms';\r\n                    callback();\r\n                    websocket.close();\r\n                    websocket = null;\r\n                };\r\n                websocket.onerror = function() {\r\n                    DetectRTC.isWebSocketsBlocked = true;\r\n                    callback();\r\n                };\r\n            } catch (e) {\r\n                DetectRTC.isWebSocketsBlocked = true;\r\n                callback();\r\n            }\r\n        };\r\n\r\n        // -------\r\n        DetectRTC.load = function(callback) {\r\n            callback = callback || function() {};\r\n            checkDeviceSupport(callback);\r\n        };\r\n\r\n        // check for microphone/camera support!\r\n        if (typeof checkDeviceSupport === 'function') {\r\n            // checkDeviceSupport();\r\n        }\r\n\r\n        if (typeof MediaDevices !== 'undefined') {\r\n            DetectRTC.MediaDevices = MediaDevices;\r\n        } else {\r\n            DetectRTC.MediaDevices = [];\r\n        }\r\n\r\n        DetectRTC.hasMicrophone = hasMicrophone;\r\n        DetectRTC.hasSpeakers = hasSpeakers;\r\n        DetectRTC.hasWebcam = hasWebcam;\r\n\r\n        DetectRTC.isWebsiteHasWebcamPermissions = isWebsiteHasWebcamPermissions;\r\n        DetectRTC.isWebsiteHasMicrophonePermissions = isWebsiteHasMicrophonePermissions;\r\n\r\n        DetectRTC.audioInputDevices = audioInputDevices;\r\n        DetectRTC.audioOutputDevices = audioOutputDevices;\r\n        DetectRTC.videoInputDevices = videoInputDevices;\r\n\r\n        // ------\r\n        var isSetSinkIdSupported = false;\r\n        if (typeof document !== 'undefined' && typeof document.createElement === 'function' && 'setSinkId' in document.createElement('video')) {\r\n            isSetSinkIdSupported = true;\r\n        }\r\n        DetectRTC.isSetSinkIdSupported = isSetSinkIdSupported;\r\n\r\n        // -----\r\n        var isRTPSenderReplaceTracksSupported = false;\r\n        if (DetectRTC.browser.isFirefox && typeof mozRTCPeerConnection !== 'undefined' /*&& DetectRTC.browser.version > 39*/ ) {\r\n            /*global mozRTCPeerConnection:true */\r\n            if ('getSenders' in mozRTCPeerConnection.prototype) {\r\n                isRTPSenderReplaceTracksSupported = true;\r\n            }\r\n        } else if (DetectRTC.browser.isChrome && typeof webkitRTCPeerConnection !== 'undefined') {\r\n            /*global webkitRTCPeerConnection:true */\r\n            if ('getSenders' in webkitRTCPeerConnection.prototype) {\r\n                isRTPSenderReplaceTracksSupported = true;\r\n            }\r\n        }\r\n        DetectRTC.isRTPSenderReplaceTracksSupported = isRTPSenderReplaceTracksSupported;\r\n\r\n        //------\r\n        var isRemoteStreamProcessingSupported = false;\r\n        if (DetectRTC.browser.isFirefox && DetectRTC.browser.version > 38) {\r\n            isRemoteStreamProcessingSupported = true;\r\n        }\r\n        DetectRTC.isRemoteStreamProcessingSupported = isRemoteStreamProcessingSupported;\r\n\r\n        //-------\r\n        var isApplyConstraintsSupported = false;\r\n\r\n        /*global MediaStreamTrack:true */\r\n        if (typeof MediaStreamTrack !== 'undefined' && 'applyConstraints' in MediaStreamTrack.prototype) {\r\n            isApplyConstraintsSupported = true;\r\n        }\r\n        DetectRTC.isApplyConstraintsSupported = isApplyConstraintsSupported;\r\n\r\n        //-------\r\n        var isMultiMonitorScreenCapturingSupported = false;\r\n        if (DetectRTC.browser.isFirefox && DetectRTC.browser.version >= 43) {\r\n            // version 43 merely supports platforms for multi-monitors\r\n            // version 44 will support exact multi-monitor selection i.e. you can select any monitor for screen capturing.\r\n            isMultiMonitorScreenCapturingSupported = true;\r\n        }\r\n        DetectRTC.isMultiMonitorScreenCapturingSupported = isMultiMonitorScreenCapturingSupported;\r\n\r\n        DetectRTC.isPromisesSupported = !!('Promise' in window);\r\n\r\n        // version is generated by \"grunt\"\r\n        DetectRTC.version = '1.3.9';\r\n\r\n        if (typeof DetectRTC === 'undefined') {\r\n            window.DetectRTC = {};\r\n        }\r\n\r\n        var MediaStream = window.MediaStream;\r\n\r\n        if (typeof MediaStream === 'undefined' && typeof webkitMediaStream !== 'undefined') {\r\n            MediaStream = webkitMediaStream;\r\n        }\r\n\r\n        if (typeof MediaStream !== 'undefined' && typeof MediaStream === 'function') {\r\n            DetectRTC.MediaStream = Object.keys(MediaStream.prototype);\r\n        } else DetectRTC.MediaStream = false;\r\n\r\n        if (typeof MediaStreamTrack !== 'undefined') {\r\n            DetectRTC.MediaStreamTrack = Object.keys(MediaStreamTrack.prototype);\r\n        } else DetectRTC.MediaStreamTrack = false;\r\n\r\n        var RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;\r\n\r\n        if (typeof RTCPeerConnection !== 'undefined') {\r\n            DetectRTC.RTCPeerConnection = Object.keys(RTCPeerConnection.prototype);\r\n        } else DetectRTC.RTCPeerConnection = false;\r\n\r\n        window.DetectRTC = DetectRTC;\r\n\r\n        if (typeof module !== 'undefined' /* && !!module.exports*/ ) {\r\n            module.exports = DetectRTC;\r\n        }\r\n\r\n        if (typeof define === 'function' && define.amd) {\r\n            define('DetectRTC', [], function() {\r\n                return DetectRTC;\r\n            });\r\n        }\r\n    })();\r\n\r\n    // globals.js\r\n\r\n    if (typeof cordova !== 'undefined') {\r\n        DetectRTC.isMobileDevice = true;\r\n        DetectRTC.browser.name = 'Chrome';\r\n    }\r\n\r\n    if (navigator && navigator.userAgent && navigator.userAgent.indexOf('Crosswalk') !== -1) {\r\n        DetectRTC.isMobileDevice = true;\r\n        DetectRTC.browser.name = 'Chrome';\r\n    }\r\n\r\n    function fireEvent(obj, eventName, args) {\r\n        if (typeof CustomEvent === 'undefined') {\r\n            return;\r\n        }\r\n\r\n        var eventDetail = {\r\n            arguments: args,\r\n            __exposedProps__: args\r\n        };\r\n\r\n        var event = new CustomEvent(eventName, eventDetail);\r\n        obj.dispatchEvent(event);\r\n    }\r\n\r\n    function setHarkEvents(connection, streamEvent) {\r\n        if (!streamEvent.stream || !getTracks(streamEvent.stream, 'audio').length) return;\r\n\r\n        if (!connection || !streamEvent) {\r\n            throw 'Both arguments are required.';\r\n        }\r\n\r\n        if (!connection.onspeaking || !connection.onsilence) {\r\n            return;\r\n        }\r\n\r\n        if (typeof hark === 'undefined') {\r\n            throw 'hark.js not found.';\r\n        }\r\n\r\n        hark(streamEvent.stream, {\r\n            onspeaking: function() {\r\n                connection.onspeaking(streamEvent);\r\n            },\r\n            onsilence: function() {\r\n                connection.onsilence(streamEvent);\r\n            },\r\n            onvolumechange: function(volume, threshold) {\r\n                if (!connection.onvolumechange) {\r\n                    return;\r\n                }\r\n                connection.onvolumechange(merge({\r\n                    volume: volume,\r\n                    threshold: threshold\r\n                }, streamEvent));\r\n            }\r\n        });\r\n    }\r\n\r\n    function setMuteHandlers(connection, streamEvent) {\r\n        if (!streamEvent.stream || !streamEvent.stream || !streamEvent.stream.addEventListener) return;\r\n\r\n        streamEvent.stream.addEventListener('mute', function(event) {\r\n            event = connection.streamEvents[streamEvent.streamid];\r\n\r\n            event.session = {\r\n                audio: event.muteType === 'audio',\r\n                video: event.muteType === 'video'\r\n            };\r\n\r\n            connection.onmute(event);\r\n        }, false);\r\n\r\n        streamEvent.stream.addEventListener('unmute', function(event) {\r\n            event = connection.streamEvents[streamEvent.streamid];\r\n\r\n            event.session = {\r\n                audio: event.unmuteType === 'audio',\r\n                video: event.unmuteType === 'video'\r\n            };\r\n\r\n            connection.onunmute(event);\r\n        }, false);\r\n    }\r\n\r\n    function getRandomString() {\r\n        if (window.crypto && window.crypto.getRandomValues && navigator.userAgent.indexOf('Safari') === -1) {\r\n            var a = window.crypto.getRandomValues(new Uint32Array(3)),\r\n                token = '';\r\n            for (var i = 0, l = a.length; i < l; i++) {\r\n                token += a[i].toString(36);\r\n            }\r\n            return token;\r\n        } else {\r\n            return (Math.random() * new Date().getTime()).toString(36).replace(/\\./g, '');\r\n        }\r\n    }\r\n\r\n    // Get HTMLAudioElement/HTMLVideoElement accordingly\r\n    // todo: add API documentation for connection.autoCreateMediaElement\r\n\r\n    function getRMCMediaElement(stream, callback, connection) {\r\n        if (!connection.autoCreateMediaElement) {\r\n            callback({});\r\n            return;\r\n        }\r\n\r\n        var isAudioOnly = false;\r\n        if (!getTracks(stream, 'video').length && !stream.isVideo && !stream.isScreen) {\r\n            isAudioOnly = true;\r\n        }\r\n\r\n        if (DetectRTC.browser.name === 'Firefox') {\r\n            if (connection.session.video || connection.session.screen) {\r\n                isAudioOnly = false;\r\n            }\r\n        }\r\n\r\n        var mediaElement = document.createElement(isAudioOnly ? 'audio' : 'video');\r\n\r\n        mediaElement.srcObject = stream;\r\n\r\n        mediaElement.setAttribute('autoplay', true);\r\n        mediaElement.setAttribute('playsinline', true);\r\n        mediaElement.setAttribute('controls', true);\r\n        mediaElement.setAttribute('muted', false);\r\n        mediaElement.setAttribute('volume', 1);\r\n\r\n        // http://goo.gl/WZ5nFl\r\n        // Firefox don't yet support onended for any stream (remote/local)\r\n        if (DetectRTC.browser.name === 'Firefox') {\r\n            var streamEndedEvent = 'ended';\r\n\r\n            if ('oninactive' in mediaElement) {\r\n                streamEndedEvent = 'inactive';\r\n            }\r\n\r\n            mediaElement.addEventListener(streamEndedEvent, function() {\r\n                // fireEvent(stream, streamEndedEvent, stream);\r\n                currentUserMediaRequest.remove(stream.idInstance);\r\n\r\n                if (stream.type === 'local') {\r\n                    streamEndedEvent = 'ended';\r\n\r\n                    if ('oninactive' in stream) {\r\n                        streamEndedEvent = 'inactive';\r\n                    }\r\n\r\n                    StreamsHandler.onSyncNeeded(stream.streamid, streamEndedEvent);\r\n\r\n                    connection.attachStreams.forEach(function(aStream, idx) {\r\n                        if (stream.streamid === aStream.streamid) {\r\n                            delete connection.attachStreams[idx];\r\n                        }\r\n                    });\r\n\r\n                    var newStreamsArray = [];\r\n                    connection.attachStreams.forEach(function(aStream) {\r\n                        if (aStream) {\r\n                            newStreamsArray.push(aStream);\r\n                        }\r\n                    });\r\n                    connection.attachStreams = newStreamsArray;\r\n\r\n                    var streamEvent = connection.streamEvents[stream.streamid];\r\n\r\n                    if (streamEvent) {\r\n                        connection.onstreamended(streamEvent);\r\n                        return;\r\n                    }\r\n                    if (this.parentNode) {\r\n                        this.parentNode.removeChild(this);\r\n                    }\r\n                }\r\n            }, false);\r\n        }\r\n\r\n        var played = mediaElement.play();\r\n        if (typeof played !== 'undefined') {\r\n            var cbFired = false;\r\n            setTimeout(function() {\r\n                if (!cbFired) {\r\n                    cbFired = true;\r\n                    callback(mediaElement);\r\n                }\r\n            }, 1000);\r\n            played.then(function() {\r\n                if (cbFired) return;\r\n                cbFired = true;\r\n                callback(mediaElement);\r\n            }).catch(function(error) {\r\n                if (cbFired) return;\r\n                cbFired = true;\r\n                callback(mediaElement);\r\n            });\r\n        } else {\r\n            callback(mediaElement);\r\n        }\r\n    }\r\n\r\n    // if IE\r\n    if (!window.addEventListener) {\r\n        window.addEventListener = function(el, eventName, eventHandler) {\r\n            if (!el.attachEvent) {\r\n                return;\r\n            }\r\n            el.attachEvent('on' + eventName, eventHandler);\r\n        };\r\n    }\r\n\r\n    function listenEventHandler(eventName, eventHandler) {\r\n        window.removeEventListener(eventName, eventHandler);\r\n        window.addEventListener(eventName, eventHandler, false);\r\n    }\r\n\r\n    window.attachEventListener = function(video, type, listener, useCapture) {\r\n        video.addEventListener(type, listener, useCapture);\r\n    };\r\n\r\n    function removeNullEntries(array) {\r\n        var newArray = [];\r\n        array.forEach(function(item) {\r\n            if (item) {\r\n                newArray.push(item);\r\n            }\r\n        });\r\n        return newArray;\r\n    }\r\n\r\n\r\n    function isData(session) {\r\n        return !session.audio && !session.video && !session.screen && session.data;\r\n    }\r\n\r\n    function isNull(obj) {\r\n        return typeof obj === 'undefined';\r\n    }\r\n\r\n    function isString(obj) {\r\n        return typeof obj === 'string';\r\n    }\r\n\r\n    var MediaStream = window.MediaStream;\r\n\r\n    if (typeof MediaStream === 'undefined' && typeof webkitMediaStream !== 'undefined') {\r\n        MediaStream = webkitMediaStream;\r\n    }\r\n\r\n    /*global MediaStream:true */\r\n    if (typeof MediaStream !== 'undefined') {\r\n        if (!('stop' in MediaStream.prototype)) {\r\n            MediaStream.prototype.stop = function() {\r\n                this.getTracks().forEach(function(track) {\r\n                    track.stop();\r\n                });\r\n            };\r\n        }\r\n    }\r\n\r\n    function isAudioPlusTab(connection, audioPlusTab) {\r\n        if (connection.session.audio && connection.session.audio === 'two-way') {\r\n            return false;\r\n        }\r\n\r\n        if (DetectRTC.browser.name === 'Firefox' && audioPlusTab !== false) {\r\n            return true;\r\n        }\r\n\r\n        if (DetectRTC.browser.name !== 'Chrome' || DetectRTC.browser.version < 50) return false;\r\n\r\n        if (typeof audioPlusTab === true) {\r\n            return true;\r\n        }\r\n\r\n        if (typeof audioPlusTab === 'undefined' && connection.session.audio && connection.session.screen && !connection.session.video) {\r\n            audioPlusTab = true;\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function getAudioScreenConstraints(screen_constraints) {\r\n        if (DetectRTC.browser.name === 'Firefox') {\r\n            return true;\r\n        }\r\n\r\n        if (DetectRTC.browser.name !== 'Chrome') return false;\r\n\r\n        return {\r\n            mandatory: {\r\n                chromeMediaSource: screen_constraints.mandatory.chromeMediaSource,\r\n                chromeMediaSourceId: screen_constraints.mandatory.chromeMediaSourceId\r\n            }\r\n        };\r\n    }\r\n\r\n    window.iOSDefaultAudioOutputDevice = window.iOSDefaultAudioOutputDevice || 'speaker'; // earpiece or speaker\r\n\r\n    function getTracks(stream, kind) {\r\n        if (!stream || !stream.getTracks) {\r\n            return [];\r\n        }\r\n\r\n        return stream.getTracks().filter(function(t) {\r\n            return t.kind === (kind || 'audio');\r\n        });\r\n    }\r\n\r\n    function isUnifiedPlanSupportedDefault() {\r\n        var canAddTransceiver = false;\r\n\r\n        try {\r\n            if (typeof RTCRtpTransceiver === 'undefined') return false;\r\n            if (!('currentDirection' in RTCRtpTransceiver.prototype)) return false;\r\n\r\n            var tempPc = new RTCPeerConnection();\r\n\r\n            try {\r\n                tempPc.addTransceiver('audio');\r\n                canAddTransceiver = true;\r\n            } catch (e) {}\r\n\r\n            tempPc.close();\r\n        } catch (e) {\r\n            canAddTransceiver = false;\r\n        }\r\n\r\n        return canAddTransceiver && isUnifiedPlanSuppored();\r\n    }\r\n\r\n    function isUnifiedPlanSuppored() {\r\n        var isUnifiedPlanSupported = false;\r\n\r\n        try {\r\n            var pc = new RTCPeerConnection({\r\n                sdpSemantics: 'unified-plan'\r\n            });\r\n\r\n            try {\r\n                var config = pc.getConfiguration();\r\n                if (config.sdpSemantics == 'unified-plan')\r\n                    isUnifiedPlanSupported = true;\r\n                else if (config.sdpSemantics == 'plan-b')\r\n                    isUnifiedPlanSupported = false;\r\n                else\r\n                    isUnifiedPlanSupported = false;\r\n            } catch (e) {\r\n                isUnifiedPlanSupported = false;\r\n            }\r\n        } catch (e) {\r\n            isUnifiedPlanSupported = false;\r\n        }\r\n\r\n        return isUnifiedPlanSupported;\r\n    }\r\n\r\n    // ios-hacks.js\r\n\r\n    function setCordovaAPIs() {\r\n        // if (DetectRTC.osName !== 'iOS') return;\r\n        if (typeof cordova === 'undefined' || typeof cordova.plugins === 'undefined' || typeof cordova.plugins.iosrtc === 'undefined') return;\r\n\r\n        var iosrtc = cordova.plugins.iosrtc;\r\n        window.webkitRTCPeerConnection = iosrtc.RTCPeerConnection;\r\n        window.RTCSessionDescription = iosrtc.RTCSessionDescription;\r\n        window.RTCIceCandidate = iosrtc.RTCIceCandidate;\r\n        window.MediaStream = iosrtc.MediaStream;\r\n        window.MediaStreamTrack = iosrtc.MediaStreamTrack;\r\n        navigator.getUserMedia = navigator.webkitGetUserMedia = iosrtc.getUserMedia;\r\n\r\n        iosrtc.debug.enable('iosrtc*');\r\n        if (typeof iosrtc.selectAudioOutput == 'function') {\r\n            iosrtc.selectAudioOutput(window.iOSDefaultAudioOutputDevice || 'speaker'); // earpiece or speaker\r\n        }\r\n        iosrtc.registerGlobals();\r\n    }\r\n\r\n    document.addEventListener('deviceready', setCordovaAPIs, false);\r\n    setCordovaAPIs();\r\n\r\n    // RTCPeerConnection.js\r\n\r\n    var defaults = {};\r\n\r\n    function setSdpConstraints(config) {\r\n        var sdpConstraints = {\r\n            OfferToReceiveAudio: !!config.OfferToReceiveAudio,\r\n            OfferToReceiveVideo: !!config.OfferToReceiveVideo\r\n        };\r\n\r\n        return sdpConstraints;\r\n    }\r\n\r\n    var RTCPeerConnection;\r\n    if (typeof window.RTCPeerConnection !== 'undefined') {\r\n        RTCPeerConnection = window.RTCPeerConnection;\r\n    } else if (typeof mozRTCPeerConnection !== 'undefined') {\r\n        RTCPeerConnection = mozRTCPeerConnection;\r\n    } else if (typeof webkitRTCPeerConnection !== 'undefined') {\r\n        RTCPeerConnection = webkitRTCPeerConnection;\r\n    }\r\n\r\n    var RTCSessionDescription = window.RTCSessionDescription || window.mozRTCSessionDescription;\r\n    var RTCIceCandidate = window.RTCIceCandidate || window.mozRTCIceCandidate;\r\n    var MediaStreamTrack = window.MediaStreamTrack;\r\n\r\n    function PeerInitiator(config) {\r\n        if (typeof window.RTCPeerConnection !== 'undefined') {\r\n            RTCPeerConnection = window.RTCPeerConnection;\r\n        } else if (typeof mozRTCPeerConnection !== 'undefined') {\r\n            RTCPeerConnection = mozRTCPeerConnection;\r\n        } else if (typeof webkitRTCPeerConnection !== 'undefined') {\r\n            RTCPeerConnection = webkitRTCPeerConnection;\r\n        }\r\n\r\n        RTCSessionDescription = window.RTCSessionDescription || window.mozRTCSessionDescription;\r\n        RTCIceCandidate = window.RTCIceCandidate || window.mozRTCIceCandidate;\r\n        MediaStreamTrack = window.MediaStreamTrack;\r\n\r\n        if (!RTCPeerConnection) {\r\n            throw 'WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.';\r\n        }\r\n\r\n        var connection = config.rtcMultiConnection;\r\n\r\n        this.extra = config.remoteSdp ? config.remoteSdp.extra : connection.extra;\r\n        this.userid = config.userid;\r\n        this.streams = [];\r\n        this.channels = config.channels || [];\r\n        this.connectionDescription = config.connectionDescription;\r\n\r\n        this.addStream = function(session) {\r\n            connection.addStream(session, self.userid);\r\n        };\r\n\r\n        this.removeStream = function(streamid) {\r\n            connection.removeStream(streamid, self.userid);\r\n        };\r\n\r\n        var self = this;\r\n\r\n        if (config.remoteSdp) {\r\n            this.connectionDescription = config.remoteSdp.connectionDescription;\r\n        }\r\n\r\n        var allRemoteStreams = {};\r\n\r\n        defaults.sdpConstraints = setSdpConstraints({\r\n            OfferToReceiveAudio: true,\r\n            OfferToReceiveVideo: true\r\n        });\r\n\r\n        var peer;\r\n\r\n        var renegotiatingPeer = !!config.renegotiatingPeer;\r\n        if (config.remoteSdp) {\r\n            renegotiatingPeer = !!config.remoteSdp.renegotiatingPeer;\r\n        }\r\n\r\n        var localStreams = [];\r\n        connection.attachStreams.forEach(function(stream) {\r\n            if (!!stream) {\r\n                localStreams.push(stream);\r\n            }\r\n        });\r\n\r\n        if (!renegotiatingPeer) {\r\n            var iceTransports = 'all';\r\n            if (connection.candidates.turn || connection.candidates.relay) {\r\n                if (!connection.candidates.stun && !connection.candidates.reflexive && !connection.candidates.host) {\r\n                    iceTransports = 'relay';\r\n                }\r\n            }\r\n\r\n            try {\r\n                // ref: developer.mozilla.org/en-US/docs/Web/API/RTCConfiguration\r\n                var params = {\r\n                    iceServers: connection.iceServers,\r\n                    iceTransportPolicy: connection.iceTransportPolicy || iceTransports\r\n                };\r\n\r\n                if (typeof connection.iceCandidatePoolSize !== 'undefined') {\r\n                    params.iceCandidatePoolSize = connection.iceCandidatePoolSize;\r\n                }\r\n\r\n                if (typeof connection.bundlePolicy !== 'undefined') {\r\n                    params.bundlePolicy = connection.bundlePolicy;\r\n                }\r\n\r\n                if (typeof connection.rtcpMuxPolicy !== 'undefined') {\r\n                    params.rtcpMuxPolicy = connection.rtcpMuxPolicy;\r\n                }\r\n\r\n                if (!!connection.sdpSemantics) {\r\n                    params.sdpSemantics = connection.sdpSemantics || 'unified-plan';\r\n                }\r\n\r\n                if (!connection.iceServers || !connection.iceServers.length) {\r\n                    params = null;\r\n                    connection.optionalArgument = null;\r\n                }\r\n\r\n                peer = new RTCPeerConnection(params, connection.optionalArgument);\r\n            } catch (e) {\r\n                try {\r\n                    var params = {\r\n                        iceServers: connection.iceServers\r\n                    };\r\n\r\n                    peer = new RTCPeerConnection(params);\r\n                } catch (e) {\r\n                    peer = new RTCPeerConnection();\r\n                }\r\n            }\r\n        } else {\r\n            peer = config.peerRef;\r\n        }\r\n\r\n        if (!peer.getRemoteStreams && peer.getReceivers) {\r\n            peer.getRemoteStreams = function() {\r\n                var stream = new MediaStream();\r\n                peer.getReceivers().forEach(function(receiver) {\r\n                    stream.addTrack(receiver.track);\r\n                });\r\n                return [stream];\r\n            };\r\n        }\r\n\r\n        if (!peer.getLocalStreams && peer.getSenders) {\r\n            peer.getLocalStreams = function() {\r\n                var stream = new MediaStream();\r\n                peer.getSenders().forEach(function(sender) {\r\n                    stream.addTrack(sender.track);\r\n                });\r\n                return [stream];\r\n            };\r\n        }\r\n\r\n        peer.onicecandidate = function(event) {\r\n            if (!event.candidate) {\r\n                if (!connection.trickleIce) {\r\n                    var localSdp = peer.localDescription;\r\n                    config.onLocalSdp({\r\n                        type: localSdp.type,\r\n                        sdp: localSdp.sdp,\r\n                        remotePeerSdpConstraints: config.remotePeerSdpConstraints || false,\r\n                        renegotiatingPeer: !!config.renegotiatingPeer || false,\r\n                        connectionDescription: self.connectionDescription,\r\n                        dontGetRemoteStream: !!config.dontGetRemoteStream,\r\n                        extra: connection ? connection.extra : {},\r\n                        streamsToShare: streamsToShare\r\n                    });\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (!connection.trickleIce) return;\r\n            config.onLocalCandidate({\r\n                candidate: event.candidate.candidate,\r\n                sdpMid: event.candidate.sdpMid,\r\n                sdpMLineIndex: event.candidate.sdpMLineIndex\r\n            });\r\n        };\r\n\r\n        localStreams.forEach(function(localStream) {\r\n            if (config.remoteSdp && config.remoteSdp.remotePeerSdpConstraints && config.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream) {\r\n                return;\r\n            }\r\n\r\n            if (config.dontAttachLocalStream) {\r\n                return;\r\n            }\r\n\r\n            localStream = connection.beforeAddingStream(localStream, self);\r\n\r\n            if (!localStream) return;\r\n\r\n            peer.getLocalStreams().forEach(function(stream) {\r\n                if (localStream && stream.id == localStream.id) {\r\n                    localStream = null;\r\n                }\r\n            });\r\n\r\n            if (localStream && localStream.getTracks) {\r\n                localStream.getTracks().forEach(function(track) {\r\n                    try {\r\n                        // last parameter is redundant for unified-plan\r\n                        // starting from chrome version 72\r\n                        peer.addTrack(track, localStream);\r\n                    } catch (e) {}\r\n                });\r\n            }\r\n        });\r\n\r\n        peer.oniceconnectionstatechange = peer.onsignalingstatechange = function() {\r\n            var extra = self.extra;\r\n            if (connection.peers[self.userid]) {\r\n                extra = connection.peers[self.userid].extra || extra;\r\n            }\r\n\r\n            if (!peer) {\r\n                return;\r\n            }\r\n\r\n            config.onPeerStateChanged({\r\n                iceConnectionState: peer.iceConnectionState,\r\n                iceGatheringState: peer.iceGatheringState,\r\n                signalingState: peer.signalingState,\r\n                extra: extra,\r\n                userid: self.userid\r\n            });\r\n\r\n            if (peer && peer.iceConnectionState && peer.iceConnectionState.search(/closed|failed/gi) !== -1 && self.streams instanceof Array) {\r\n                self.streams.forEach(function(stream) {\r\n                    var streamEvent = connection.streamEvents[stream.id] || {\r\n                        streamid: stream.id,\r\n                        stream: stream,\r\n                        type: 'remote'\r\n                    };\r\n\r\n                    connection.onstreamended(streamEvent);\r\n                });\r\n            }\r\n        };\r\n\r\n        var sdpConstraints = {\r\n            OfferToReceiveAudio: !!localStreams.length,\r\n            OfferToReceiveVideo: !!localStreams.length\r\n        };\r\n\r\n        if (config.localPeerSdpConstraints) sdpConstraints = config.localPeerSdpConstraints;\r\n\r\n        defaults.sdpConstraints = setSdpConstraints(sdpConstraints);\r\n\r\n        var streamObject;\r\n        var dontDuplicate = {};\r\n\r\n        peer.ontrack = function(event) {\r\n            if (!event || event.type !== 'track') return;\r\n\r\n            event.stream = event.streams[event.streams.length - 1];\r\n\r\n            if (!event.stream.id) {\r\n                event.stream.id = event.track.id;\r\n            }\r\n\r\n            if (dontDuplicate[event.stream.id] && DetectRTC.browser.name !== 'Safari') {\r\n                if (event.track) {\r\n                    event.track.onended = function() { // event.track.onmute = \r\n                        peer && peer.onremovestream(event);\r\n                    };\r\n                }\r\n                return;\r\n            }\r\n\r\n            dontDuplicate[event.stream.id] = event.stream.id;\r\n\r\n            var streamsToShare = {};\r\n            if (config.remoteSdp && config.remoteSdp.streamsToShare) {\r\n                streamsToShare = config.remoteSdp.streamsToShare;\r\n            } else if (config.streamsToShare) {\r\n                streamsToShare = config.streamsToShare;\r\n            }\r\n\r\n            var streamToShare = streamsToShare[event.stream.id];\r\n            if (streamToShare) {\r\n                event.stream.isAudio = streamToShare.isAudio;\r\n                event.stream.isVideo = streamToShare.isVideo;\r\n                event.stream.isScreen = streamToShare.isScreen;\r\n            } else {\r\n                event.stream.isVideo = !!getTracks(event.stream, 'video').length;\r\n                event.stream.isAudio = !event.stream.isVideo;\r\n                event.stream.isScreen = false;\r\n            }\r\n\r\n            event.stream.streamid = event.stream.id;\r\n\r\n            allRemoteStreams[event.stream.id] = event.stream;\r\n            config.onRemoteStream(event.stream);\r\n\r\n            event.stream.getTracks().forEach(function(track) {\r\n                track.onended = function() { // track.onmute = \r\n                    peer && peer.onremovestream(event);\r\n                };\r\n            });\r\n\r\n            event.stream.onremovetrack = function() {\r\n                peer && peer.onremovestream(event);\r\n            };\r\n        };\r\n\r\n        peer.onremovestream = function(event) {\r\n            // this event doesn't works anymore\r\n            event.stream.streamid = event.stream.id;\r\n\r\n            if (allRemoteStreams[event.stream.id]) {\r\n                delete allRemoteStreams[event.stream.id];\r\n            }\r\n\r\n            config.onRemoteStreamRemoved(event.stream);\r\n        };\r\n\r\n        if (typeof peer.removeStream !== 'function') {\r\n            // removeStream backward compatibility\r\n            peer.removeStream = function(stream) {\r\n                stream.getTracks().forEach(function(track) {\r\n                    peer.removeTrack(track, stream);\r\n                });\r\n            };\r\n        }\r\n\r\n        this.addRemoteCandidate = function(remoteCandidate) {\r\n            peer.addIceCandidate(new RTCIceCandidate(remoteCandidate));\r\n        };\r\n\r\n        function oldAddRemoteSdp(remoteSdp, cb) {\r\n            cb = cb || function() {};\r\n\r\n            if (DetectRTC.browser.name !== 'Safari') {\r\n                remoteSdp.sdp = connection.processSdp(remoteSdp.sdp);\r\n            }\r\n            peer.setRemoteDescription(new RTCSessionDescription(remoteSdp), cb, function(error) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('setRemoteDescription failed', '\\n', error, '\\n', remoteSdp.sdp);\r\n                }\r\n\r\n                cb();\r\n            });\r\n        }\r\n\r\n        this.addRemoteSdp = function(remoteSdp, cb) {\r\n            cb = cb || function() {};\r\n\r\n            if (DetectRTC.browser.name !== 'Safari') {\r\n                remoteSdp.sdp = connection.processSdp(remoteSdp.sdp);\r\n            }\r\n\r\n            peer.setRemoteDescription(new RTCSessionDescription(remoteSdp)).then(cb, function(error) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('setRemoteDescription failed', '\\n', error, '\\n', remoteSdp.sdp);\r\n                }\r\n\r\n                cb();\r\n            }).catch(function(error) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('setRemoteDescription failed', '\\n', error, '\\n', remoteSdp.sdp);\r\n                }\r\n\r\n                cb();\r\n            });\r\n        };\r\n\r\n        var isOfferer = true;\r\n\r\n        if (config.remoteSdp) {\r\n            isOfferer = false;\r\n        }\r\n\r\n        this.createDataChannel = function() {\r\n            var channel = peer.createDataChannel('sctp', {});\r\n            setChannelEvents(channel);\r\n        };\r\n\r\n        if (connection.session.data === true && !renegotiatingPeer) {\r\n            if (!isOfferer) {\r\n                peer.ondatachannel = function(event) {\r\n                    var channel = event.channel;\r\n                    setChannelEvents(channel);\r\n                };\r\n            } else {\r\n                this.createDataChannel();\r\n            }\r\n        }\r\n\r\n        this.enableDisableVideoEncoding = function(enable) {\r\n            var rtcp;\r\n            peer.getSenders().forEach(function(sender) {\r\n                if (!rtcp && sender.track.kind === 'video') {\r\n                    rtcp = sender;\r\n                }\r\n            });\r\n\r\n            if (!rtcp || !rtcp.getParameters) return;\r\n\r\n            var parameters = rtcp.getParameters();\r\n            parameters.encodings[1] && (parameters.encodings[1].active = !!enable);\r\n            parameters.encodings[2] && (parameters.encodings[2].active = !!enable);\r\n            rtcp.setParameters(parameters);\r\n        };\r\n\r\n        if (config.remoteSdp) {\r\n            if (config.remoteSdp.remotePeerSdpConstraints) {\r\n                sdpConstraints = config.remoteSdp.remotePeerSdpConstraints;\r\n            }\r\n            defaults.sdpConstraints = setSdpConstraints(sdpConstraints);\r\n            this.addRemoteSdp(config.remoteSdp, function() {\r\n                createOfferOrAnswer('createAnswer');\r\n            });\r\n        }\r\n\r\n        function setChannelEvents(channel) {\r\n            // force ArrayBuffer in Firefox; which uses \"Blob\" by default.\r\n            channel.binaryType = 'arraybuffer';\r\n\r\n            channel.onmessage = function(event) {\r\n                config.onDataChannelMessage(event.data);\r\n            };\r\n\r\n            channel.onopen = function() {\r\n                config.onDataChannelOpened(channel);\r\n            };\r\n\r\n            channel.onerror = function(error) {\r\n                config.onDataChannelError(error);\r\n            };\r\n\r\n            channel.onclose = function(event) {\r\n                config.onDataChannelClosed(event);\r\n            };\r\n\r\n            channel.internalSend = channel.send;\r\n            channel.send = function(data) {\r\n                if (channel.readyState !== 'open') {\r\n                    return;\r\n                }\r\n\r\n                channel.internalSend(data);\r\n            };\r\n\r\n            peer.channel = channel;\r\n        }\r\n\r\n        if (connection.session.audio == 'two-way' || connection.session.video == 'two-way' || connection.session.screen == 'two-way') {\r\n            defaults.sdpConstraints = setSdpConstraints({\r\n                OfferToReceiveAudio: connection.session.audio == 'two-way' || (config.remoteSdp && config.remoteSdp.remotePeerSdpConstraints && config.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio),\r\n                OfferToReceiveVideo: connection.session.video == 'two-way' || connection.session.screen == 'two-way' || (config.remoteSdp && config.remoteSdp.remotePeerSdpConstraints && config.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio)\r\n            });\r\n        }\r\n\r\n        var streamsToShare = {};\r\n        peer.getLocalStreams().forEach(function(stream) {\r\n            streamsToShare[stream.streamid] = {\r\n                isAudio: !!stream.isAudio,\r\n                isVideo: !!stream.isVideo,\r\n                isScreen: !!stream.isScreen\r\n            };\r\n        });\r\n\r\n        function oldCreateOfferOrAnswer(_method) {\r\n            peer[_method](function(localSdp) {\r\n                if (DetectRTC.browser.name !== 'Safari') {\r\n                    localSdp.sdp = connection.processSdp(localSdp.sdp);\r\n                }\r\n                peer.setLocalDescription(localSdp, function() {\r\n                    if (!connection.trickleIce) return;\r\n\r\n                    config.onLocalSdp({\r\n                        type: localSdp.type,\r\n                        sdp: localSdp.sdp,\r\n                        remotePeerSdpConstraints: config.remotePeerSdpConstraints || false,\r\n                        renegotiatingPeer: !!config.renegotiatingPeer || false,\r\n                        connectionDescription: self.connectionDescription,\r\n                        dontGetRemoteStream: !!config.dontGetRemoteStream,\r\n                        extra: connection ? connection.extra : {},\r\n                        streamsToShare: streamsToShare\r\n                    });\r\n\r\n                    connection.onSettingLocalDescription(self);\r\n                }, function(error) {\r\n                    if (!!connection.enableLogs) {\r\n                        console.error('setLocalDescription-error', error);\r\n                    }\r\n                });\r\n            }, function(error) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('sdp-' + _method + '-error', error);\r\n                }\r\n            }, defaults.sdpConstraints);\r\n        }\r\n\r\n        function createOfferOrAnswer(_method) {\r\n            peer[_method](defaults.sdpConstraints).then(function(localSdp) {\r\n                if (DetectRTC.browser.name !== 'Safari') {\r\n                    localSdp.sdp = connection.processSdp(localSdp.sdp);\r\n                }\r\n                peer.setLocalDescription(localSdp).then(function() {\r\n                    if (!connection.trickleIce) return;\r\n\r\n                    config.onLocalSdp({\r\n                        type: localSdp.type,\r\n                        sdp: localSdp.sdp,\r\n                        remotePeerSdpConstraints: config.remotePeerSdpConstraints || false,\r\n                        renegotiatingPeer: !!config.renegotiatingPeer || false,\r\n                        connectionDescription: self.connectionDescription,\r\n                        dontGetRemoteStream: !!config.dontGetRemoteStream,\r\n                        extra: connection ? connection.extra : {},\r\n                        streamsToShare: streamsToShare\r\n                    });\r\n\r\n                    connection.onSettingLocalDescription(self);\r\n                }, function(error) {\r\n                    if (!connection.enableLogs) return;\r\n                    console.error('setLocalDescription error', error);\r\n                });\r\n            }, function(error) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('sdp-error', error);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (isOfferer) {\r\n            createOfferOrAnswer('createOffer');\r\n        }\r\n\r\n        peer.nativeClose = peer.close;\r\n        peer.close = function() {\r\n            if (!peer) {\r\n                return;\r\n            }\r\n\r\n            try {\r\n                if (peer.nativeClose !== peer.close) {\r\n                    peer.nativeClose();\r\n                }\r\n            } catch (e) {}\r\n\r\n            peer = null;\r\n            self.peer = null;\r\n        };\r\n\r\n        this.peer = peer;\r\n    }\r\n\r\n    // CodecsHandler.js\r\n\r\n    var CodecsHandler = (function() {\r\n        function preferCodec(sdp, codecName) {\r\n            var info = splitLines(sdp);\r\n\r\n            if (!info.videoCodecNumbers) {\r\n                return sdp;\r\n            }\r\n\r\n            if (codecName === 'vp8' && info.vp8LineNumber === info.videoCodecNumbers[0]) {\r\n                return sdp;\r\n            }\r\n\r\n            if (codecName === 'vp9' && info.vp9LineNumber === info.videoCodecNumbers[0]) {\r\n                return sdp;\r\n            }\r\n\r\n            if (codecName === 'h264' && info.h264LineNumber === info.videoCodecNumbers[0]) {\r\n                return sdp;\r\n            }\r\n\r\n            sdp = preferCodecHelper(sdp, codecName, info);\r\n\r\n            return sdp;\r\n        }\r\n\r\n        function preferCodecHelper(sdp, codec, info, ignore) {\r\n            var preferCodecNumber = '';\r\n\r\n            if (codec === 'vp8') {\r\n                if (!info.vp8LineNumber) {\r\n                    return sdp;\r\n                }\r\n                preferCodecNumber = info.vp8LineNumber;\r\n            }\r\n\r\n            if (codec === 'vp9') {\r\n                if (!info.vp9LineNumber) {\r\n                    return sdp;\r\n                }\r\n                preferCodecNumber = info.vp9LineNumber;\r\n            }\r\n\r\n            if (codec === 'h264') {\r\n                if (!info.h264LineNumber) {\r\n                    return sdp;\r\n                }\r\n\r\n                preferCodecNumber = info.h264LineNumber;\r\n            }\r\n\r\n            var newLine = info.videoCodecNumbersOriginal.split('SAVPF')[0] + 'SAVPF ';\r\n\r\n            var newOrder = [preferCodecNumber];\r\n\r\n            if (ignore) {\r\n                newOrder = [];\r\n            }\r\n\r\n            info.videoCodecNumbers.forEach(function(codecNumber) {\r\n                if (codecNumber === preferCodecNumber) return;\r\n                newOrder.push(codecNumber);\r\n            });\r\n\r\n            newLine += newOrder.join(' ');\r\n\r\n            sdp = sdp.replace(info.videoCodecNumbersOriginal, newLine);\r\n            return sdp;\r\n        }\r\n\r\n        function splitLines(sdp) {\r\n            var info = {};\r\n            sdp.split('\\n').forEach(function(line) {\r\n                if (line.indexOf('m=video') === 0) {\r\n                    info.videoCodecNumbers = [];\r\n                    line.split('SAVPF')[1].split(' ').forEach(function(codecNumber) {\r\n                        codecNumber = codecNumber.trim();\r\n                        if (!codecNumber || !codecNumber.length) return;\r\n                        info.videoCodecNumbers.push(codecNumber);\r\n                        info.videoCodecNumbersOriginal = line;\r\n                    });\r\n                }\r\n\r\n                if (line.indexOf('VP8/90000') !== -1 && !info.vp8LineNumber) {\r\n                    info.vp8LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\r\n                }\r\n\r\n                if (line.indexOf('VP9/90000') !== -1 && !info.vp9LineNumber) {\r\n                    info.vp9LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\r\n                }\r\n\r\n                if (line.indexOf('H264/90000') !== -1 && !info.h264LineNumber) {\r\n                    info.h264LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\r\n                }\r\n            });\r\n\r\n            return info;\r\n        }\r\n\r\n        function removeVPX(sdp) {\r\n            var info = splitLines(sdp);\r\n\r\n            // last parameter below means: ignore these codecs\r\n            sdp = preferCodecHelper(sdp, 'vp9', info, true);\r\n            sdp = preferCodecHelper(sdp, 'vp8', info, true);\r\n\r\n            return sdp;\r\n        }\r\n\r\n        function disableNACK(sdp) {\r\n            if (!sdp || typeof sdp !== 'string') {\r\n                throw 'Invalid arguments.';\r\n            }\r\n\r\n            sdp = sdp.replace('a=rtcp-fb:126 nack\\r\\n', '');\r\n            sdp = sdp.replace('a=rtcp-fb:126 nack pli\\r\\n', 'a=rtcp-fb:126 pli\\r\\n');\r\n            sdp = sdp.replace('a=rtcp-fb:97 nack\\r\\n', '');\r\n            sdp = sdp.replace('a=rtcp-fb:97 nack pli\\r\\n', 'a=rtcp-fb:97 pli\\r\\n');\r\n\r\n            return sdp;\r\n        }\r\n\r\n        function prioritize(codecMimeType, peer) {\r\n            if (!peer || !peer.getSenders || !peer.getSenders().length) {\r\n                return;\r\n            }\r\n\r\n            if (!codecMimeType || typeof codecMimeType !== 'string') {\r\n                throw 'Invalid arguments.';\r\n            }\r\n\r\n            peer.getSenders().forEach(function(sender) {\r\n                var params = sender.getParameters();\r\n                for (var i = 0; i < params.codecs.length; i++) {\r\n                    if (params.codecs[i].mimeType == codecMimeType) {\r\n                        params.codecs.unshift(params.codecs.splice(i, 1));\r\n                        break;\r\n                    }\r\n                }\r\n                sender.setParameters(params);\r\n            });\r\n        }\r\n\r\n        function removeNonG722(sdp) {\r\n            return sdp.replace(/m=audio ([0-9]+) RTP\\/SAVPF ([0-9 ]*)/g, 'm=audio $1 RTP\\/SAVPF 9');\r\n        }\r\n\r\n        function setBAS(sdp, bandwidth, isScreen) {\r\n            if (!bandwidth) {\r\n                return sdp;\r\n            }\r\n\r\n            if (typeof isFirefox !== 'undefined' && isFirefox) {\r\n                return sdp;\r\n            }\r\n\r\n            if (isScreen) {\r\n                if (!bandwidth.screen) {\r\n                    console.warn('It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.');\r\n                } else if (bandwidth.screen < 300) {\r\n                    console.warn('It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail.');\r\n                }\r\n            }\r\n\r\n            // if screen; must use at least 300kbs\r\n            if (bandwidth.screen && isScreen) {\r\n                sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\r\n                sdp = sdp.replace(/a=mid:video\\r\\n/g, 'a=mid:video\\r\\nb=AS:' + bandwidth.screen + '\\r\\n');\r\n            }\r\n\r\n            // remove existing bandwidth lines\r\n            if (bandwidth.audio || bandwidth.video) {\r\n                sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\r\n            }\r\n\r\n            if (bandwidth.audio) {\r\n                sdp = sdp.replace(/a=mid:audio\\r\\n/g, 'a=mid:audio\\r\\nb=AS:' + bandwidth.audio + '\\r\\n');\r\n            }\r\n\r\n            if (bandwidth.screen) {\r\n                sdp = sdp.replace(/a=mid:video\\r\\n/g, 'a=mid:video\\r\\nb=AS:' + bandwidth.screen + '\\r\\n');\r\n            } else if (bandwidth.video) {\r\n                sdp = sdp.replace(/a=mid:video\\r\\n/g, 'a=mid:video\\r\\nb=AS:' + bandwidth.video + '\\r\\n');\r\n            }\r\n\r\n            return sdp;\r\n        }\r\n\r\n        // Find the line in sdpLines that starts with |prefix|, and, if specified,\r\n        // contains |substr| (case-insensitive search).\r\n        function findLine(sdpLines, prefix, substr) {\r\n            return findLineInRange(sdpLines, 0, -1, prefix, substr);\r\n        }\r\n\r\n        // Find the line in sdpLines[startLine...endLine - 1] that starts with |prefix|\r\n        // and, if specified, contains |substr| (case-insensitive search).\r\n        function findLineInRange(sdpLines, startLine, endLine, prefix, substr) {\r\n            var realEndLine = endLine !== -1 ? endLine : sdpLines.length;\r\n            for (var i = startLine; i < realEndLine; ++i) {\r\n                if (sdpLines[i].indexOf(prefix) === 0) {\r\n                    if (!substr ||\r\n                        sdpLines[i].toLowerCase().indexOf(substr.toLowerCase()) !== -1) {\r\n                        return i;\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        // Gets the codec payload type from an a=rtpmap:X line.\r\n        function getCodecPayloadType(sdpLine) {\r\n            var pattern = new RegExp('a=rtpmap:(\\\\d+) \\\\w+\\\\/\\\\d+');\r\n            var result = sdpLine.match(pattern);\r\n            return (result && result.length === 2) ? result[1] : null;\r\n        }\r\n\r\n        function setVideoBitrates(sdp, params) {\r\n            params = params || {};\r\n            var xgoogle_min_bitrate = params.min;\r\n            var xgoogle_max_bitrate = params.max;\r\n\r\n            var sdpLines = sdp.split('\\r\\n');\r\n\r\n            // VP8\r\n            var vp8Index = findLine(sdpLines, 'a=rtpmap', 'VP8/90000');\r\n            var vp8Payload;\r\n            if (vp8Index) {\r\n                vp8Payload = getCodecPayloadType(sdpLines[vp8Index]);\r\n            }\r\n\r\n            if (!vp8Payload) {\r\n                return sdp;\r\n            }\r\n\r\n            var rtxIndex = findLine(sdpLines, 'a=rtpmap', 'rtx/90000');\r\n            var rtxPayload;\r\n            if (rtxIndex) {\r\n                rtxPayload = getCodecPayloadType(sdpLines[rtxIndex]);\r\n            }\r\n\r\n            if (!rtxIndex) {\r\n                return sdp;\r\n            }\r\n\r\n            var rtxFmtpLineIndex = findLine(sdpLines, 'a=fmtp:' + rtxPayload.toString());\r\n            if (rtxFmtpLineIndex !== null) {\r\n                var appendrtxNext = '\\r\\n';\r\n                appendrtxNext += 'a=fmtp:' + vp8Payload + ' x-google-min-bitrate=' + (xgoogle_min_bitrate || '228') + '; x-google-max-bitrate=' + (xgoogle_max_bitrate || '228');\r\n                sdpLines[rtxFmtpLineIndex] = sdpLines[rtxFmtpLineIndex].concat(appendrtxNext);\r\n                sdp = sdpLines.join('\\r\\n');\r\n            }\r\n\r\n            return sdp;\r\n        }\r\n\r\n        function setOpusAttributes(sdp, params) {\r\n            params = params || {};\r\n\r\n            var sdpLines = sdp.split('\\r\\n');\r\n\r\n            // Opus\r\n            var opusIndex = findLine(sdpLines, 'a=rtpmap', 'opus/48000');\r\n            var opusPayload;\r\n            if (opusIndex) {\r\n                opusPayload = getCodecPayloadType(sdpLines[opusIndex]);\r\n            }\r\n\r\n            if (!opusPayload) {\r\n                return sdp;\r\n            }\r\n\r\n            var opusFmtpLineIndex = findLine(sdpLines, 'a=fmtp:' + opusPayload.toString());\r\n            if (opusFmtpLineIndex === null) {\r\n                return sdp;\r\n            }\r\n\r\n            var appendOpusNext = '';\r\n            appendOpusNext += '; stereo=' + (typeof params.stereo != 'undefined' ? params.stereo : '1');\r\n            appendOpusNext += '; sprop-stereo=' + (typeof params['sprop-stereo'] != 'undefined' ? params['sprop-stereo'] : '1');\r\n\r\n            if (typeof params.maxaveragebitrate != 'undefined') {\r\n                appendOpusNext += '; maxaveragebitrate=' + (params.maxaveragebitrate || 128 * 1024 * 8);\r\n            }\r\n\r\n            if (typeof params.maxplaybackrate != 'undefined') {\r\n                appendOpusNext += '; maxplaybackrate=' + (params.maxplaybackrate || 128 * 1024 * 8);\r\n            }\r\n\r\n            if (typeof params.cbr != 'undefined') {\r\n                appendOpusNext += '; cbr=' + (typeof params.cbr != 'undefined' ? params.cbr : '1');\r\n            }\r\n\r\n            if (typeof params.useinbandfec != 'undefined') {\r\n                appendOpusNext += '; useinbandfec=' + params.useinbandfec;\r\n            }\r\n\r\n            if (typeof params.usedtx != 'undefined') {\r\n                appendOpusNext += '; usedtx=' + params.usedtx;\r\n            }\r\n\r\n            if (typeof params.maxptime != 'undefined') {\r\n                appendOpusNext += '\\r\\na=maxptime:' + params.maxptime;\r\n            }\r\n\r\n            sdpLines[opusFmtpLineIndex] = sdpLines[opusFmtpLineIndex].concat(appendOpusNext);\r\n\r\n            sdp = sdpLines.join('\\r\\n');\r\n            return sdp;\r\n        }\r\n\r\n        // forceStereoAudio => via webrtcexample.com\r\n        // requires getUserMedia => echoCancellation:false\r\n        function forceStereoAudio(sdp) {\r\n            var sdpLines = sdp.split('\\r\\n');\r\n            var fmtpLineIndex = null;\r\n            for (var i = 0; i < sdpLines.length; i++) {\r\n                if (sdpLines[i].search('opus/48000') !== -1) {\r\n                    var opusPayload = extractSdp(sdpLines[i], /:(\\d+) opus\\/48000/i);\r\n                    break;\r\n                }\r\n            }\r\n            for (var i = 0; i < sdpLines.length; i++) {\r\n                if (sdpLines[i].search('a=fmtp') !== -1) {\r\n                    var payload = extractSdp(sdpLines[i], /a=fmtp:(\\d+)/);\r\n                    if (payload === opusPayload) {\r\n                        fmtpLineIndex = i;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (fmtpLineIndex === null) return sdp;\r\n            sdpLines[fmtpLineIndex] = sdpLines[fmtpLineIndex].concat('; stereo=1; sprop-stereo=1');\r\n            sdp = sdpLines.join('\\r\\n');\r\n            return sdp;\r\n        }\r\n\r\n        return {\r\n            removeVPX: removeVPX,\r\n            disableNACK: disableNACK,\r\n            prioritize: prioritize,\r\n            removeNonG722: removeNonG722,\r\n            setApplicationSpecificBandwidth: function(sdp, bandwidth, isScreen) {\r\n                return setBAS(sdp, bandwidth, isScreen);\r\n            },\r\n            setVideoBitrates: function(sdp, params) {\r\n                return setVideoBitrates(sdp, params);\r\n            },\r\n            setOpusAttributes: function(sdp, params) {\r\n                return setOpusAttributes(sdp, params);\r\n            },\r\n            preferVP9: function(sdp) {\r\n                return preferCodec(sdp, 'vp9');\r\n            },\r\n            preferCodec: preferCodec,\r\n            forceStereoAudio: forceStereoAudio\r\n        };\r\n    })();\r\n\r\n    // backward compatibility\r\n    window.BandwidthHandler = CodecsHandler;\r\n\r\n    // OnIceCandidateHandler.js\r\n\r\n    var OnIceCandidateHandler = (function() {\r\n        function processCandidates(connection, icePair) {\r\n            var candidate = icePair.candidate;\r\n\r\n            var iceRestrictions = connection.candidates;\r\n            var stun = iceRestrictions.stun;\r\n            var turn = iceRestrictions.turn;\r\n\r\n            if (!isNull(iceRestrictions.reflexive)) {\r\n                stun = iceRestrictions.reflexive;\r\n            }\r\n\r\n            if (!isNull(iceRestrictions.relay)) {\r\n                turn = iceRestrictions.relay;\r\n            }\r\n\r\n            if (!iceRestrictions.host && !!candidate.match(/typ host/g)) {\r\n                return;\r\n            }\r\n\r\n            if (!turn && !!candidate.match(/typ relay/g)) {\r\n                return;\r\n            }\r\n\r\n            if (!stun && !!candidate.match(/typ srflx/g)) {\r\n                return;\r\n            }\r\n\r\n            var protocol = connection.iceProtocols;\r\n\r\n            if (!protocol.udp && !!candidate.match(/ udp /g)) {\r\n                return;\r\n            }\r\n\r\n            if (!protocol.tcp && !!candidate.match(/ tcp /g)) {\r\n                return;\r\n            }\r\n\r\n            if (connection.enableLogs) {\r\n                console.debug('Your candidate pairs:', candidate);\r\n            }\r\n\r\n            return {\r\n                candidate: candidate,\r\n                sdpMid: icePair.sdpMid,\r\n                sdpMLineIndex: icePair.sdpMLineIndex\r\n            };\r\n        }\r\n\r\n        return {\r\n            processCandidates: processCandidates\r\n        };\r\n    })();\r\n\r\n    // IceServersHandler.js\r\n\r\n    var IceServersHandler = (function() {\r\n        function getIceServers(connection) {\r\n            // resiprocate: 3344+4433\r\n            // pions: 7575\r\n            var iceServers = [{\r\n                'urls': [\r\n                    'stun:stun.l.google.com:19302',\r\n                    'stun:stun1.l.google.com:19302',\r\n                    'stun:stun2.l.google.com:19302',\r\n                    'stun:stun.l.google.com:19302?transport=udp',\r\n                ]\r\n            }];\r\n\r\n            return iceServers;\r\n        }\r\n\r\n        return {\r\n            getIceServers: getIceServers\r\n        };\r\n    })();\r\n\r\n    // getUserMediaHandler.js\r\n\r\n    function setStreamType(constraints, stream) {\r\n        if (constraints.mandatory && constraints.mandatory.chromeMediaSource) {\r\n            stream.isScreen = true;\r\n        } else if (constraints.mozMediaSource || constraints.mediaSource) {\r\n            stream.isScreen = true;\r\n        } else if (constraints.video) {\r\n            stream.isVideo = true;\r\n        } else if (constraints.audio) {\r\n            stream.isAudio = true;\r\n        }\r\n    }\r\n\r\n    // allow users to manage this object (to support re-capturing of screen/etc.)\r\n    window.currentUserMediaRequest = {\r\n        streams: [],\r\n        mutex: false,\r\n        queueRequests: [],\r\n        remove: function(idInstance) {\r\n            this.mutex = false;\r\n\r\n            var stream = this.streams[idInstance];\r\n            if (!stream) {\r\n                return;\r\n            }\r\n\r\n            stream = stream.stream;\r\n\r\n            var options = stream.currentUserMediaRequestOptions;\r\n\r\n            if (this.queueRequests.indexOf(options)) {\r\n                delete this.queueRequests[this.queueRequests.indexOf(options)];\r\n                this.queueRequests = removeNullEntries(this.queueRequests);\r\n            }\r\n\r\n            this.streams[idInstance].stream = null;\r\n            delete this.streams[idInstance];\r\n        }\r\n    };\r\n\r\n    function getUserMediaHandler(options) {\r\n        if (currentUserMediaRequest.mutex === true) {\r\n            currentUserMediaRequest.queueRequests.push(options);\r\n            return;\r\n        }\r\n        currentUserMediaRequest.mutex = true;\r\n\r\n        // easy way to match\r\n        var idInstance = JSON.stringify(options.localMediaConstraints);\r\n\r\n        function streaming(stream, returnBack) {\r\n            setStreamType(options.localMediaConstraints, stream);\r\n\r\n            var streamEndedEvent = 'ended';\r\n\r\n            if ('oninactive' in stream) {\r\n                streamEndedEvent = 'inactive';\r\n            }\r\n            stream.addEventListener(streamEndedEvent, function() {\r\n                delete currentUserMediaRequest.streams[idInstance];\r\n\r\n                currentUserMediaRequest.mutex = false;\r\n                if (currentUserMediaRequest.queueRequests.indexOf(options)) {\r\n                    delete currentUserMediaRequest.queueRequests[currentUserMediaRequest.queueRequests.indexOf(options)];\r\n                    currentUserMediaRequest.queueRequests = removeNullEntries(currentUserMediaRequest.queueRequests);\r\n                }\r\n            }, false);\r\n\r\n            currentUserMediaRequest.streams[idInstance] = {\r\n                stream: stream\r\n            };\r\n            currentUserMediaRequest.mutex = false;\r\n\r\n            if (currentUserMediaRequest.queueRequests.length) {\r\n                getUserMediaHandler(currentUserMediaRequest.queueRequests.shift());\r\n            }\r\n\r\n            // callback\r\n            options.onGettingLocalMedia(stream, returnBack);\r\n        }\r\n\r\n        if (currentUserMediaRequest.streams[idInstance]) {\r\n            streaming(currentUserMediaRequest.streams[idInstance].stream, true);\r\n        } else {\r\n            var isBlackBerry = !!(/BB10|BlackBerry/i.test(navigator.userAgent || ''));\r\n            if (isBlackBerry || typeof navigator.mediaDevices === 'undefined' || typeof navigator.mediaDevices.getUserMedia !== 'function') {\r\n                navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\r\n                navigator.getUserMedia(options.localMediaConstraints, function(stream) {\r\n                    stream.streamid = stream.streamid || stream.id || getRandomString();\r\n                    stream.idInstance = idInstance;\r\n                    streaming(stream);\r\n                }, function(error) {\r\n                    options.onLocalMediaError(error, options.localMediaConstraints);\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (typeof navigator.mediaDevices === 'undefined') {\r\n                navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\r\n                var getUserMediaSuccess = function() {};\r\n                var getUserMediaFailure = function() {};\r\n\r\n                var getUserMediaStream, getUserMediaError;\r\n                navigator.mediaDevices = {\r\n                    getUserMedia: function(hints) {\r\n                        navigator.getUserMedia(hints, function(getUserMediaSuccess) {\r\n                            getUserMediaSuccess(stream);\r\n                            getUserMediaStream = stream;\r\n                        }, function(error) {\r\n                            getUserMediaFailure(error);\r\n                            getUserMediaError = error;\r\n                        });\r\n\r\n                        return {\r\n                            then: function(successCB) {\r\n                                if (getUserMediaStream) {\r\n                                    successCB(getUserMediaStream);\r\n                                    return;\r\n                                }\r\n\r\n                                getUserMediaSuccess = successCB;\r\n\r\n                                return {\r\n                                    then: function(failureCB) {\r\n                                        if (getUserMediaError) {\r\n                                            failureCB(getUserMediaError);\r\n                                            return;\r\n                                        }\r\n\r\n                                        getUserMediaFailure = failureCB;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n            }\r\n\r\n            if (options.localMediaConstraints.isScreen === true) {\r\n                if (navigator.mediaDevices.getDisplayMedia) {\r\n                    navigator.mediaDevices.getDisplayMedia(options.localMediaConstraints).then(function(stream) {\r\n                        stream.streamid = stream.streamid || stream.id || getRandomString();\r\n                        stream.idInstance = idInstance;\r\n\r\n                        streaming(stream);\r\n                    }).catch(function(error) {\r\n                        options.onLocalMediaError(error, options.localMediaConstraints);\r\n                    });\r\n                } else if (navigator.getDisplayMedia) {\r\n                    navigator.getDisplayMedia(options.localMediaConstraints).then(function(stream) {\r\n                        stream.streamid = stream.streamid || stream.id || getRandomString();\r\n                        stream.idInstance = idInstance;\r\n\r\n                        streaming(stream);\r\n                    }).catch(function(error) {\r\n                        options.onLocalMediaError(error, options.localMediaConstraints);\r\n                    });\r\n                } else {\r\n                    throw new Error('getDisplayMedia API is not availabe in this browser.');\r\n                }\r\n                return;\r\n            }\r\n\r\n            navigator.mediaDevices.getUserMedia(options.localMediaConstraints).then(function(stream) {\r\n                stream.streamid = stream.streamid || stream.id || getRandomString();\r\n                stream.idInstance = idInstance;\r\n\r\n                streaming(stream);\r\n            }).catch(function(error) {\r\n                options.onLocalMediaError(error, options.localMediaConstraints);\r\n            });\r\n        }\r\n    }\r\n\r\n    // StreamsHandler.js\r\n\r\n    var StreamsHandler = (function() {\r\n        function handleType(type) {\r\n            if (!type) {\r\n                return;\r\n            }\r\n\r\n            if (typeof type === 'string' || typeof type === 'undefined') {\r\n                return type;\r\n            }\r\n\r\n            if (type.audio && type.video) {\r\n                return null;\r\n            }\r\n\r\n            if (type.audio) {\r\n                return 'audio';\r\n            }\r\n\r\n            if (type.video) {\r\n                return 'video';\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        function setHandlers(stream, syncAction, connection) {\r\n            if (!stream || !stream.addEventListener) return;\r\n\r\n            if (typeof syncAction == 'undefined' || syncAction == true) {\r\n                var streamEndedEvent = 'ended';\r\n\r\n                if ('oninactive' in stream) {\r\n                    streamEndedEvent = 'inactive';\r\n                }\r\n\r\n                stream.addEventListener(streamEndedEvent, function() {\r\n                    StreamsHandler.onSyncNeeded(this.streamid, streamEndedEvent);\r\n                }, false);\r\n            }\r\n\r\n            stream.mute = function(type, isSyncAction) {\r\n                type = handleType(type);\r\n\r\n                if (typeof isSyncAction !== 'undefined') {\r\n                    syncAction = isSyncAction;\r\n                }\r\n\r\n                if (typeof type == 'undefined' || type == 'audio') {\r\n                    getTracks(stream, 'audio').forEach(function(track) {\r\n                        track.enabled = false;\r\n                        connection.streamEvents[stream.streamid].isAudioMuted = true;\r\n                    });\r\n                }\r\n\r\n                if (typeof type == 'undefined' || type == 'video') {\r\n                    getTracks(stream, 'video').forEach(function(track) {\r\n                        track.enabled = false;\r\n                    });\r\n                }\r\n\r\n                if (typeof syncAction == 'undefined' || syncAction == true) {\r\n                    StreamsHandler.onSyncNeeded(stream.streamid, 'mute', type);\r\n                }\r\n\r\n                connection.streamEvents[stream.streamid].muteType = type || 'both';\r\n\r\n                fireEvent(stream, 'mute', type);\r\n            };\r\n\r\n            stream.unmute = function(type, isSyncAction) {\r\n                type = handleType(type);\r\n\r\n                if (typeof isSyncAction !== 'undefined') {\r\n                    syncAction = isSyncAction;\r\n                }\r\n\r\n                graduallyIncreaseVolume();\r\n\r\n                if (typeof type == 'undefined' || type == 'audio') {\r\n                    getTracks(stream, 'audio').forEach(function(track) {\r\n                        track.enabled = true;\r\n                        connection.streamEvents[stream.streamid].isAudioMuted = false;\r\n                    });\r\n                }\r\n\r\n                if (typeof type == 'undefined' || type == 'video') {\r\n                    getTracks(stream, 'video').forEach(function(track) {\r\n                        track.enabled = true;\r\n                    });\r\n\r\n                    // make sure that video unmute doesn't affects audio\r\n                    if (typeof type !== 'undefined' && type == 'video' && connection.streamEvents[stream.streamid].isAudioMuted) {\r\n                        (function looper(times) {\r\n                            if (!times) {\r\n                                times = 0;\r\n                            }\r\n\r\n                            times++;\r\n\r\n                            // check until five-seconds\r\n                            if (times < 100 && connection.streamEvents[stream.streamid].isAudioMuted) {\r\n                                stream.mute('audio');\r\n\r\n                                setTimeout(function() {\r\n                                    looper(times);\r\n                                }, 50);\r\n                            }\r\n                        })();\r\n                    }\r\n                }\r\n\r\n                if (typeof syncAction == 'undefined' || syncAction == true) {\r\n                    StreamsHandler.onSyncNeeded(stream.streamid, 'unmute', type);\r\n                }\r\n\r\n                connection.streamEvents[stream.streamid].unmuteType = type || 'both';\r\n\r\n                fireEvent(stream, 'unmute', type);\r\n            };\r\n\r\n            function graduallyIncreaseVolume() {\r\n                if (!connection.streamEvents[stream.streamid].mediaElement) {\r\n                    return;\r\n                }\r\n\r\n                var mediaElement = connection.streamEvents[stream.streamid].mediaElement;\r\n                mediaElement.volume = 0;\r\n                afterEach(200, 5, function() {\r\n                    try {\r\n                        mediaElement.volume += .20;\r\n                    } catch (e) {\r\n                        mediaElement.volume = 1;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        function afterEach(setTimeoutInteval, numberOfTimes, callback, startedTimes) {\r\n            startedTimes = (startedTimes || 0) + 1;\r\n            if (startedTimes >= numberOfTimes) return;\r\n\r\n            setTimeout(function() {\r\n                callback();\r\n                afterEach(setTimeoutInteval, numberOfTimes, callback, startedTimes);\r\n            }, setTimeoutInteval);\r\n        }\r\n\r\n        return {\r\n            setHandlers: setHandlers,\r\n            onSyncNeeded: function(streamid, action, type) {}\r\n        };\r\n    })();\r\n\r\n    // TextReceiver.js & TextSender.js\r\n\r\n    function TextReceiver(connection) {\r\n        var content = {};\r\n\r\n        function receive(data, userid, extra) {\r\n            // uuid is used to uniquely identify sending instance\r\n            var uuid = data.uuid;\r\n            if (!content[uuid]) {\r\n                content[uuid] = [];\r\n            }\r\n\r\n            content[uuid].push(data.message);\r\n\r\n            if (data.last) {\r\n                var message = content[uuid].join('');\r\n                if (data.isobject) {\r\n                    message = JSON.parse(message);\r\n                }\r\n\r\n                // latency detection\r\n                var receivingTime = new Date().getTime();\r\n                var latency = receivingTime - data.sendingTime;\r\n\r\n                var e = {\r\n                    data: message,\r\n                    userid: userid,\r\n                    extra: extra,\r\n                    latency: latency\r\n                };\r\n\r\n                if (connection.autoTranslateText) {\r\n                    e.original = e.data;\r\n                    connection.Translator.TranslateText(e.data, function(translatedText) {\r\n                        e.data = translatedText;\r\n                        connection.onmessage(e);\r\n                    });\r\n                } else {\r\n                    connection.onmessage(e);\r\n                }\r\n\r\n                delete content[uuid];\r\n            }\r\n        }\r\n\r\n        return {\r\n            receive: receive\r\n        };\r\n    }\r\n\r\n    // TextSender.js\r\n    var TextSender = {\r\n        send: function(config) {\r\n            var connection = config.connection;\r\n\r\n            var channel = config.channel,\r\n                remoteUserId = config.remoteUserId,\r\n                initialText = config.text,\r\n                packetSize = connection.chunkSize || 1000,\r\n                textToTransfer = '',\r\n                isobject = false;\r\n\r\n            if (!isString(initialText)) {\r\n                isobject = true;\r\n                initialText = JSON.stringify(initialText);\r\n            }\r\n\r\n            // uuid is used to uniquely identify sending instance\r\n            var uuid = getRandomString();\r\n            var sendingTime = new Date().getTime();\r\n\r\n            sendText(initialText);\r\n\r\n            function sendText(textMessage, text) {\r\n                var data = {\r\n                    type: 'text',\r\n                    uuid: uuid,\r\n                    sendingTime: sendingTime\r\n                };\r\n\r\n                if (textMessage) {\r\n                    text = textMessage;\r\n                    data.packets = parseInt(text.length / packetSize);\r\n                }\r\n\r\n                if (text.length > packetSize) {\r\n                    data.message = text.slice(0, packetSize);\r\n                } else {\r\n                    data.message = text;\r\n                    data.last = true;\r\n                    data.isobject = isobject;\r\n                }\r\n\r\n                channel.send(data, remoteUserId);\r\n\r\n                textToTransfer = text.slice(data.message.length);\r\n\r\n                if (textToTransfer.length) {\r\n                    setTimeout(function() {\r\n                        sendText(null, textToTransfer);\r\n                    }, connection.chunkInterval || 100);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    // FileProgressBarHandler.js\r\n\r\n    var FileProgressBarHandler = (function() {\r\n        function handle(connection) {\r\n            var progressHelper = {};\r\n\r\n            // www.RTCMultiConnection.org/docs/onFileStart/\r\n            connection.onFileStart = function(file) {\r\n                var div = document.createElement('div');\r\n                div.title = file.name;\r\n                div.innerHTML = '<label>0%</label> <progress></progress>';\r\n\r\n                if (file.remoteUserId) {\r\n                    div.innerHTML += ' (Sharing with:' + file.remoteUserId + ')';\r\n                }\r\n\r\n                if (!connection.filesContainer) {\r\n                    connection.filesContainer = document.body || document.documentElement;\r\n                }\r\n\r\n                connection.filesContainer.insertBefore(div, connection.filesContainer.firstChild);\r\n\r\n                if (!file.remoteUserId) {\r\n                    progressHelper[file.uuid] = {\r\n                        div: div,\r\n                        progress: div.querySelector('progress'),\r\n                        label: div.querySelector('label')\r\n                    };\r\n                    progressHelper[file.uuid].progress.max = file.maxChunks;\r\n                    return;\r\n                }\r\n\r\n                if (!progressHelper[file.uuid]) {\r\n                    progressHelper[file.uuid] = {};\r\n                }\r\n\r\n                progressHelper[file.uuid][file.remoteUserId] = {\r\n                    div: div,\r\n                    progress: div.querySelector('progress'),\r\n                    label: div.querySelector('label')\r\n                };\r\n                progressHelper[file.uuid][file.remoteUserId].progress.max = file.maxChunks;\r\n            };\r\n\r\n            // www.RTCMultiConnection.org/docs/onFileProgress/\r\n            connection.onFileProgress = function(chunk) {\r\n                var helper = progressHelper[chunk.uuid];\r\n                if (!helper) {\r\n                    return;\r\n                }\r\n                if (chunk.remoteUserId) {\r\n                    helper = progressHelper[chunk.uuid][chunk.remoteUserId];\r\n                    if (!helper) {\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                helper.progress.value = chunk.currentPosition || chunk.maxChunks || helper.progress.max;\r\n                updateLabel(helper.progress, helper.label);\r\n            };\r\n\r\n            // www.RTCMultiConnection.org/docs/onFileEnd/\r\n            connection.onFileEnd = function(file) {\r\n                var helper = progressHelper[file.uuid];\r\n                if (!helper) {\r\n                    console.error('No such progress-helper element exist.', file);\r\n                    return;\r\n                }\r\n\r\n                if (file.remoteUserId) {\r\n                    helper = progressHelper[file.uuid][file.remoteUserId];\r\n                    if (!helper) {\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                var div = helper.div;\r\n                if (file.type.indexOf('image') != -1) {\r\n                    div.innerHTML = '<a href=\"' + file.url + '\" download=\"' + file.name + '\">Download <strong style=\"color:red;\">' + file.name + '</strong> </a><br /><img src=\"' + file.url + '\" title=\"' + file.name + '\" style=\"max-width: 80%;\">';\r\n                } else {\r\n                    div.innerHTML = '<a href=\"' + file.url + '\" download=\"' + file.name + '\">Download <strong style=\"color:red;\">' + file.name + '</strong> </a><br /><iframe src=\"' + file.url + '\" title=\"' + file.name + '\" style=\"width: 80%;border: 0;height: inherit;margin-top:1em;\"></iframe>';\r\n                }\r\n            };\r\n\r\n            function updateLabel(progress, label) {\r\n                if (progress.position === -1) {\r\n                    return;\r\n                }\r\n\r\n                var position = +progress.position.toFixed(2).split('.')[1] || 100;\r\n                label.innerHTML = position + '%';\r\n            }\r\n        }\r\n\r\n        return {\r\n            handle: handle\r\n        };\r\n    })();\r\n\r\n    // TranslationHandler.js\r\n\r\n    var TranslationHandler = (function() {\r\n        function handle(connection) {\r\n            connection.autoTranslateText = false;\r\n            connection.language = 'en';\r\n            connection.googKey = 'AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE';\r\n\r\n            // www.RTCMultiConnection.org/docs/Translator/\r\n            connection.Translator = {\r\n                TranslateText: function(text, callback) {\r\n                    // if(location.protocol === 'https:') return callback(text);\r\n\r\n                    var newScript = document.createElement('script');\r\n                    newScript.type = 'text/javascript';\r\n\r\n                    var sourceText = encodeURIComponent(text); // escape\r\n\r\n                    var randomNumber = 'method' + connection.token();\r\n                    window[randomNumber] = function(response) {\r\n                        if (response.data && response.data.translations[0] && callback) {\r\n                            callback(response.data.translations[0].translatedText);\r\n                            return;\r\n                        }\r\n\r\n                        if (response.error && response.error.message === 'Daily Limit Exceeded') {\r\n                            console.error('Text translation failed. Error message: \"Daily Limit Exceeded.\"');\r\n                            return;\r\n                        }\r\n\r\n                        if (response.error) {\r\n                            console.error(response.error.message);\r\n                            return;\r\n                        }\r\n\r\n                        console.error(response);\r\n                    };\r\n\r\n                    var source = 'https://www.googleapis.com/language/translate/v2?key=' + connection.googKey + '&target=' + (connection.language || 'en-US') + '&callback=window.' + randomNumber + '&q=' + sourceText;\r\n                    newScript.src = source;\r\n                    document.getElementsByTagName('head')[0].appendChild(newScript);\r\n                },\r\n                getListOfLanguages: function(callback) {\r\n                    var xhr = new XMLHttpRequest();\r\n                    xhr.onreadystatechange = function() {\r\n                        if (xhr.readyState == XMLHttpRequest.DONE) {\r\n                            var response = JSON.parse(xhr.responseText);\r\n\r\n                            if (response && response.data && response.data.languages) {\r\n                                callback(response.data.languages);\r\n                                return;\r\n                            }\r\n\r\n                            if (response.error && response.error.message === 'Daily Limit Exceeded') {\r\n                                console.error('Text translation failed. Error message: \"Daily Limit Exceeded.\"');\r\n                                return;\r\n                            }\r\n\r\n                            if (response.error) {\r\n                                console.error(response.error.message);\r\n                                return;\r\n                            }\r\n\r\n                            console.error(response);\r\n                        }\r\n                    }\r\n                    var url = 'https://www.googleapis.com/language/translate/v2/languages?key=' + connection.googKey + '&target=en';\r\n                    xhr.open('GET', url, true);\r\n                    xhr.send(null);\r\n                }\r\n            };\r\n        }\r\n\r\n        return {\r\n            handle: handle\r\n        };\r\n    })();\r\n\r\n    // _____________________\r\n    // RTCMultiConnection.js\r\n\r\n    (function(connection) {\r\n        forceOptions = forceOptions || {\r\n            useDefaultDevices: true\r\n        };\r\n\r\n        connection.channel = connection.sessionid = (roomid || location.href.replace(/\\/|:|#|\\?|\\$|\\^|%|\\.|`|~|!|\\+|@|\\[|\\||]|\\|*. /g, '').split('\\n').join('').split('\\r').join('')) + '';\r\n\r\n        var mPeer = new MultiPeers(connection);\r\n\r\n        var preventDuplicateOnStreamEvents = {};\r\n        mPeer.onGettingLocalMedia = function(stream, callback) {\r\n            callback = callback || function() {};\r\n\r\n            if (preventDuplicateOnStreamEvents[stream.streamid]) {\r\n                callback();\r\n                return;\r\n            }\r\n            preventDuplicateOnStreamEvents[stream.streamid] = true;\r\n\r\n            try {\r\n                stream.type = 'local';\r\n            } catch (e) {}\r\n\r\n            connection.setStreamEndHandler(stream);\r\n\r\n            getRMCMediaElement(stream, function(mediaElement) {\r\n                mediaElement.id = stream.streamid;\r\n                mediaElement.muted = true;\r\n                mediaElement.volume = 0;\r\n\r\n                if (connection.attachStreams.indexOf(stream) === -1) {\r\n                    connection.attachStreams.push(stream);\r\n                }\r\n\r\n                if (typeof StreamsHandler !== 'undefined') {\r\n                    StreamsHandler.setHandlers(stream, true, connection);\r\n                }\r\n\r\n                connection.streamEvents[stream.streamid] = {\r\n                    stream: stream,\r\n                    type: 'local',\r\n                    mediaElement: mediaElement,\r\n                    userid: connection.userid,\r\n                    extra: connection.extra,\r\n                    streamid: stream.streamid,\r\n                    isAudioMuted: true\r\n                };\r\n\r\n                try {\r\n                    setHarkEvents(connection, connection.streamEvents[stream.streamid]);\r\n                    setMuteHandlers(connection, connection.streamEvents[stream.streamid]);\r\n\r\n                    connection.onstream(connection.streamEvents[stream.streamid]);\r\n                } catch (e) {\r\n                    //\r\n                }\r\n\r\n                callback();\r\n            }, connection);\r\n        };\r\n\r\n        mPeer.onGettingRemoteMedia = function(stream, remoteUserId) {\r\n            try {\r\n                stream.type = 'remote';\r\n            } catch (e) {}\r\n\r\n            connection.setStreamEndHandler(stream, 'remote-stream');\r\n\r\n            getRMCMediaElement(stream, function(mediaElement) {\r\n                mediaElement.id = stream.streamid;\r\n\r\n                if (typeof StreamsHandler !== 'undefined') {\r\n                    StreamsHandler.setHandlers(stream, false, connection);\r\n                }\r\n\r\n                connection.streamEvents[stream.streamid] = {\r\n                    stream: stream,\r\n                    type: 'remote',\r\n                    userid: remoteUserId,\r\n                    extra: connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {},\r\n                    mediaElement: mediaElement,\r\n                    streamid: stream.streamid\r\n                };\r\n\r\n                setMuteHandlers(connection, connection.streamEvents[stream.streamid]);\r\n\r\n                connection.onstream(connection.streamEvents[stream.streamid]);\r\n            }, connection);\r\n        };\r\n\r\n        mPeer.onRemovingRemoteMedia = function(stream, remoteUserId) {\r\n            var streamEvent = connection.streamEvents[stream.streamid];\r\n            if (!streamEvent) {\r\n                streamEvent = {\r\n                    stream: stream,\r\n                    type: 'remote',\r\n                    userid: remoteUserId,\r\n                    extra: connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {},\r\n                    streamid: stream.streamid,\r\n                    mediaElement: connection.streamEvents[stream.streamid] ? connection.streamEvents[stream.streamid].mediaElement : null\r\n                };\r\n            }\r\n\r\n            if (connection.peersBackup[streamEvent.userid]) {\r\n                streamEvent.extra = connection.peersBackup[streamEvent.userid].extra;\r\n            }\r\n\r\n            connection.onstreamended(streamEvent);\r\n\r\n            delete connection.streamEvents[stream.streamid];\r\n        };\r\n\r\n        mPeer.onNegotiationNeeded = function(message, remoteUserId, callback) {\r\n            callback = callback || function() {};\r\n\r\n            remoteUserId = remoteUserId || message.remoteUserId;\r\n            message = message || '';\r\n\r\n            // usually a message looks like this\r\n            var messageToDeliver = {\r\n                remoteUserId: remoteUserId,\r\n                message: message,\r\n                sender: connection.userid\r\n            };\r\n\r\n            if (message.remoteUserId && message.message && message.sender) {\r\n                // if a code is manually passing required data\r\n                messageToDeliver = message;\r\n            }\r\n\r\n            connectSocket(function() {\r\n                connection.socket.emit(connection.socketMessageEvent, messageToDeliver, callback);\r\n            });\r\n        };\r\n\r\n        function onUserLeft(remoteUserId) {\r\n            connection.deletePeer(remoteUserId);\r\n        }\r\n\r\n        mPeer.onUserLeft = onUserLeft;\r\n        mPeer.disconnectWith = function(remoteUserId, callback) {\r\n            if (connection.socket) {\r\n                connection.socket.emit('disconnect-with', remoteUserId, callback || function() {});\r\n            }\r\n\r\n            connection.deletePeer(remoteUserId);\r\n        };\r\n\r\n        connection.socketOptions = {\r\n            // 'force new connection': true, // For SocketIO version < 1.0\r\n            // 'forceNew': true, // For SocketIO version >= 1.0\r\n            'transport': 'polling' // fixing transport:unknown issues\r\n        };\r\n\r\n        function connectSocket(connectCallback) {\r\n            connection.socketAutoReConnect = true;\r\n\r\n            if (connection.socket) { // todo: check here readySate/etc. to make sure socket is still opened\r\n                if (connectCallback) {\r\n                    connectCallback(connection.socket);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (typeof SocketConnection === 'undefined') {\r\n                if (typeof FirebaseConnection !== 'undefined') {\r\n                    window.SocketConnection = FirebaseConnection;\r\n                } else if (typeof PubNubConnection !== 'undefined') {\r\n                    window.SocketConnection = PubNubConnection;\r\n                } else {\r\n                    throw 'SocketConnection.js seems missed.';\r\n                }\r\n            }\r\n\r\n            new SocketConnection(connection, function(s) {\r\n                if (connectCallback) {\r\n                    connectCallback(connection.socket);\r\n                }\r\n            });\r\n        }\r\n\r\n        // 1st paramter is roomid\r\n        // 2rd paramter is a callback function\r\n        connection.openOrJoin = function(roomid, callback) {\r\n            callback = callback || function() {};\r\n\r\n            connection.checkPresence(roomid, function(isRoomExist, roomid) {\r\n                if (isRoomExist) {\r\n                    connection.sessionid = roomid;\r\n\r\n                    var localPeerSdpConstraints = false;\r\n                    var remotePeerSdpConstraints = false;\r\n                    var isOneWay = !!connection.session.oneway;\r\n                    var isDataOnly = isData(connection.session);\r\n\r\n                    remotePeerSdpConstraints = {\r\n                        OfferToReceiveAudio: connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    }\r\n\r\n                    localPeerSdpConstraints = {\r\n                        OfferToReceiveAudio: isOneWay ? !!connection.session.audio : connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: isOneWay ? !!connection.session.video || !!connection.session.screen : connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    }\r\n\r\n                    var connectionDescription = {\r\n                        remoteUserId: connection.sessionid,\r\n                        message: {\r\n                            newParticipationRequest: true,\r\n                            isOneWay: isOneWay,\r\n                            isDataOnly: isDataOnly,\r\n                            localPeerSdpConstraints: localPeerSdpConstraints,\r\n                            remotePeerSdpConstraints: remotePeerSdpConstraints\r\n                        },\r\n                        sender: connection.userid\r\n                    };\r\n\r\n                    beforeJoin(connectionDescription.message, function() {\r\n                        joinRoom(connectionDescription, callback);\r\n                    });\r\n                    return;\r\n                }\r\n\r\n                connection.waitingForLocalMedia = true;\r\n                connection.isInitiator = true;\r\n\r\n                connection.sessionid = roomid || connection.sessionid;\r\n\r\n                if (isData(connection.session)) {\r\n                    openRoom(callback);\r\n                    return;\r\n                }\r\n\r\n                connection.captureUserMedia(function() {\r\n                    openRoom(callback);\r\n                });\r\n            });\r\n        };\r\n\r\n        // don't allow someone to join this person until he has the media\r\n        connection.waitingForLocalMedia = false;\r\n\r\n        connection.open = function(roomid, callback) {\r\n            callback = callback || function() {};\r\n\r\n            connection.waitingForLocalMedia = true;\r\n            connection.isInitiator = true;\r\n\r\n            connection.sessionid = roomid || connection.sessionid;\r\n\r\n            connectSocket(function() {\r\n                if (isData(connection.session)) {\r\n                    openRoom(callback);\r\n                    return;\r\n                }\r\n\r\n                connection.captureUserMedia(function() {\r\n                    openRoom(callback);\r\n                });\r\n            });\r\n        };\r\n\r\n        // this object keeps extra-data records for all connected users\r\n        // this object is never cleared so you can always access extra-data even if a user left\r\n        connection.peersBackup = {};\r\n\r\n        connection.deletePeer = function(remoteUserId) {\r\n            if (!remoteUserId || !connection.peers[remoteUserId]) {\r\n                return;\r\n            }\r\n\r\n            var eventObject = {\r\n                userid: remoteUserId,\r\n                extra: connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {}\r\n            };\r\n\r\n            if (connection.peersBackup[eventObject.userid]) {\r\n                eventObject.extra = connection.peersBackup[eventObject.userid].extra;\r\n            }\r\n\r\n            connection.onleave(eventObject);\r\n\r\n            if (!!connection.peers[remoteUserId]) {\r\n                connection.peers[remoteUserId].streams.forEach(function(stream) {\r\n                    stream.stop();\r\n                });\r\n\r\n                var peer = connection.peers[remoteUserId].peer;\r\n                if (peer && peer.iceConnectionState !== 'closed') {\r\n                    try {\r\n                        peer.close();\r\n                    } catch (e) {}\r\n                }\r\n\r\n                if (connection.peers[remoteUserId]) {\r\n                    connection.peers[remoteUserId].peer = null;\r\n                    delete connection.peers[remoteUserId];\r\n                }\r\n            }\r\n        }\r\n\r\n        connection.rejoin = function(connectionDescription) {\r\n            if (connection.isInitiator || !connectionDescription || !Object.keys(connectionDescription).length) {\r\n                return;\r\n            }\r\n\r\n            var extra = {};\r\n\r\n            if (connection.peers[connectionDescription.remoteUserId]) {\r\n                extra = connection.peers[connectionDescription.remoteUserId].extra;\r\n                connection.deletePeer(connectionDescription.remoteUserId);\r\n            }\r\n\r\n            if (connectionDescription && connectionDescription.remoteUserId) {\r\n                connection.join(connectionDescription.remoteUserId);\r\n\r\n                connection.onReConnecting({\r\n                    userid: connectionDescription.remoteUserId,\r\n                    extra: extra\r\n                });\r\n            }\r\n        };\r\n\r\n        connection.join = function(remoteUserId, options) {\r\n            connection.sessionid = (remoteUserId ? remoteUserId.sessionid || remoteUserId.remoteUserId || remoteUserId : false) || connection.sessionid;\r\n            connection.sessionid += '';\r\n\r\n            var localPeerSdpConstraints = false;\r\n            var remotePeerSdpConstraints = false;\r\n            var isOneWay = false;\r\n            var isDataOnly = false;\r\n\r\n            if ((remoteUserId && remoteUserId.session) || !remoteUserId || typeof remoteUserId === 'string') {\r\n                var session = remoteUserId ? remoteUserId.session || connection.session : connection.session;\r\n\r\n                isOneWay = !!session.oneway;\r\n                isDataOnly = isData(session);\r\n\r\n                remotePeerSdpConstraints = {\r\n                    OfferToReceiveAudio: connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                    OfferToReceiveVideo: connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                };\r\n\r\n                localPeerSdpConstraints = {\r\n                    OfferToReceiveAudio: isOneWay ? !!connection.session.audio : connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                    OfferToReceiveVideo: isOneWay ? !!connection.session.video || !!connection.session.screen : connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                };\r\n            }\r\n\r\n            options = options || {};\r\n\r\n            var cb = function() {};\r\n            if (typeof options === 'function') {\r\n                cb = options;\r\n                options = {};\r\n            }\r\n\r\n            if (typeof options.localPeerSdpConstraints !== 'undefined') {\r\n                localPeerSdpConstraints = options.localPeerSdpConstraints;\r\n            }\r\n\r\n            if (typeof options.remotePeerSdpConstraints !== 'undefined') {\r\n                remotePeerSdpConstraints = options.remotePeerSdpConstraints;\r\n            }\r\n\r\n            if (typeof options.isOneWay !== 'undefined') {\r\n                isOneWay = options.isOneWay;\r\n            }\r\n\r\n            if (typeof options.isDataOnly !== 'undefined') {\r\n                isDataOnly = options.isDataOnly;\r\n            }\r\n\r\n            var connectionDescription = {\r\n                remoteUserId: connection.sessionid,\r\n                message: {\r\n                    newParticipationRequest: true,\r\n                    isOneWay: isOneWay,\r\n                    isDataOnly: isDataOnly,\r\n                    localPeerSdpConstraints: localPeerSdpConstraints,\r\n                    remotePeerSdpConstraints: remotePeerSdpConstraints\r\n                },\r\n                sender: connection.userid\r\n            };\r\n\r\n            beforeJoin(connectionDescription.message, function() {\r\n                connectSocket(function() {\r\n                    joinRoom(connectionDescription, cb);\r\n                });\r\n            });\r\n            return connectionDescription;\r\n        };\r\n\r\n        function joinRoom(connectionDescription, cb) {\r\n            connection.socket.emit('join-room', {\r\n                sessionid: connection.sessionid,\r\n                session: connection.session,\r\n                mediaConstraints: connection.mediaConstraints,\r\n                sdpConstraints: connection.sdpConstraints,\r\n                streams: getStreamInfoForAdmin(),\r\n                extra: connection.extra,\r\n                password: typeof connection.password !== 'undefined' && typeof connection.password !== 'object' ? connection.password : ''\r\n            }, function(isRoomJoined, error) {\r\n                if (isRoomJoined === true) {\r\n                    if (connection.enableLogs) {\r\n                        console.log('isRoomJoined: ', isRoomJoined, ' roomid: ', connection.sessionid);\r\n                    }\r\n\r\n                    if (!!connection.peers[connection.sessionid]) {\r\n                        // on socket disconnect & reconnect\r\n                        return;\r\n                    }\r\n\r\n                    mPeer.onNegotiationNeeded(connectionDescription);\r\n                }\r\n\r\n                if (isRoomJoined === false) {\r\n                    if (connection.enableLogs) {\r\n                        console.warn('isRoomJoined: ', error, ' roomid: ', connection.sessionid);\r\n                    }\r\n\r\n                    // [disabled] retry after 3 seconds\r\n                    false && setTimeout(function() {\r\n                        joinRoom(connectionDescription, cb);\r\n                    }, 3000);\r\n                }\r\n\r\n                cb(isRoomJoined, connection.sessionid, error);\r\n            });\r\n        }\r\n\r\n        connection.publicRoomIdentifier = '';\r\n\r\n        function openRoom(callback) {\r\n            if (connection.enableLogs) {\r\n                console.log('Sending open-room signal to socket.io');\r\n            }\r\n\r\n            connection.waitingForLocalMedia = false;\r\n            connection.socket.emit('open-room', {\r\n                sessionid: connection.sessionid,\r\n                session: connection.session,\r\n                mediaConstraints: connection.mediaConstraints,\r\n                sdpConstraints: connection.sdpConstraints,\r\n                streams: getStreamInfoForAdmin(),\r\n                extra: connection.extra,\r\n                identifier: connection.publicRoomIdentifier,\r\n                password: typeof connection.password !== 'undefined' && typeof connection.password !== 'object' ? connection.password : ''\r\n            }, function(isRoomOpened, error) {\r\n                if (isRoomOpened === true) {\r\n                    if (connection.enableLogs) {\r\n                        console.log('isRoomOpened: ', isRoomOpened, ' roomid: ', connection.sessionid);\r\n                    }\r\n                    callback(isRoomOpened, connection.sessionid);\r\n                }\r\n\r\n                if (isRoomOpened === false) {\r\n                    if (connection.enableLogs) {\r\n                        console.warn('isRoomOpened: ', error, ' roomid: ', connection.sessionid);\r\n                    }\r\n\r\n                    callback(isRoomOpened, connection.sessionid, error);\r\n                }\r\n            });\r\n        }\r\n\r\n        function getStreamInfoForAdmin() {\r\n            try {\r\n                return connection.streamEvents.selectAll('local').map(function(event) {\r\n                    return {\r\n                        streamid: event.streamid,\r\n                        tracks: event.stream.getTracks().length\r\n                    };\r\n                });\r\n            } catch (e) {\r\n                return [];\r\n            }\r\n        }\r\n\r\n        function beforeJoin(userPreferences, callback) {\r\n            if (connection.dontCaptureUserMedia || userPreferences.isDataOnly) {\r\n                callback();\r\n                return;\r\n            }\r\n\r\n            var localMediaConstraints = {};\r\n\r\n            if (userPreferences.localPeerSdpConstraints.OfferToReceiveAudio) {\r\n                localMediaConstraints.audio = connection.mediaConstraints.audio;\r\n            }\r\n\r\n            if (userPreferences.localPeerSdpConstraints.OfferToReceiveVideo) {\r\n                localMediaConstraints.video = connection.mediaConstraints.video;\r\n            }\r\n\r\n            var session = userPreferences.session || connection.session;\r\n\r\n            if (session.oneway && session.audio !== 'two-way' && session.video !== 'two-way' && session.screen !== 'two-way') {\r\n                callback();\r\n                return;\r\n            }\r\n\r\n            if (session.oneway && session.audio && session.audio === 'two-way') {\r\n                session = {\r\n                    audio: true\r\n                };\r\n            }\r\n\r\n            if (session.audio || session.video || session.screen) {\r\n                if (session.screen) {\r\n                    if (DetectRTC.browser.name === 'Edge') {\r\n                        navigator.getDisplayMedia({\r\n                            video: true,\r\n                            audio: isAudioPlusTab(connection)\r\n                        }).then(function(screen) {\r\n                            screen.isScreen = true;\r\n                            mPeer.onGettingLocalMedia(screen);\r\n\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                connection.invokeGetUserMedia(null, callback);\r\n                            } else {\r\n                                callback(screen);\r\n                            }\r\n                        }, function(error) {\r\n                            console.error('Unable to capture screen on Edge. HTTPs and version 17+ is required.');\r\n                        });\r\n                    } else {\r\n                        connection.invokeGetUserMedia({\r\n                            audio: isAudioPlusTab(connection),\r\n                            video: true,\r\n                            isScreen: true\r\n                        }, (session.audio || session.video) && !isAudioPlusTab(connection) ? connection.invokeGetUserMedia(null, callback) : callback);\r\n                    }\r\n                } else if (session.audio || session.video) {\r\n                    connection.invokeGetUserMedia(null, callback, session);\r\n                }\r\n            }\r\n        }\r\n\r\n        connection.getUserMedia = connection.captureUserMedia = function(callback, sessionForced) {\r\n            callback = callback || function() {};\r\n            var session = sessionForced || connection.session;\r\n\r\n            if (connection.dontCaptureUserMedia || isData(session)) {\r\n                callback();\r\n                return;\r\n            }\r\n\r\n            if (session.audio || session.video || session.screen) {\r\n                if (session.screen) {\r\n                    if (DetectRTC.browser.name === 'Edge') {\r\n                        navigator.getDisplayMedia({\r\n                            video: true,\r\n                            audio: isAudioPlusTab(connection)\r\n                        }).then(function(screen) {\r\n                            screen.isScreen = true;\r\n                            mPeer.onGettingLocalMedia(screen);\r\n\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                var nonScreenSession = {};\r\n                                for (var s in session) {\r\n                                    if (s !== 'screen') {\r\n                                        nonScreenSession[s] = session[s];\r\n                                    }\r\n                                }\r\n                                connection.invokeGetUserMedia(sessionForced, callback, nonScreenSession);\r\n                                return;\r\n                            }\r\n                            callback(screen);\r\n                        }, function(error) {\r\n                            console.error('Unable to capture screen on Edge. HTTPs and version 17+ is required.');\r\n                        });\r\n                    } else {\r\n                        connection.invokeGetUserMedia({\r\n                            audio: isAudioPlusTab(connection),\r\n                            video: true,\r\n                            isScreen: true\r\n                        }, function(stream) {\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                var nonScreenSession = {};\r\n                                for (var s in session) {\r\n                                    if (s !== 'screen') {\r\n                                        nonScreenSession[s] = session[s];\r\n                                    }\r\n                                }\r\n                                connection.invokeGetUserMedia(sessionForced, callback, nonScreenSession);\r\n                                return;\r\n                            }\r\n                            callback(stream);\r\n                        });\r\n                    }\r\n                } else if (session.audio || session.video) {\r\n                    connection.invokeGetUserMedia(sessionForced, callback, session);\r\n                }\r\n            }\r\n        };\r\n\r\n        connection.onbeforeunload = function(arg1, dontCloseSocket) {\r\n            if (!connection.closeBeforeUnload) {\r\n                return;\r\n            }\r\n\r\n            connection.peers.getAllParticipants().forEach(function(participant) {\r\n                mPeer.onNegotiationNeeded({\r\n                    userLeft: true\r\n                }, participant);\r\n\r\n                if (connection.peers[participant] && connection.peers[participant].peer) {\r\n                    connection.peers[participant].peer.close();\r\n                }\r\n\r\n                delete connection.peers[participant];\r\n            });\r\n\r\n            if (!dontCloseSocket) {\r\n                connection.closeSocket();\r\n            }\r\n\r\n            connection.isInitiator = false;\r\n        };\r\n\r\n        if (!window.ignoreBeforeUnload) {\r\n            // user can implement its own version of window.onbeforeunload\r\n            connection.closeBeforeUnload = true;\r\n            window.addEventListener('beforeunload', connection.onbeforeunload, false);\r\n        } else {\r\n            connection.closeBeforeUnload = false;\r\n        }\r\n\r\n        connection.userid = getRandomString();\r\n        connection.changeUserId = function(newUserId, callback) {\r\n            callback = callback || function() {};\r\n            connection.userid = newUserId || getRandomString();\r\n            connection.socket.emit('changed-uuid', connection.userid, callback);\r\n        };\r\n\r\n        connection.extra = {};\r\n        connection.attachStreams = [];\r\n\r\n        connection.session = {\r\n            audio: true,\r\n            video: true\r\n        };\r\n\r\n        connection.enableFileSharing = false;\r\n\r\n        // all values in kbps\r\n        connection.bandwidth = {\r\n            screen: false,\r\n            audio: false,\r\n            video: false\r\n        };\r\n\r\n        connection.codecs = {\r\n            audio: 'opus',\r\n            video: 'VP9'\r\n        };\r\n\r\n        connection.processSdp = function(sdp) {\r\n            // ignore SDP modification if unified-pan is supported\r\n            if (isUnifiedPlanSupportedDefault()) {\r\n                return sdp;\r\n            }\r\n\r\n            if (DetectRTC.browser.name === 'Safari') {\r\n                return sdp;\r\n            }\r\n\r\n            if (connection.codecs.video.toUpperCase() === 'VP8') {\r\n                sdp = CodecsHandler.preferCodec(sdp, 'vp8');\r\n            }\r\n\r\n            if (connection.codecs.video.toUpperCase() === 'VP9') {\r\n                sdp = CodecsHandler.preferCodec(sdp, 'vp9');\r\n            }\r\n\r\n            if (connection.codecs.video.toUpperCase() === 'H264') {\r\n                sdp = CodecsHandler.preferCodec(sdp, 'h264');\r\n            }\r\n\r\n            if (connection.codecs.audio === 'G722') {\r\n                sdp = CodecsHandler.removeNonG722(sdp);\r\n            }\r\n\r\n            if (DetectRTC.browser.name === 'Firefox') {\r\n                return sdp;\r\n            }\r\n\r\n            if (connection.bandwidth.video || connection.bandwidth.screen) {\r\n                sdp = CodecsHandler.setApplicationSpecificBandwidth(sdp, connection.bandwidth, !!connection.session.screen);\r\n            }\r\n\r\n            if (connection.bandwidth.video) {\r\n                sdp = CodecsHandler.setVideoBitrates(sdp, {\r\n                    min: connection.bandwidth.video * 8 * 1024,\r\n                    max: connection.bandwidth.video * 8 * 1024\r\n                });\r\n            }\r\n\r\n            if (connection.bandwidth.audio) {\r\n                sdp = CodecsHandler.setOpusAttributes(sdp, {\r\n                    maxaveragebitrate: connection.bandwidth.audio * 8 * 1024,\r\n                    maxplaybackrate: connection.bandwidth.audio * 8 * 1024,\r\n                    stereo: 1,\r\n                    maxptime: 3\r\n                });\r\n            }\r\n\r\n            return sdp;\r\n        };\r\n\r\n        if (typeof CodecsHandler !== 'undefined') {\r\n            connection.BandwidthHandler = connection.CodecsHandler = CodecsHandler;\r\n        }\r\n\r\n        connection.mediaConstraints = {\r\n            audio: {\r\n                mandatory: {},\r\n                optional: connection.bandwidth.audio ? [{\r\n                    bandwidth: connection.bandwidth.audio * 8 * 1024 || 128 * 8 * 1024\r\n                }] : []\r\n            },\r\n            video: {\r\n                mandatory: {},\r\n                optional: connection.bandwidth.video ? [{\r\n                    bandwidth: connection.bandwidth.video * 8 * 1024 || 128 * 8 * 1024\r\n                }, {\r\n                    facingMode: 'user'\r\n                }] : [{\r\n                    facingMode: 'user'\r\n                }]\r\n            }\r\n        };\r\n\r\n        if (DetectRTC.browser.name === 'Firefox') {\r\n            connection.mediaConstraints = {\r\n                audio: true,\r\n                video: true\r\n            };\r\n        }\r\n\r\n        if (!forceOptions.useDefaultDevices && !DetectRTC.isMobileDevice) {\r\n            DetectRTC.load(function() {\r\n                var lastAudioDevice, lastVideoDevice;\r\n                // it will force RTCMultiConnection to capture last-devices\r\n                // i.e. if external microphone is attached to system, we should prefer it over built-in devices.\r\n                DetectRTC.MediaDevices.forEach(function(device) {\r\n                    if (device.kind === 'audioinput' && connection.mediaConstraints.audio !== false) {\r\n                        lastAudioDevice = device;\r\n                    }\r\n\r\n                    if (device.kind === 'videoinput' && connection.mediaConstraints.video !== false) {\r\n                        lastVideoDevice = device;\r\n                    }\r\n                });\r\n\r\n                if (lastAudioDevice) {\r\n                    if (DetectRTC.browser.name === 'Firefox') {\r\n                        if (connection.mediaConstraints.audio !== true) {\r\n                            connection.mediaConstraints.audio.deviceId = lastAudioDevice.id;\r\n                        } else {\r\n                            connection.mediaConstraints.audio = {\r\n                                deviceId: lastAudioDevice.id\r\n                            }\r\n                        }\r\n                        return;\r\n                    }\r\n\r\n                    if (connection.mediaConstraints.audio == true) {\r\n                        connection.mediaConstraints.audio = {\r\n                            mandatory: {},\r\n                            optional: []\r\n                        }\r\n                    }\r\n\r\n                    if (!connection.mediaConstraints.audio.optional) {\r\n                        connection.mediaConstraints.audio.optional = [];\r\n                    }\r\n\r\n                    var optional = [{\r\n                        sourceId: lastAudioDevice.id\r\n                    }];\r\n\r\n                    connection.mediaConstraints.audio.optional = optional.concat(connection.mediaConstraints.audio.optional);\r\n                }\r\n\r\n                if (lastVideoDevice) {\r\n                    if (DetectRTC.browser.name === 'Firefox') {\r\n                        if (connection.mediaConstraints.video !== true) {\r\n                            connection.mediaConstraints.video.deviceId = lastVideoDevice.id;\r\n                        } else {\r\n                            connection.mediaConstraints.video = {\r\n                                deviceId: lastVideoDevice.id\r\n                            }\r\n                        }\r\n                        return;\r\n                    }\r\n\r\n                    if (connection.mediaConstraints.video == true) {\r\n                        connection.mediaConstraints.video = {\r\n                            mandatory: {},\r\n                            optional: []\r\n                        }\r\n                    }\r\n\r\n                    if (!connection.mediaConstraints.video.optional) {\r\n                        connection.mediaConstraints.video.optional = [];\r\n                    }\r\n\r\n                    var optional = [{\r\n                        sourceId: lastVideoDevice.id\r\n                    }];\r\n\r\n                    connection.mediaConstraints.video.optional = optional.concat(connection.mediaConstraints.video.optional);\r\n                }\r\n            });\r\n        }\r\n\r\n        connection.sdpConstraints = {\r\n            mandatory: {\r\n                OfferToReceiveAudio: true,\r\n                OfferToReceiveVideo: true\r\n            },\r\n            optional: [{\r\n                VoiceActivityDetection: false\r\n            }]\r\n        };\r\n\r\n        connection.sdpSemantics = null; // \"unified-plan\" or \"plan-b\", ref: webrtc.org/web-apis/chrome/unified-plan/\r\n        connection.iceCandidatePoolSize = null; // 0\r\n        connection.bundlePolicy = null; // max-bundle\r\n        connection.rtcpMuxPolicy = null; // \"require\" or \"negotiate\"\r\n        connection.iceTransportPolicy = null; // \"relay\" or \"all\"\r\n        connection.optionalArgument = {\r\n            optional: [{\r\n                DtlsSrtpKeyAgreement: true\r\n            }, {\r\n                googImprovedWifiBwe: true\r\n            }, {\r\n                googScreencastMinBitrate: 300\r\n            }, {\r\n                googIPv6: true\r\n            }, {\r\n                googDscp: true\r\n            }, {\r\n                googCpuUnderuseThreshold: 55\r\n            }, {\r\n                googCpuOveruseThreshold: 85\r\n            }, {\r\n                googSuspendBelowMinBitrate: true\r\n            }, {\r\n                googCpuOveruseDetection: true\r\n            }],\r\n            mandatory: {}\r\n        };\r\n\r\n        connection.iceServers = IceServersHandler.getIceServers(connection);\r\n\r\n        connection.candidates = {\r\n            host: true,\r\n            stun: true,\r\n            turn: true\r\n        };\r\n\r\n        connection.iceProtocols = {\r\n            tcp: true,\r\n            udp: true\r\n        };\r\n\r\n        // EVENTs\r\n        connection.onopen = function(event) {\r\n            if (!!connection.enableLogs) {\r\n                console.info('Data connection has been opened between you & ', event.userid);\r\n            }\r\n        };\r\n\r\n        connection.onclose = function(event) {\r\n            if (!!connection.enableLogs) {\r\n                console.warn('Data connection has been closed between you & ', event.userid);\r\n            }\r\n        };\r\n\r\n        connection.onerror = function(error) {\r\n            if (!!connection.enableLogs) {\r\n                console.error(error.userid, 'data-error', error);\r\n            }\r\n        };\r\n\r\n        connection.onmessage = function(event) {\r\n            if (!!connection.enableLogs) {\r\n                console.debug('data-message', event.userid, event.data);\r\n            }\r\n        };\r\n\r\n        connection.send = function(data, remoteUserId) {\r\n            connection.peers.send(data, remoteUserId);\r\n        };\r\n\r\n        connection.close = connection.disconnect = connection.leave = function() {\r\n            connection.onbeforeunload(false, true);\r\n        };\r\n\r\n        connection.closeEntireSession = function(callback) {\r\n            callback = callback || function() {};\r\n            connection.socket.emit('close-entire-session', function looper() {\r\n                if (connection.getAllParticipants().length) {\r\n                    setTimeout(looper, 100);\r\n                    return;\r\n                }\r\n\r\n                connection.onEntireSessionClosed({\r\n                    sessionid: connection.sessionid,\r\n                    userid: connection.userid,\r\n                    extra: connection.extra\r\n                });\r\n\r\n                connection.changeUserId(null, function() {\r\n                    connection.close();\r\n                    callback();\r\n                });\r\n            });\r\n        };\r\n\r\n        connection.onEntireSessionClosed = function(event) {\r\n            if (!connection.enableLogs) return;\r\n            console.info('Entire session is closed: ', event.sessionid, event.extra);\r\n        };\r\n\r\n        connection.onstream = function(e) {\r\n            var parentNode = connection.videosContainer;\r\n            parentNode.insertBefore(e.mediaElement, parentNode.firstChild);\r\n            var played = e.mediaElement.play();\r\n\r\n            if (typeof played !== 'undefined') {\r\n                played.catch(function() {\r\n                    /*** iOS 11 doesn't allow automatic play and rejects ***/\r\n                }).then(function() {\r\n                    setTimeout(function() {\r\n                        e.mediaElement.play();\r\n                    }, 2000);\r\n                });\r\n                return;\r\n            }\r\n\r\n            setTimeout(function() {\r\n                e.mediaElement.play();\r\n            }, 2000);\r\n        };\r\n\r\n        connection.onstreamended = function(e) {\r\n            if (!e.mediaElement) {\r\n                e.mediaElement = document.getElementById(e.streamid);\r\n            }\r\n\r\n            if (!e.mediaElement || !e.mediaElement.parentNode) {\r\n                return;\r\n            }\r\n\r\n            e.mediaElement.parentNode.removeChild(e.mediaElement);\r\n        };\r\n\r\n        connection.direction = 'many-to-many';\r\n\r\n        connection.removeStream = function(streamid, remoteUserId) {\r\n            var stream;\r\n            connection.attachStreams.forEach(function(localStream) {\r\n                if (localStream.id === streamid) {\r\n                    stream = localStream;\r\n                }\r\n            });\r\n\r\n            if (!stream) {\r\n                console.warn('No such stream exist.', streamid);\r\n                return;\r\n            }\r\n\r\n            connection.peers.getAllParticipants().forEach(function(participant) {\r\n                if (remoteUserId && participant !== remoteUserId) {\r\n                    return;\r\n                }\r\n\r\n                var user = connection.peers[participant];\r\n                try {\r\n                    user.peer.removeStream(stream);\r\n                } catch (e) {}\r\n            });\r\n\r\n            connection.renegotiate();\r\n        };\r\n\r\n        connection.addStream = function(session, remoteUserId) {\r\n            if (!!session.getTracks) {\r\n                if (connection.attachStreams.indexOf(session) === -1) {\r\n                    if (!session.streamid) {\r\n                        session.streamid = session.id;\r\n                    }\r\n\r\n                    connection.attachStreams.push(session);\r\n                }\r\n                connection.renegotiate(remoteUserId);\r\n                return;\r\n            }\r\n\r\n            if (isData(session)) {\r\n                connection.renegotiate(remoteUserId);\r\n                return;\r\n            }\r\n\r\n            if (session.audio || session.video || session.screen) {\r\n                if (session.screen) {\r\n                    if (DetectRTC.browser.name === 'Edge') {\r\n                        navigator.getDisplayMedia({\r\n                            video: true,\r\n                            audio: isAudioPlusTab(connection)\r\n                        }).then(function(screen) {\r\n                            screen.isScreen = true;\r\n                            mPeer.onGettingLocalMedia(screen);\r\n\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                connection.invokeGetUserMedia(null, function(stream) {\r\n                                    gumCallback(stream);\r\n                                });\r\n                            } else {\r\n                                gumCallback(screen);\r\n                            }\r\n                        }, function(error) {\r\n                            console.error('Unable to capture screen on Edge. HTTPs and version 17+ is required.');\r\n                        });\r\n                    } else {\r\n                        connection.invokeGetUserMedia({\r\n                            audio: isAudioPlusTab(connection),\r\n                            video: true,\r\n                            isScreen: true\r\n                        }, function(stream) {\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                connection.invokeGetUserMedia(null, function(stream) {\r\n                                    gumCallback(stream);\r\n                                });\r\n                            } else {\r\n                                gumCallback(stream);\r\n                            }\r\n                        });\r\n                    }\r\n                } else if (session.audio || session.video) {\r\n                    connection.invokeGetUserMedia(null, gumCallback);\r\n                }\r\n            }\r\n\r\n            function gumCallback(stream) {\r\n                if (session.streamCallback) {\r\n                    session.streamCallback(stream);\r\n                }\r\n\r\n                connection.renegotiate(remoteUserId);\r\n            }\r\n        };\r\n\r\n        connection.invokeGetUserMedia = function(localMediaConstraints, callback, session) {\r\n            if (!session) {\r\n                session = connection.session;\r\n            }\r\n\r\n            if (!localMediaConstraints) {\r\n                localMediaConstraints = connection.mediaConstraints;\r\n            }\r\n\r\n            getUserMediaHandler({\r\n                onGettingLocalMedia: function(stream) {\r\n                    var videoConstraints = localMediaConstraints.video;\r\n                    if (videoConstraints) {\r\n                        if (videoConstraints.mediaSource || videoConstraints.mozMediaSource) {\r\n                            stream.isScreen = true;\r\n                        } else if (videoConstraints.mandatory && videoConstraints.mandatory.chromeMediaSource) {\r\n                            stream.isScreen = true;\r\n                        }\r\n                    }\r\n\r\n                    if (!stream.isScreen) {\r\n                        stream.isVideo = !!getTracks(stream, 'video').length;\r\n                        stream.isAudio = !stream.isVideo && getTracks(stream, 'audio').length;\r\n                    }\r\n\r\n                    mPeer.onGettingLocalMedia(stream, function() {\r\n                        if (typeof callback === 'function') {\r\n                            callback(stream);\r\n                        }\r\n                    });\r\n                },\r\n                onLocalMediaError: function(error, constraints) {\r\n                    mPeer.onLocalMediaError(error, constraints);\r\n                },\r\n                localMediaConstraints: localMediaConstraints || {\r\n                    audio: session.audio ? localMediaConstraints.audio : false,\r\n                    video: session.video ? localMediaConstraints.video : false\r\n                }\r\n            });\r\n        };\r\n\r\n        function applyConstraints(stream, mediaConstraints) {\r\n            if (!stream) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('No stream to applyConstraints.');\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (mediaConstraints.audio) {\r\n                getTracks(stream, 'audio').forEach(function(track) {\r\n                    track.applyConstraints(mediaConstraints.audio);\r\n                });\r\n            }\r\n\r\n            if (mediaConstraints.video) {\r\n                getTracks(stream, 'video').forEach(function(track) {\r\n                    track.applyConstraints(mediaConstraints.video);\r\n                });\r\n            }\r\n        }\r\n\r\n        connection.applyConstraints = function(mediaConstraints, streamid) {\r\n            if (!MediaStreamTrack || !MediaStreamTrack.prototype.applyConstraints) {\r\n                alert('track.applyConstraints is NOT supported in your browser.');\r\n                return;\r\n            }\r\n\r\n            if (streamid) {\r\n                var stream;\r\n                if (connection.streamEvents[streamid]) {\r\n                    stream = connection.streamEvents[streamid].stream;\r\n                }\r\n                applyConstraints(stream, mediaConstraints);\r\n                return;\r\n            }\r\n\r\n            connection.attachStreams.forEach(function(stream) {\r\n                applyConstraints(stream, mediaConstraints);\r\n            });\r\n        };\r\n\r\n        function replaceTrack(track, remoteUserId, isVideoTrack) {\r\n            if (remoteUserId) {\r\n                mPeer.replaceTrack(track, remoteUserId, isVideoTrack);\r\n                return;\r\n            }\r\n\r\n            connection.peers.getAllParticipants().forEach(function(participant) {\r\n                mPeer.replaceTrack(track, participant, isVideoTrack);\r\n            });\r\n        }\r\n\r\n        connection.replaceTrack = function(session, remoteUserId, isVideoTrack) {\r\n            session = session || {};\r\n\r\n            if (!RTCPeerConnection.prototype.getSenders) {\r\n                connection.addStream(session);\r\n                return;\r\n            }\r\n\r\n            if (session instanceof MediaStreamTrack) {\r\n                replaceTrack(session, remoteUserId, isVideoTrack);\r\n                return;\r\n            }\r\n\r\n            if (session instanceof MediaStream) {\r\n                if (getTracks(session, 'video').length) {\r\n                    replaceTrack(getTracks(session, 'video')[0], remoteUserId, true);\r\n                }\r\n\r\n                if (getTracks(session, 'audio').length) {\r\n                    replaceTrack(getTracks(session, 'audio')[0], remoteUserId, false);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (isData(session)) {\r\n                throw 'connection.replaceTrack requires audio and/or video and/or screen.';\r\n                return;\r\n            }\r\n\r\n            if (session.audio || session.video || session.screen) {\r\n                if (session.screen) {\r\n                    if (DetectRTC.browser.name === 'Edge') {\r\n                        navigator.getDisplayMedia({\r\n                            video: true,\r\n                            audio: isAudioPlusTab(connection)\r\n                        }).then(function(screen) {\r\n                            screen.isScreen = true;\r\n                            mPeer.onGettingLocalMedia(screen);\r\n\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                connection.invokeGetUserMedia(null, gumCallback);\r\n                            } else {\r\n                                gumCallback(screen);\r\n                            }\r\n                        }, function(error) {\r\n                            console.error('Unable to capture screen on Edge. HTTPs and version 17+ is required.');\r\n                        });\r\n                    } else {\r\n                        connection.invokeGetUserMedia({\r\n                            audio: isAudioPlusTab(connection),\r\n                            video: true,\r\n                            isScreen: true\r\n                        }, (session.audio || session.video) && !isAudioPlusTab(connection) ? connection.invokeGetUserMedia(null, gumCallback) : gumCallback);\r\n                    }\r\n                } else if (session.audio || session.video) {\r\n                    connection.invokeGetUserMedia(null, gumCallback);\r\n                }\r\n            }\r\n\r\n            function gumCallback(stream) {\r\n                connection.replaceTrack(stream, remoteUserId, isVideoTrack || session.video || session.screen);\r\n            }\r\n        };\r\n\r\n        connection.resetTrack = function(remoteUsersIds, isVideoTrack) {\r\n            if (!remoteUsersIds) {\r\n                remoteUsersIds = connection.getAllParticipants();\r\n            }\r\n\r\n            if (typeof remoteUsersIds == 'string') {\r\n                remoteUsersIds = [remoteUsersIds];\r\n            }\r\n\r\n            remoteUsersIds.forEach(function(participant) {\r\n                var peer = connection.peers[participant].peer;\r\n\r\n                if ((typeof isVideoTrack === 'undefined' || isVideoTrack === true) && peer.lastVideoTrack) {\r\n                    connection.replaceTrack(peer.lastVideoTrack, participant, true);\r\n                }\r\n\r\n                if ((typeof isVideoTrack === 'undefined' || isVideoTrack === false) && peer.lastAudioTrack) {\r\n                    connection.replaceTrack(peer.lastAudioTrack, participant, false);\r\n                }\r\n            });\r\n        };\r\n\r\n        connection.renegotiate = function(remoteUserId) {\r\n            if (remoteUserId) {\r\n                mPeer.renegotiatePeer(remoteUserId);\r\n                return;\r\n            }\r\n\r\n            connection.peers.getAllParticipants().forEach(function(participant) {\r\n                mPeer.renegotiatePeer(participant);\r\n            });\r\n        };\r\n\r\n        connection.setStreamEndHandler = function(stream, isRemote) {\r\n            if (!stream || !stream.addEventListener) return;\r\n\r\n            isRemote = !!isRemote;\r\n\r\n            if (stream.alreadySetEndHandler) {\r\n                return;\r\n            }\r\n            stream.alreadySetEndHandler = true;\r\n\r\n            var streamEndedEvent = 'ended';\r\n\r\n            if ('oninactive' in stream) {\r\n                streamEndedEvent = 'inactive';\r\n            }\r\n\r\n            stream.addEventListener(streamEndedEvent, function() {\r\n                if (stream.idInstance) {\r\n                    currentUserMediaRequest.remove(stream.idInstance);\r\n                }\r\n\r\n                if (!isRemote) {\r\n                    // reset attachStreams\r\n                    var streams = [];\r\n                    connection.attachStreams.forEach(function(s) {\r\n                        if (s.id != stream.id) {\r\n                            streams.push(s);\r\n                        }\r\n                    });\r\n                    connection.attachStreams = streams;\r\n                }\r\n\r\n                // connection.renegotiate();\r\n\r\n                var streamEvent = connection.streamEvents[stream.streamid];\r\n                if (!streamEvent) {\r\n                    streamEvent = {\r\n                        stream: stream,\r\n                        streamid: stream.streamid,\r\n                        type: isRemote ? 'remote' : 'local',\r\n                        userid: connection.userid,\r\n                        extra: connection.extra,\r\n                        mediaElement: connection.streamEvents[stream.streamid] ? connection.streamEvents[stream.streamid].mediaElement : null\r\n                    };\r\n                }\r\n\r\n                if (isRemote && connection.peers[streamEvent.userid]) {\r\n                    // reset remote \"streams\"\r\n                    var peer = connection.peers[streamEvent.userid].peer;\r\n                    var streams = [];\r\n                    peer.getRemoteStreams().forEach(function(s) {\r\n                        if (s.id != stream.id) {\r\n                            streams.push(s);\r\n                        }\r\n                    });\r\n                    connection.peers[streamEvent.userid].streams = streams;\r\n                }\r\n\r\n                if (streamEvent.userid === connection.userid && streamEvent.type === 'remote') {\r\n                    return;\r\n                }\r\n\r\n                if (connection.peersBackup[streamEvent.userid]) {\r\n                    streamEvent.extra = connection.peersBackup[streamEvent.userid].extra;\r\n                }\r\n\r\n                connection.onstreamended(streamEvent);\r\n\r\n                delete connection.streamEvents[stream.streamid];\r\n            }, false);\r\n        };\r\n\r\n        connection.onMediaError = function(error, constraints) {\r\n            if (!!connection.enableLogs) {\r\n                console.error(error, constraints);\r\n            }\r\n        };\r\n\r\n        connection.autoCloseEntireSession = false;\r\n\r\n        connection.filesContainer = connection.videosContainer = document.body || document.documentElement;\r\n        connection.isInitiator = false;\r\n\r\n        connection.shareFile = mPeer.shareFile;\r\n        if (typeof FileProgressBarHandler !== 'undefined') {\r\n            FileProgressBarHandler.handle(connection);\r\n        }\r\n\r\n        if (typeof TranslationHandler !== 'undefined') {\r\n            TranslationHandler.handle(connection);\r\n        }\r\n\r\n        connection.token = getRandomString;\r\n\r\n        connection.onNewParticipant = function(participantId, userPreferences) {\r\n            connection.acceptParticipationRequest(participantId, userPreferences);\r\n        };\r\n\r\n        connection.acceptParticipationRequest = function(participantId, userPreferences) {\r\n            if (userPreferences.successCallback) {\r\n                userPreferences.successCallback();\r\n                delete userPreferences.successCallback;\r\n            }\r\n\r\n            mPeer.createNewPeer(participantId, userPreferences);\r\n        };\r\n\r\n        if (typeof StreamsHandler !== 'undefined') {\r\n            connection.StreamsHandler = StreamsHandler;\r\n        }\r\n\r\n        connection.onleave = function(userid) {};\r\n\r\n        connection.invokeSelectFileDialog = function(callback) {\r\n            var selector = new FileSelector();\r\n            selector.accept = '*.*';\r\n            selector.selectSingleFile(callback);\r\n        };\r\n\r\n        connection.onmute = function(e) {\r\n            if (!e || !e.mediaElement) {\r\n                return;\r\n            }\r\n\r\n            if (e.muteType === 'both' || e.muteType === 'video') {\r\n                e.mediaElement.src = null;\r\n                var paused = e.mediaElement.pause();\r\n                if (typeof paused !== 'undefined') {\r\n                    paused.then(function() {\r\n                        e.mediaElement.poster = e.snapshot || 'https://cdn.webrtc-experiment.com/images/muted.png';\r\n                    });\r\n                } else {\r\n                    e.mediaElement.poster = e.snapshot || 'https://cdn.webrtc-experiment.com/images/muted.png';\r\n                }\r\n            } else if (e.muteType === 'audio') {\r\n                e.mediaElement.muted = true;\r\n            }\r\n        };\r\n\r\n        connection.onunmute = function(e) {\r\n            if (!e || !e.mediaElement || !e.stream) {\r\n                return;\r\n            }\r\n\r\n            if (e.unmuteType === 'both' || e.unmuteType === 'video') {\r\n                e.mediaElement.poster = null;\r\n                e.mediaElement.srcObject = e.stream;\r\n                e.mediaElement.play();\r\n            } else if (e.unmuteType === 'audio') {\r\n                e.mediaElement.muted = false;\r\n            }\r\n        };\r\n\r\n        connection.onExtraDataUpdated = function(event) {\r\n            event.status = 'online';\r\n            connection.onUserStatusChanged(event, true);\r\n        };\r\n\r\n        connection.getAllParticipants = function(sender) {\r\n            return connection.peers.getAllParticipants(sender);\r\n        };\r\n\r\n        if (typeof StreamsHandler !== 'undefined') {\r\n            StreamsHandler.onSyncNeeded = function(streamid, action, type) {\r\n                connection.peers.getAllParticipants().forEach(function(participant) {\r\n                    mPeer.onNegotiationNeeded({\r\n                        streamid: streamid,\r\n                        action: action,\r\n                        streamSyncNeeded: true,\r\n                        type: type || 'both'\r\n                    }, participant);\r\n                });\r\n            };\r\n        }\r\n\r\n        connection.connectSocket = function(callback) {\r\n            connectSocket(callback);\r\n        };\r\n\r\n        connection.closeSocket = function() {\r\n            try {\r\n                io.sockets = {};\r\n            } catch (e) {};\r\n\r\n            if (!connection.socket) return;\r\n\r\n            if (typeof connection.socket.disconnect === 'function') {\r\n                connection.socket.disconnect();\r\n            }\r\n\r\n            if (typeof connection.socket.resetProps === 'function') {\r\n                connection.socket.resetProps();\r\n            }\r\n\r\n            connection.socket = null;\r\n        };\r\n\r\n        connection.getSocket = function(callback) {\r\n            if (!callback && connection.enableLogs) {\r\n                console.warn('getSocket.callback paramter is required.');\r\n            }\r\n\r\n            callback = callback || function() {};\r\n\r\n            if (!connection.socket) {\r\n                connectSocket(function() {\r\n                    callback(connection.socket);\r\n                });\r\n            } else {\r\n                callback(connection.socket);\r\n            }\r\n\r\n            return connection.socket; // callback is preferred over return-statement\r\n        };\r\n\r\n        connection.getRemoteStreams = mPeer.getRemoteStreams;\r\n\r\n        var skipStreams = ['selectFirst', 'selectAll', 'forEach'];\r\n\r\n        connection.streamEvents = {\r\n            selectFirst: function(options) {\r\n                return connection.streamEvents.selectAll(options)[0];\r\n            },\r\n            selectAll: function(options) {\r\n                if (!options) {\r\n                    // default will always be all streams\r\n                    options = {\r\n                        local: true,\r\n                        remote: true,\r\n                        isScreen: true,\r\n                        isAudio: true,\r\n                        isVideo: true\r\n                    };\r\n                }\r\n\r\n                if (options == 'local') {\r\n                    options = {\r\n                        local: true\r\n                    };\r\n                }\r\n\r\n                if (options == 'remote') {\r\n                    options = {\r\n                        remote: true\r\n                    };\r\n                }\r\n\r\n                if (options == 'screen') {\r\n                    options = {\r\n                        isScreen: true\r\n                    };\r\n                }\r\n\r\n                if (options == 'audio') {\r\n                    options = {\r\n                        isAudio: true\r\n                    };\r\n                }\r\n\r\n                if (options == 'video') {\r\n                    options = {\r\n                        isVideo: true\r\n                    };\r\n                }\r\n\r\n                var streams = [];\r\n                Object.keys(connection.streamEvents).forEach(function(key) {\r\n                    var event = connection.streamEvents[key];\r\n\r\n                    if (skipStreams.indexOf(key) !== -1) return;\r\n                    var ignore = true;\r\n\r\n                    if (options.local && event.type === 'local') {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (options.remote && event.type === 'remote') {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (options.isScreen && event.stream.isScreen) {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (options.isVideo && event.stream.isVideo) {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (options.isAudio && event.stream.isAudio) {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (options.userid && event.userid === options.userid) {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (ignore === false) {\r\n                        streams.push(event);\r\n                    }\r\n                });\r\n\r\n                return streams;\r\n            }\r\n        };\r\n\r\n        connection.socketURL = '/'; // generated via config.json\r\n        connection.socketMessageEvent = 'RTCMultiConnection-Message'; // generated via config.json\r\n        connection.socketCustomEvent = 'RTCMultiConnection-Custom-Message'; // generated via config.json\r\n        connection.DetectRTC = DetectRTC;\r\n\r\n        connection.setCustomSocketEvent = function(customEvent) {\r\n            if (customEvent) {\r\n                connection.socketCustomEvent = customEvent;\r\n            }\r\n\r\n            if (!connection.socket) {\r\n                return;\r\n            }\r\n\r\n            connection.socket.emit('set-custom-socket-event-listener', connection.socketCustomEvent);\r\n        };\r\n\r\n        connection.getNumberOfBroadcastViewers = function(broadcastId, callback) {\r\n            if (!connection.socket || !broadcastId || !callback) return;\r\n\r\n            connection.socket.emit('get-number-of-users-in-specific-broadcast', broadcastId, callback);\r\n        };\r\n\r\n        connection.onNumberOfBroadcastViewersUpdated = function(event) {\r\n            if (!connection.enableLogs || !connection.isInitiator) return;\r\n            console.info('Number of broadcast (', event.broadcastId, ') viewers', event.numberOfBroadcastViewers);\r\n        };\r\n\r\n        connection.onUserStatusChanged = function(event, dontWriteLogs) {\r\n            if (!!connection.enableLogs && !dontWriteLogs) {\r\n                console.info(event.userid, event.status);\r\n            }\r\n        };\r\n\r\n        connection.getUserMediaHandler = getUserMediaHandler;\r\n        connection.multiPeersHandler = mPeer;\r\n        connection.enableLogs = true;\r\n        connection.setCustomSocketHandler = function(customSocketHandler) {\r\n            if (typeof SocketConnection !== 'undefined') {\r\n                SocketConnection = customSocketHandler;\r\n            }\r\n        };\r\n\r\n        // default value should be 15k because [old]Firefox's receiving limit is 16k!\r\n        // however 64k works chrome-to-chrome\r\n        connection.chunkSize = 40 * 1000;\r\n\r\n        connection.maxParticipantsAllowed = 1000;\r\n\r\n        // eject or leave single user\r\n        connection.disconnectWith = mPeer.disconnectWith;\r\n\r\n        // check if room exist on server\r\n        // we will pass roomid to the server and wait for callback (i.e. server's response)\r\n        connection.checkPresence = function(roomid, callback) {\r\n            roomid = roomid || connection.sessionid;\r\n\r\n            if (SocketConnection.name === 'SSEConnection') {\r\n                SSEConnection.checkPresence(roomid, function(isRoomExist, _roomid, extra) {\r\n                    if (!connection.socket) {\r\n                        if (!isRoomExist) {\r\n                            connection.userid = _roomid;\r\n                        }\r\n\r\n                        connection.connectSocket(function() {\r\n                            callback(isRoomExist, _roomid, extra);\r\n                        });\r\n                        return;\r\n                    }\r\n                    callback(isRoomExist, _roomid);\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (!connection.socket) {\r\n                connection.connectSocket(function() {\r\n                    connection.checkPresence(roomid, callback);\r\n                });\r\n                return;\r\n            }\r\n\r\n            connection.socket.emit('check-presence', roomid + '', function(isRoomExist, _roomid, extra) {\r\n                if (connection.enableLogs) {\r\n                    console.log('checkPresence.isRoomExist: ', isRoomExist, ' roomid: ', _roomid);\r\n                }\r\n                callback(isRoomExist, _roomid, extra);\r\n            });\r\n        };\r\n\r\n        connection.onReadyForOffer = function(remoteUserId, userPreferences) {\r\n            connection.multiPeersHandler.createNewPeer(remoteUserId, userPreferences);\r\n        };\r\n\r\n        connection.setUserPreferences = function(userPreferences) {\r\n            if (connection.dontAttachStream) {\r\n                userPreferences.dontAttachLocalStream = true;\r\n            }\r\n\r\n            if (connection.dontGetRemoteStream) {\r\n                userPreferences.dontGetRemoteStream = true;\r\n            }\r\n\r\n            return userPreferences;\r\n        };\r\n\r\n        connection.updateExtraData = function() {\r\n            connection.socket.emit('extra-data-updated', connection.extra);\r\n        };\r\n\r\n        connection.enableScalableBroadcast = false;\r\n        connection.maxRelayLimitPerUser = 3; // each broadcast should serve only 3 users\r\n\r\n        connection.dontCaptureUserMedia = false;\r\n        connection.dontAttachStream = false;\r\n        connection.dontGetRemoteStream = false;\r\n\r\n        connection.onReConnecting = function(event) {\r\n            if (connection.enableLogs) {\r\n                console.info('ReConnecting with', event.userid, '...');\r\n            }\r\n        };\r\n\r\n        connection.beforeAddingStream = function(stream) {\r\n            return stream;\r\n        };\r\n\r\n        connection.beforeRemovingStream = function(stream) {\r\n            return stream;\r\n        };\r\n\r\n        if (typeof isChromeExtensionAvailable !== 'undefined') {\r\n            connection.checkIfChromeExtensionAvailable = isChromeExtensionAvailable;\r\n        }\r\n\r\n        if (typeof isFirefoxExtensionAvailable !== 'undefined') {\r\n            connection.checkIfChromeExtensionAvailable = isFirefoxExtensionAvailable;\r\n        }\r\n\r\n        if (typeof getChromeExtensionStatus !== 'undefined') {\r\n            connection.getChromeExtensionStatus = getChromeExtensionStatus;\r\n        }\r\n\r\n        connection.modifyScreenConstraints = function(screen_constraints) {\r\n            return screen_constraints;\r\n        };\r\n\r\n        connection.onPeerStateChanged = function(state) {\r\n            if (connection.enableLogs) {\r\n                if (state.iceConnectionState.search(/closed|failed/gi) !== -1) {\r\n                    console.error('Peer connection is closed between you & ', state.userid, state.extra, 'state:', state.iceConnectionState);\r\n                }\r\n            }\r\n        };\r\n\r\n        connection.isOnline = true;\r\n\r\n        listenEventHandler('online', function() {\r\n            connection.isOnline = true;\r\n        });\r\n\r\n        listenEventHandler('offline', function() {\r\n            connection.isOnline = false;\r\n        });\r\n\r\n        connection.isLowBandwidth = false;\r\n        if (navigator && navigator.connection && navigator.connection.type) {\r\n            connection.isLowBandwidth = navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g) !== -1;\r\n            if (connection.isLowBandwidth) {\r\n                connection.bandwidth = {\r\n                    audio: false,\r\n                    video: false,\r\n                    screen: false\r\n                };\r\n\r\n                if (connection.mediaConstraints.audio && connection.mediaConstraints.audio.optional && connection.mediaConstraints.audio.optional.length) {\r\n                    var newArray = [];\r\n                    connection.mediaConstraints.audio.optional.forEach(function(opt) {\r\n                        if (typeof opt.bandwidth === 'undefined') {\r\n                            newArray.push(opt);\r\n                        }\r\n                    });\r\n                    connection.mediaConstraints.audio.optional = newArray;\r\n                }\r\n\r\n                if (connection.mediaConstraints.video && connection.mediaConstraints.video.optional && connection.mediaConstraints.video.optional.length) {\r\n                    var newArray = [];\r\n                    connection.mediaConstraints.video.optional.forEach(function(opt) {\r\n                        if (typeof opt.bandwidth === 'undefined') {\r\n                            newArray.push(opt);\r\n                        }\r\n                    });\r\n                    connection.mediaConstraints.video.optional = newArray;\r\n                }\r\n            }\r\n        }\r\n\r\n        connection.getExtraData = function(remoteUserId, callback) {\r\n            if (!remoteUserId) throw 'remoteUserId is required.';\r\n\r\n            if (typeof callback === 'function') {\r\n                connection.socket.emit('get-remote-user-extra-data', remoteUserId, function(extra, remoteUserId, error) {\r\n                    callback(extra, remoteUserId, error);\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (!connection.peers[remoteUserId]) {\r\n                if (connection.peersBackup[remoteUserId]) {\r\n                    return connection.peersBackup[remoteUserId].extra;\r\n                }\r\n                return {};\r\n            }\r\n\r\n            return connection.peers[remoteUserId].extra;\r\n        };\r\n\r\n        if (!!forceOptions.autoOpenOrJoin) {\r\n            connection.openOrJoin(connection.sessionid);\r\n        }\r\n\r\n        connection.onUserIdAlreadyTaken = function(useridAlreadyTaken, yourNewUserId) {\r\n            // via #683\r\n            connection.close();\r\n            connection.closeSocket();\r\n\r\n            connection.isInitiator = false;\r\n            connection.userid = connection.token();\r\n\r\n            connection.join(connection.sessionid);\r\n\r\n            if (connection.enableLogs) {\r\n                console.warn('Userid already taken.', useridAlreadyTaken, 'Your new userid:', connection.userid);\r\n            }\r\n        };\r\n\r\n        connection.trickleIce = true;\r\n        connection.version = '3.6.9';\r\n\r\n        connection.onSettingLocalDescription = function(event) {\r\n            if (connection.enableLogs) {\r\n                console.info('Set local description for remote user', event.userid);\r\n            }\r\n        };\r\n\r\n        connection.resetScreen = function() {\r\n            sourceId = null;\r\n            if (DetectRTC && DetectRTC.screen) {\r\n                delete DetectRTC.screen.sourceId;\r\n            }\r\n\r\n            currentUserMediaRequest = {\r\n                streams: [],\r\n                mutex: false,\r\n                queueRequests: []\r\n            };\r\n        };\r\n\r\n        // if disabled, \"event.mediaElement\" for \"onstream\" will be NULL\r\n        connection.autoCreateMediaElement = true;\r\n\r\n        // set password\r\n        connection.password = null;\r\n\r\n        // set password\r\n        connection.setPassword = function(password, callback) {\r\n            callback = callback || function() {};\r\n            if (connection.socket) {\r\n                connection.socket.emit('set-password', password, callback);\r\n            } else {\r\n                connection.password = password;\r\n                callback(true, connection.sessionid, null);\r\n            }\r\n        };\r\n\r\n        connection.onSocketDisconnect = function(event) {\r\n            if (connection.enableLogs) {\r\n                console.warn('socket.io connection is closed');\r\n            }\r\n        };\r\n\r\n        connection.onSocketError = function(event) {\r\n            if (connection.enableLogs) {\r\n                console.warn('socket.io connection is failed');\r\n            }\r\n        };\r\n\r\n        // error messages\r\n        connection.errors = {\r\n            ROOM_NOT_AVAILABLE: 'Room not available',\r\n            INVALID_PASSWORD: 'Invalid password',\r\n            USERID_NOT_AVAILABLE: 'User ID does not exist',\r\n            ROOM_PERMISSION_DENIED: 'Room permission denied',\r\n            ROOM_FULL: 'Room full',\r\n            DID_NOT_JOIN_ANY_ROOM: 'Did not join any room yet',\r\n            INVALID_SOCKET: 'Invalid socket',\r\n            PUBLIC_IDENTIFIER_MISSING: 'publicRoomIdentifier is required',\r\n            INVALID_ADMIN_CREDENTIAL: 'Invalid username or password attempted'\r\n        };\r\n    })(this);\r\n\r\n};\r\n\r\nif (typeof module !== 'undefined' /* && !!module.exports*/ ) {\r\n    module.exports = exports = RTCMultiConnection;\r\n}\r\n\r\nif (typeof define === 'function' && define.amd) {\r\n    define('RTCMultiConnection', [], function() {\r\n        return RTCMultiConnection;\r\n    });\r\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nlet logDisabled_ = true;\nlet deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nexport function extractVersion(uastring, expr, pos) {\n  const match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nexport function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  const nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    const wrappedCallback = (e) => {\n      const modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        cb(modifiedEvent);\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    this._eventMap[cb] = wrappedCallback;\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  const nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[cb]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    const unwrappedCb = this._eventMap[cb];\n    delete this._eventMap[cb];\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\nexport function disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return (bool) ? 'adapter.js logging disabled' :\n      'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nexport function disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nexport function log() {\n  if (typeof window === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nexport function deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n      ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nexport function detectBrowser(window) {\n  const {navigator} = window;\n\n  // Returned result object.\n  const result = {browser: null, version: null};\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  if (navigator.mozGetUserMedia) { // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent,\n        /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia ||\n      (window.isSecureContext === false && window.webkitRTCPeerConnection &&\n       !window.RTCIceGatherer)) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent,\n        /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (navigator.mediaDevices &&\n      navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) { // Edge.\n    result.browser = 'edge';\n    result.version = extractVersion(navigator.userAgent,\n        /Edge\\/(\\d+).(\\d+)$/, 2);\n  } else if (window.RTCPeerConnection &&\n      navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent,\n        /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver &&\n        'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else { // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nexport function compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function(accumulator, key) {\n    const isObj = isObject(data[key]);\n    const value = isObj ? compactObject(data[key]) : data[key];\n    const isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, {[key]: value});\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nexport function walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(name => {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(id => {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nexport function filterStats(result, track, outbound) {\n  const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  const filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  const trackStats = [];\n  result.forEach(value => {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(trackStat => {\n    result.forEach(stats => {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\nconst logging = utils.log;\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  const browserDetails = utils.detectBrowser(window);\n\n  const constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    const cc = {};\n    Object.keys(c).forEach(key => {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      const r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      const oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        let oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(mix => {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  const shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      const remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      let face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      const getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        let matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n          .then(devices => {\n            devices = devices.filter(d => d.kind === 'videoinput');\n            let dev = devices.find(d => matches.some(match =>\n              d.label.toLowerCase().includes(match)));\n            if (!dev && devices.length && matches.includes('back')) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :\n                                                        {ideal: dev.deviceId};\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  const shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  const getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, c => {\n      navigator.webkitGetUserMedia(c, onSuccess, e => {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, c => origGetUserMedia(c).then(stream => {\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(track => {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, e => Promise.reject(shimError_(e))));\n    };\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nexport function shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n        'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      return getSourceId(constraints)\n        .then(sourceId => {\n          const widthSpecified = constraints.video && constraints.video.width;\n          const heightSpecified = constraints.video &&\n            constraints.video.height;\n          const frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n}\n","\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n      window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get() {\n        return this._ontrack;\n      },\n      set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    const origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = (e) => {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', te => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === te.track.id);\n              } else {\n                receiver = {track: te.track};\n              }\n\n              const event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(track => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === track.id);\n              } else {\n                receiver = {track};\n              }\n              const event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver',\n          {value: {receiver: e.receiver}});\n      }\n      return e;\n    });\n  }\n}\n\nexport function shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (typeof window === 'object' && window.RTCPeerConnection &&\n      !('getSenders' in window.RTCPeerConnection.prototype) &&\n      'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    const shimSenderWithDtmf = function(pc, track) {\n      return {\n        track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack =\n        function addTrack(track, stream) {\n          let sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack =\n        function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          const idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n    }\n    const origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(track => {\n        this._senders.push(shimSenderWithDtmf(this, track));\n      });\n    };\n\n    const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(track => {\n          const sender = this._senders.find(s => s.track === track);\n          if (sender) { // remove sender\n            this._senders.splice(this._senders.indexOf(sender), 1);\n          }\n        });\n      };\n  } else if (typeof window === 'object' && window.RTCPeerConnection &&\n             'getSenders' in window.RTCPeerConnection.prototype &&\n             'createDTMFSender' in window.RTCPeerConnection.prototype &&\n             window.RTCRtpSender &&\n             !('dtmf' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nexport function shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 ||\n        typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    const fixChromeStats_ = function(response) {\n      const standardReport = {};\n      const reports = response.result();\n      reports.forEach(report => {\n        const standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(name => {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    const makeMapStats = function(stats) {\n      return new Map(Object.keys(stats).map(key => [key, stats[key]]));\n    };\n\n    if (arguments.length >= 2) {\n      const successCallbackWrapper_ = function(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_,\n        selector]);\n    }\n\n    // promise-support\n    return new Promise((resolve, reject) => {\n      origGetStats.apply(this, [\n        function(response) {\n          resolve(makeMapStats(fixChromeStats_(response)));\n        }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        const senders = origGetSenders.apply(this, []);\n        senders.forEach(sender => sender._pc = this);\n        return senders;\n      };\n    }\n\n    const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        const sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      const sender = this;\n      return this._pc.getStats().then(result =>\n        /* Note: this will include stats of all senders that\n         *   send a track with the same id as sender.track as\n         *   it is not possible to identify the RTCRtpSender.\n         */\n        utils.filterStats(result, sender.track, true));\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers =\n        function getReceivers() {\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(receiver => receiver._pc = this);\n          return receivers;\n        };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      const receiver = this;\n      return this._pc.getStats().then(result =>\n        utils.filterStats(result, receiver.track, false));\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype &&\n      'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 &&\n        arguments[0] instanceof window.MediaStreamTrack) {\n      const track = arguments[0];\n      let sender;\n      let receiver;\n      let err;\n      this.getSenders().forEach(s => {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(r => {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || (sender && receiver)) {\n        return Promise.reject(new DOMException(\n          'There are more than one sender or receiver for the track.',\n          'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException(\n        'There is no sender or receiver for the track.',\n        'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nexport function shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams)\n        .map(streamId => this._shimmedLocalStreams[streamId][0]);\n    };\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      const sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n    });\n    const existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    const newSenders = this.getSenders()\n      .filter(newSender => existingSenders.indexOf(newSender) === -1);\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n  const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(streamId => {\n          const idx = this._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            this._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (this._shimmedLocalStreams[streamId].length === 1) {\n            delete this._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n}\n\nexport function shimAddTrackRemoveTrack(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const browserDetails = utils.detectBrowser(window);\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack &&\n      browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  const origGetLocalStreams = window.RTCPeerConnection.prototype\n      .getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      const nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(stream => this._reverseStreams[stream.id]);\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      const newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [(this._streams[stream.id] || stream)]);\n      delete this._reverseStreams[(this._streams[stream.id] ?\n          this._streams[stream.id].id : stream.id)];\n      delete this._streams[stream.id];\n    };\n\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      const streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(t => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      const oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(() => {\n          this.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        const newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(s => s.track === track);\n    };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n          externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n          internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function(method) {\n    const nativeMethod = window.RTCPeerConnection.prototype[method];\n    const methodObj = {[method]() {\n      const args = arguments;\n      const isLegacyCall = arguments.length &&\n          typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [\n          (description) => {\n            const desc = replaceInternalStreamId(this, description);\n            args[0].apply(null, [desc]);\n          },\n          (err) => {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]\n        ]);\n      }\n      return nativeMethod.apply(this, arguments)\n      .then(description => replaceInternalStreamId(this, description));\n    }};\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  const origSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  const origLocalDescription = Object.getOwnPropertyDescriptor(\n      window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype,\n      'localDescription', {\n        get() {\n          const description = origLocalDescription.get.apply(this);\n          if (description.type === '') {\n            return description;\n          }\n          return replaceInternalStreamId(this, description);\n        }\n      });\n\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      const isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n            'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      let stream;\n      Object.keys(this._streams).forEach(streamid => {\n        const hasTrack = this._streams[streamid].getTracks()\n          .find(track => sender.track === track);\n        if (hasTrack) {\n          stream = this._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n}\n\nexport function shimPeerConnection(window) {\n  const browserDetails = utils.detectBrowser(window);\n\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  const addIceCandidateNullSupported =\n    window.RTCPeerConnection.prototype.addIceCandidate.length === 0;\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = {[method]() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          }};\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n  }\n\n  // support for addIceCandidate(null or undefined)\n  const nativeAddIceCandidate =\n      window.RTCPeerConnection.prototype.addIceCandidate;\n  window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!addIceCandidateNullSupported && !arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions. Native support planned for Chrome M77.\n      if (browserDetails.version < 78 &&\n        arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n}\n\nexport function fixNegotiationNeeded(window) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', e => {\n    const pc = e.target;\n    if (pc.signalingState !== 'stable') {\n      return;\n    }\n    return e;\n  });\n}\n","/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nexport function filterIceServers(iceServers, edgeVersion) {\n  let hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(server => {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      const isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(url => {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        const validTurn = url.startsWith('turn') &&\n            !url.startsWith('turn:[') &&\n            url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  const shimError_ = function(e) {\n    return {\n      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function(c) {\n    return origGetUserMedia(c).catch(e => Promise.reject(shimError_(e)));\n  };\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window) {\n  if (!('getDisplayMedia' in window.navigator)) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    window.navigator.getDisplayMedia.bind(window.navigator);\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nimport {filterIceServers} from './filtericeservers';\nimport shimRTCPeerConnection from 'rtcpeerconnection-shim';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimPeerConnection(window) {\n  const browserDetails = utils.detectBrowser(window);\n\n  if (window.RTCIceGatherer) {\n    if (!window.RTCIceCandidate) {\n      window.RTCIceCandidate = function RTCIceCandidate(args) {\n        return args;\n      };\n    }\n    if (!window.RTCSessionDescription) {\n      window.RTCSessionDescription = function RTCSessionDescription(args) {\n        return args;\n      };\n    }\n    // this adds an additional event listener to MediaStrackTrack that signals\n    // when a tracks enabled property was changed. Workaround for a bug in\n    // addStream, see below. No longer required in 15025+\n    if (browserDetails.version < 15025) {\n      const origMSTEnabled = Object.getOwnPropertyDescriptor(\n          window.MediaStreamTrack.prototype, 'enabled');\n      Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\n        set(value) {\n          origMSTEnabled.set.call(this, value);\n          const ev = new Event('enabled');\n          ev.enabled = value;\n          this.dispatchEvent(ev);\n        }\n      });\n    }\n  }\n\n  // ORTC defines the DTMF sender a bit different.\n  // https://github.com/w3c/ortc/issues/714\n  if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = new window.RTCDtmfSender(this);\n          } else if (this.track.kind === 'video') {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n  // Edge currently only implements the RTCDtmfSender, not the\n  // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*\n  if (window.RTCDtmfSender && !window.RTCDTMFSender) {\n    window.RTCDTMFSender = window.RTCDtmfSender;\n  }\n\n  const RTCPeerConnectionShim = shimRTCPeerConnection(window,\n      browserDetails.version);\n  window.RTCPeerConnection = function RTCPeerConnection(config) {\n    if (config && config.iceServers) {\n      config.iceServers = filterIceServers(config.iceServers,\n        browserDetails.version);\n      utils.log('ICE servers after filtering:', config.iceServers);\n    }\n    return new RTCPeerConnectionShim(config);\n  };\n  window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;\n}\n\nexport function shimReplaceTrack(window) {\n  // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n  if (window.RTCRtpSender &&\n      !('replaceTrack' in window.RTCRtpSender.prototype)) {\n    window.RTCRtpSender.prototype.replaceTrack =\n        window.RTCRtpSender.prototype.setTrack;\n  }\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n\nexport function shimGetUserMedia(window) {\n  const browserDetails = utils.detectBrowser(window);\n  const navigator = window && window.navigator;\n  const MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n        'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    const remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        const obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      const nativeApplyConstraints =\n        MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        const err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      ('receiver' in window.RTCTrackEvent.prototype) &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimPeerConnection(window) {\n  const browserDetails = utils.detectBrowser(window);\n\n  if (typeof window !== 'object' ||\n      !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = {[method]() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          }};\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n  }\n\n  // support for addIceCandidate(null or undefined)\n  // as well as ignoring {sdpMid, candidate: \"\"}\n  if (browserDetails.version < 68) {\n    const nativeAddIceCandidate =\n        window.RTCPeerConnection.prototype.addIceCandidate;\n    window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      if (arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n  }\n\n  const modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n    return nativeGetStats.apply(this, [selector || null])\n      .then(stats => {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(stat => {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach((stat, i) => {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      })\n      .then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n  }\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      const sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) :\n        Promise.resolve(new Map());\n  };\n}\n\nexport function shimReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      const receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(receiver => receiver._pc = this);\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', e => {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nexport function shimRemoveStream(window) {\n  if (!window.RTCPeerConnection ||\n      'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(sender => {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          this.removeTrack(sender);\n        }\n      });\n    };\n}\n\nexport function shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nexport function shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver =\n      function addTransceiver() {\n        this.setParametersPromises = [];\n        const initParameters = arguments[1];\n        const shouldPerformCheck = initParameters &&\n                                  'sendEncodings' in initParameters;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          initParameters.sendEncodings.forEach((encodingParam) => {\n            if ('rid' in encodingParam) {\n              const ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        const transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          const {sender} = transceiver;\n          const params = sender.getParameters();\n          if (!('encodings' in params)) {\n            params.encodings = initParameters.sendEncodings;\n            this.setParametersPromises.push(\n              sender.setParameters(params)\n              .catch(() => {})\n            );\n          }\n        }\n        return transceiver;\n      };\n  }\n}\n\nexport function shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n      .then(() => {\n        return origCreateOffer.apply(this, arguments);\n      })\n      .finally(() => {\n        this.setParametersPromises = [];\n      });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nexport function shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n      .then(() => {\n        return origCreateAnswer.apply(this, arguments);\n      })\n      .finally(() => {\n        this.setParametersPromises = [];\n      });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nimport * as utils from '../utils';\n\nexport function shimLocalStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams =\n      function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n      stream.getVideoTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n    };\n\n    window.RTCPeerConnection.prototype.addTrack =\n      function addTrack(track) {\n        const stream = arguments[1];\n        if (stream) {\n          if (!this._localStreams) {\n            this._localStreams = [stream];\n          } else if (!this._localStreams.includes(stream)) {\n            this._localStreams.push(stream);\n          }\n        }\n        return _addTrack.apply(this, arguments);\n      };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        const index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        const tracks = stream.getTracks();\n        this.getSenders().forEach(sender => {\n          if (tracks.includes(sender.track)) {\n            this.removeTrack(sender);\n          }\n        });\n      };\n  }\n}\n\nexport function shimRemoteStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams =\n      function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get() {\n        return this._onaddstream;\n      },\n      set(f) {\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = (e) => {\n          e.streams.forEach(stream => {\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.includes(stream)) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            const event = new Event('addstream');\n            event.stream = stream;\n            this.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        const pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(stream => {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n  }\n}\n\nexport function shimCallbacksAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  const prototype = window.RTCPeerConnection.prototype;\n  const origCreateOffer = prototype.createOffer;\n  const origCreateAnswer = prototype.createAnswer;\n  const setLocalDescription = prototype.setLocalDescription;\n  const setRemoteDescription = prototype.setRemoteDescription;\n  const addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer =\n    function createOffer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  prototype.createAnswer =\n    function createAnswer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  let withCallback = function(description, successCallback, failureCallback) {\n    const promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function(description, successCallback, failureCallback) {\n    const promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function(candidate, successCallback, failureCallback) {\n    const promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    const mediaDevices = navigator.mediaDevices;\n    const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = (constraints) => {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices &&\n    navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints)\n      .then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nexport function shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({},\n      constraints,\n      {video: utils.compactObject(constraints.video)}\n    );\n  }\n\n  return constraints;\n}\n\nexport function shimRTCIceServerUrls(window) {\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  const OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection =\n    function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        const newIceServers = [];\n        for (let i = 0; i < pcConfig.iceServers.length; i++) {\n          let server = pcConfig.iceServers[i];\n          if (!server.hasOwnProperty('urls') &&\n              server.hasOwnProperty('url')) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in window.RTCPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nexport function shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      'receiver' in window.RTCTrackEvent.prototype &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimCreateOfferLegacy(window) {\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer =\n    function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio =\n            !!offerOptions.offerToReceiveAudio;\n        }\n        const audioTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'audio');\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          this.addTransceiver('audio');\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo =\n            !!offerOptions.offerToReceiveVideo;\n        }\n        const videoTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'video');\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          this.addTransceiver('video');\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n}\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport SDPUtils from 'sdp';\nimport * as utils from './utils';\n\nexport function shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  const NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (typeof args === 'object' && args.candidate &&\n        args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substr(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      const nativeCandidate = new NativeRTCIceCandidate(args);\n      const parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      const augmentedCandidate = Object.assign(nativeCandidate,\n          parsedCandidate);\n\n      // Add a serializer that does not serialize the extra attributes.\n      augmentedCandidate.toJSON = function toJSON() {\n        return {\n          candidate: augmentedCandidate.candidate,\n          sdpMid: augmentedCandidate.sdpMid,\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n          usernameFragment: augmentedCandidate.usernameFragment,\n        };\n      };\n      return augmentedCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nexport function shimMaxMessageSize(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const browserDetails = utils.detectBrowser(window);\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  const sctpInDescription = function(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    const sections = SDPUtils.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(mediaSection => {\n      const mLine = SDPUtils.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application'\n          && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  const getRemoteFirefoxVersion = function(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    const version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  const getCanSendMaxMessageSize = function(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    let canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize =\n          browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  const getMaxMessageSize = function(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    let maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox'\n         && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    const match = SDPUtils.matchPrefix(description.sdp,\n      'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substr(19), 10);\n    } else if (browserDetails.browser === 'firefox' &&\n                remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n    function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        const {sdpSemantics} = this.getConfiguration();\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n            enumerable: true,\n            configurable: true,\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        let maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        const sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n}\n\nexport function shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection &&\n      'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    const origDataChannelSend = dc.send;\n    dc.send = function send() {\n      const data = arguments[0];\n      const length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' &&\n          pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' +\n          pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  const origCreateDataChannel =\n    window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel =\n    function createDataChannel() {\n      const dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', e => {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nexport function shimConnectionState(window) {\n  if (!window.RTCPeerConnection ||\n      'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get() {\n      return this._onconnectionstatechange || null;\n    },\n    set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange',\n            this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange',\n            this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n    const origMethod = proto[method];\n    proto[method] = function() {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = e => {\n          const pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            const newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange',\n          this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nexport function removeAllowExtmapMixed(window) {\n  /* remove a=extmap-allow-mixed for Chrome < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const browserDetails = utils.detectBrowser(window);\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n  function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      desc.sdp = desc.sdp.split('\\n').filter((line) => {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nimport * as utils from './utils';\n\n  // Browser shims.\nimport * as chromeShim from './chrome/chrome_shim';\nimport * as edgeShim from './edge/edge_shim';\nimport * as firefoxShim from './firefox/firefox_shim';\nimport * as safariShim from './safari/safari_shim';\nimport * as commonShim from './common_shim';\n\n// Shimming starts here.\nexport function adapterFactory({window} = {}, options = {\n  shimChrome: true,\n  shimFirefox: true,\n  shimEdge: true,\n  shimSafari: true,\n}) {\n  // Utils.\n  const logging = utils.log;\n  const browserDetails = utils.detectBrowser(window);\n\n  const adapter = {\n    browserDetails,\n    commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      chromeShim.shimGetUserMedia(window);\n      chromeShim.shimMediaStream(window);\n      chromeShim.shimPeerConnection(window);\n      chromeShim.shimOnTrack(window);\n      chromeShim.shimAddTrackRemoveTrack(window);\n      chromeShim.shimGetSendersWithDtmf(window);\n      chromeShim.shimGetStats(window);\n      chromeShim.shimSenderReceiverGetStats(window);\n      chromeShim.fixNegotiationNeeded(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimConnectionState(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      commonShim.removeAllowExtmapMixed(window);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      firefoxShim.shimGetUserMedia(window);\n      firefoxShim.shimPeerConnection(window);\n      firefoxShim.shimOnTrack(window);\n      firefoxShim.shimRemoveStream(window);\n      firefoxShim.shimSenderGetStats(window);\n      firefoxShim.shimReceiverGetStats(window);\n      firefoxShim.shimRTCDataChannel(window);\n      firefoxShim.shimAddTransceiver(window);\n      firefoxShim.shimCreateOffer(window);\n      firefoxShim.shimCreateAnswer(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimConnectionState(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n        logging('MS edge shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = edgeShim;\n\n      edgeShim.shimGetUserMedia(window);\n      edgeShim.shimGetDisplayMedia(window);\n      edgeShim.shimPeerConnection(window);\n      edgeShim.shimReplaceTrack(window);\n\n      // the edge shim implements the full RTCIceCandidate object.\n\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      safariShim.shimRTCIceServerUrls(window);\n      safariShim.shimCreateOfferLegacy(window);\n      safariShim.shimCallbacksAPI(window);\n      safariShim.shimLocalStreamsAPI(window);\n      safariShim.shimRemoteStreamsAPI(window);\n      safariShim.shimTrackEventTransceiver(window);\n      safariShim.shimGetUserMedia(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      commonShim.removeAllowExtmapMixed(window);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nimport {adapterFactory} from './adapter_factory.js';\n\nconst adapter = adapterFactory({window});\nexport default adapter;\n","// .dirname, .basename, and .extname methods are extracted from Node.js v8.11.1,\n// backported and transplited with Babel, with backwards-compat fixes\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  if (path.length === 0) return '.';\n  var code = path.charCodeAt(0);\n  var hasRoot = code === 47 /*/*/;\n  var end = -1;\n  var matchedSlash = true;\n  for (var i = path.length - 1; i >= 1; --i) {\n    code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n      // We saw the first non-path separator\n      matchedSlash = false;\n    }\n  }\n\n  if (end === -1) return hasRoot ? '/' : '.';\n  if (hasRoot && end === 1) {\n    // return '//';\n    // Backwards-compat fix:\n    return '/';\n  }\n  return path.slice(0, end);\n};\n\nfunction basename(path) {\n  if (typeof path !== 'string') path = path + '';\n\n  var start = 0;\n  var end = -1;\n  var matchedSlash = true;\n  var i;\n\n  for (i = path.length - 1; i >= 0; --i) {\n    if (path.charCodeAt(i) === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // path component\n      matchedSlash = false;\n      end = i + 1;\n    }\n  }\n\n  if (end === -1) return '';\n  return path.slice(start, end);\n}\n\n// Uses a mixed approach for backwards-compatibility, as ext behavior changed\n// in new Node.js versions, so only basename() above is backported here\nexports.basename = function (path, ext) {\n  var f = basename(path);\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\nexports.extname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  var startDot = -1;\n  var startPart = 0;\n  var end = -1;\n  var matchedSlash = true;\n  // Track the state of characters (if any) we see before our first dot and\n  // after any path separator we find\n  var preDotState = 0;\n  for (var i = path.length - 1; i >= 0; --i) {\n    var code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n    if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // extension\n      matchedSlash = false;\n      end = i + 1;\n    }\n    if (code === 46 /*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n    } else if (startDot !== -1) {\n      // We saw a non-dot and non-path separator before our dot, so we should\n      // have a good chance at having a non-empty extension\n      preDotState = -1;\n    }\n  }\n\n  if (startDot === -1 || end === -1 ||\n      // We saw a non-dot character immediately before the dot\n      preDotState === 0 ||\n      // The (right-most) trimmed path component is exactly '..'\n      preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n    return '';\n  }\n  return path.slice(startDot, end);\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","// IceServersHandler.js\n\nexport const IceServersHandler = (function() {\n  function getIceServers() {\n    let iceServers = [\n      {\n        url: 'stun:global.stun.twilio.com:3478?transport=udp',\n        urls: 'stun:global.stun.twilio.com:3478?transport=udp',\n      },\n      {\n        url: 'turn:global.turn.twilio.com:3478?transport=udp',\n        username:\n          '635df392f184a3c38b1e1f275ec5c1004d9b8fa5aa32f81a45c904e830535070',\n        urls: 'turn:global.turn.twilio.com:3478?transport=udp',\n        credential: 'M4Ax2yC8TNlrKTmWrm2pFO08WGmDCKGy5HkAyv22seQ=',\n      },\n      {\n        url: 'turn:global.turn.twilio.com:3478?transport=tcp',\n        username:\n          '635df392f184a3c38b1e1f275ec5c1004d9b8fa5aa32f81a45c904e830535070',\n        urls: 'turn:global.turn.twilio.com:3478?transport=tcp',\n        credential: 'M4Ax2yC8TNlrKTmWrm2pFO08WGmDCKGy5HkAyv22seQ=',\n      },\n      {\n        url: 'turn:global.turn.twilio.com:443?transport=tcp',\n        username:\n          '635df392f184a3c38b1e1f275ec5c1004d9b8fa5aa32f81a45c904e830535070',\n        urls: 'turn:global.turn.twilio.com:443?transport=tcp',\n        credential: 'M4Ax2yC8TNlrKTmWrm2pFO08WGmDCKGy5HkAyv22seQ=',\n      },\n    ];\n    return iceServers;\n  }\n\n  return {\n    getIceServers: getIceServers,\n  };\n})();\n","var classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.github.io/ecma262/#sec-isarray\nmodule.exports = Array.isArray || function isArray(arg) {\n  return classof(arg) == 'Array';\n};\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\n\nfunction fixStatsType(stat) {\n  return {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  }[stat.type] || stat.type;\n}\n\nfunction writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : dtlsRole || 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    var trackId = transceiver.rtpSender._initialTrackId ||\n        transceiver.rtpSender.track.id;\n    transceiver.rtpSender._initialTrackId = trackId;\n    // spec.\n    var msid = 'msid:' + (stream ? stream.id : '-') + ' ' +\n        trackId + '\\r\\n';\n    sdp += 'a=' + msid;\n    // for Chrome. Legacy should no longer be required.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n\n    // RTX\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n}\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n            url.indexOf('?transport=udp') === -1;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nfunction maybeAddCandidate(iceTransport, candidate) {\n  // Edge's internal representation adds some fields therefore\n  // not all field are taken into account.\n  var alreadyAdded = iceTransport.getRemoteCandidates()\n      .find(function(remoteCandidate) {\n        return candidate.foundation === remoteCandidate.foundation &&\n            candidate.ip === remoteCandidate.ip &&\n            candidate.port === remoteCandidate.port &&\n            candidate.priority === remoteCandidate.priority &&\n            candidate.protocol === remoteCandidate.protocol &&\n            candidate.type === remoteCandidate.type;\n      });\n  if (!alreadyAdded) {\n    iceTransport.addRemoteCandidate(candidate);\n  }\n  return !alreadyAdded;\n}\n\n\nfunction makeError(name, description) {\n  var e = new Error(description);\n  e.name = name;\n  // legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names\n  e.code = {\n    NotSupportedError: 9,\n    InvalidStateError: 11,\n    InvalidAccessError: 15,\n    TypeError: undefined,\n    OperationError: undefined\n  }[name];\n  return e;\n}\n\nmodule.exports = function(window, edgeVersion) {\n  // https://w3c.github.io/mediacapture-main/#mediastream\n  // Helper function to add the track to the stream and\n  // dispatch the event ourselves.\n  function addTrackToStreamAndFireEvent(track, stream) {\n    stream.addTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',\n        {track: track}));\n  }\n\n  function removeTrackFromStreamAndFireEvent(track, stream) {\n    stream.removeTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',\n        {track: track}));\n  }\n\n  function fireAddTrack(pc, track, receiver, streams) {\n    var trackEvent = new Event('track');\n    trackEvent.track = track;\n    trackEvent.receiver = receiver;\n    trackEvent.transceiver = {receiver: receiver};\n    trackEvent.streams = streams;\n    window.setTimeout(function() {\n      pc._dispatchEvent('track', trackEvent);\n    });\n  }\n\n  var RTCPeerConnection = function(config) {\n    var pc = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          pc[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.canTrickleIceCandidates = null;\n\n    this.needNegotiation = false;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n\n    this._localDescription = null;\n    this._remoteDescription = null;\n\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.connectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    config = JSON.parse(JSON.stringify(config || {}));\n\n    this.usingBundle = config.bundlePolicy === 'max-bundle';\n    if (config.rtcpMuxPolicy === 'negotiate') {\n      throw(makeError('NotSupportedError',\n          'rtcpMuxPolicy \\'negotiate\\' is not supported'));\n    } else if (!config.rtcpMuxPolicy) {\n      config.rtcpMuxPolicy = 'require';\n    }\n\n    switch (config.iceTransportPolicy) {\n      case 'all':\n      case 'relay':\n        break;\n      default:\n        config.iceTransportPolicy = 'all';\n        break;\n    }\n\n    switch (config.bundlePolicy) {\n      case 'balanced':\n      case 'max-compat':\n      case 'max-bundle':\n        break;\n      default:\n        config.bundlePolicy = 'balanced';\n        break;\n    }\n\n    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\n\n    this._iceGatherers = [];\n    if (config.iceCandidatePoolSize) {\n      for (var i = config.iceCandidatePoolSize; i > 0; i--) {\n        this._iceGatherers.push(new window.RTCIceGatherer({\n          iceServers: config.iceServers,\n          gatherPolicy: config.iceTransportPolicy\n        }));\n      }\n    } else {\n      config.iceCandidatePoolSize = 0;\n    }\n\n    this._config = config;\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    this._sdpSessionId = SDPUtils.generateSessionId();\n    this._sdpSessionVersion = 0;\n\n    this._dtlsRole = undefined; // role for a=setup to use in answers.\n\n    this._isClosed = false;\n  };\n\n  Object.defineProperty(RTCPeerConnection.prototype, 'localDescription', {\n    configurable: true,\n    get: function() {\n      return this._localDescription;\n    }\n  });\n  Object.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {\n    configurable: true,\n    get: function() {\n      return this._remoteDescription;\n    }\n  });\n\n  // set up event handlers on prototype\n  RTCPeerConnection.prototype.onicecandidate = null;\n  RTCPeerConnection.prototype.onaddstream = null;\n  RTCPeerConnection.prototype.ontrack = null;\n  RTCPeerConnection.prototype.onremovestream = null;\n  RTCPeerConnection.prototype.onsignalingstatechange = null;\n  RTCPeerConnection.prototype.oniceconnectionstatechange = null;\n  RTCPeerConnection.prototype.onconnectionstatechange = null;\n  RTCPeerConnection.prototype.onicegatheringstatechange = null;\n  RTCPeerConnection.prototype.onnegotiationneeded = null;\n  RTCPeerConnection.prototype.ondatachannel = null;\n\n  RTCPeerConnection.prototype._dispatchEvent = function(name, event) {\n    if (this._isClosed) {\n      return;\n    }\n    this.dispatchEvent(event);\n    if (typeof this['on' + name] === 'function') {\n      this['on' + name](event);\n    }\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this._dispatchEvent('icegatheringstatechange', event);\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  RTCPeerConnection.prototype.getLocalStreams = function() {\n    return this.localStreams;\n  };\n\n  RTCPeerConnection.prototype.getRemoteStreams = function() {\n    return this.remoteStreams;\n  };\n\n  // internal helper to create a transceiver object.\n  // (which is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind, doNotAdd) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      associatedRemoteMediaStreams: [],\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    if (!doNotAdd) {\n      this.transceivers.push(transceiver);\n    }\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call addTrack on a closed peerconnection.');\n    }\n\n    var alreadyExists = this.transceivers.find(function(s) {\n      return s.track === track;\n    });\n\n    if (alreadyExists) {\n      throw makeError('InvalidAccessError', 'Track already exists.');\n    }\n\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    this._maybeFireNegotiationNeeded();\n\n    if (this.localStreams.indexOf(stream) === -1) {\n      this.localStreams.push(stream);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new window.RTCRtpSender(track,\n        transceiver.dtlsTransport);\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var pc = this;\n    if (edgeVersion >= 15025) {\n      stream.getTracks().forEach(function(track) {\n        pc.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        pc.addTrack(track, clonedStream);\n      });\n    }\n  };\n\n  RTCPeerConnection.prototype.removeTrack = function(sender) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call removeTrack on a closed peerconnection.');\n    }\n\n    if (!(sender instanceof window.RTCRtpSender)) {\n      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\n          'does not implement interface RTCRtpSender.');\n    }\n\n    var transceiver = this.transceivers.find(function(t) {\n      return t.rtpSender === sender;\n    });\n\n    if (!transceiver) {\n      throw makeError('InvalidAccessError',\n          'Sender was not created by this connection.');\n    }\n    var stream = transceiver.stream;\n\n    transceiver.rtpSender.stop();\n    transceiver.rtpSender = null;\n    transceiver.track = null;\n    transceiver.stream = null;\n\n    // remove the stream from the set of local streams\n    var localStreams = this.transceivers.map(function(t) {\n      return t.stream;\n    });\n    if (localStreams.indexOf(stream) === -1 &&\n        this.localStreams.indexOf(stream) > -1) {\n      this.localStreams.splice(this.localStreams.indexOf(stream), 1);\n    }\n\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var pc = this;\n    stream.getTracks().forEach(function(track) {\n      var sender = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (sender) {\n        pc.removeTrack(sender);\n      }\n    });\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n\n  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,\n      usingBundle) {\n    var pc = this;\n    if (usingBundle && sdpMLineIndex > 0) {\n      return this.transceivers[0].iceGatherer;\n    } else if (this._iceGatherers.length) {\n      return this._iceGatherers.shift();\n    }\n    var iceGatherer = new window.RTCIceGatherer({\n      iceServers: this._config.iceServers,\n      gatherPolicy: this._config.iceTransportPolicy\n    });\n    Object.defineProperty(iceGatherer, 'state',\n        {value: 'new', writable: true}\n    );\n\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];\n    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      // polyfill since RTCIceGatherer.state is not implemented in\n      // Edge 10547 yet.\n      iceGatherer.state = end ? 'completed' : 'gathering';\n      if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {\n        pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);\n      }\n    };\n    iceGatherer.addEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    return iceGatherer;\n  };\n\n  // start gathering from an RTCIceGatherer.\n  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {\n    var pc = this;\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer.onlocalcandidate) {\n      return;\n    }\n    var bufferedCandidateEvents =\n      this.transceivers[sdpMLineIndex].bufferedCandidateEvents;\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;\n    iceGatherer.removeEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    iceGatherer.onlocalcandidate = function(evt) {\n      if (pc.usingBundle && sdpMLineIndex > 0) {\n        // if we know that we use bundle we can drop candidates with\n        // dpMLineIndex > 0. If we don't do this then our state gets\n        // confused since we dispose the extra ice gatherer.\n        return;\n      }\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      // Edge emits an empty object for RTCIceCandidateComplete\n      var end = !cand || Object.keys(cand).length === 0;\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        if (iceGatherer.state === 'new') {\n          iceGatherer.state = 'gathering';\n        }\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        // also the usernameFragment. TODO: update SDP to take both variants.\n        cand.ufrag = iceGatherer.getLocalParameters().usernameFragment;\n\n        var serializedCandidate = SDPUtils.writeCandidate(cand);\n        event.candidate = Object.assign(event.candidate,\n            SDPUtils.parseCandidate(serializedCandidate));\n\n        event.candidate.candidate = serializedCandidate;\n        event.candidate.toJSON = function() {\n          return {\n            candidate: event.candidate.candidate,\n            sdpMid: event.candidate.sdpMid,\n            sdpMLineIndex: event.candidate.sdpMLineIndex,\n            usernameFragment: event.candidate.usernameFragment\n          };\n        };\n      }\n\n      // update local description.\n      var sections = SDPUtils.getMediaSections(pc._localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      pc._localDescription.sdp =\n          SDPUtils.getDescription(pc._localDescription.sdp) +\n          sections.join('');\n      var complete = pc.transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      if (pc.iceGatheringState !== 'gathering') {\n        pc.iceGatheringState = 'gathering';\n        pc._emitGatheringStateChange();\n      }\n\n      // Emit candidate. Also emit null candidate when all gatherers are\n      // complete.\n      if (!end) {\n        pc._dispatchEvent('icecandidate', event);\n      }\n      if (complete) {\n        pc._dispatchEvent('icecandidate', new Event('icecandidate'));\n        pc.iceGatheringState = 'complete';\n        pc._emitGatheringStateChange();\n      }\n    };\n\n    // emit already gathered candidates.\n    window.setTimeout(function() {\n      bufferedCandidateEvents.forEach(function(e) {\n        iceGatherer.onlocalcandidate(e);\n      });\n    }, 0);\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var pc = this;\n    var iceTransport = new window.RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      pc._updateIceConnectionState();\n      pc._updateConnectionState();\n    };\n\n    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      pc._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      pc._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlsstatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      if (transceiver.recvEncodingParameters.length) {\n        params.encodings = transceiver.recvEncodingParameters;\n      } else {\n        params.encodings = [{}];\n      }\n      params.rtcp = {\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.rtcpParameters.cname) {\n        params.rtcp.cname = transceiver.rtcpParameters.cname;\n      }\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set local ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // VERY limited support for SDP munging. Limited to:\n      // * changing the order of codecs\n      sections = SDPUtils.splitSections(description.sdp);\n      sessionpart = sections.shift();\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var caps = SDPUtils.parseRtpParameters(mediaSection);\n        pc.transceivers[sdpMLineIndex].localCapabilities = caps;\n      });\n\n      pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n        pc._gather(transceiver.mid, sdpMLineIndex);\n      });\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(pc._remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        // treat bundle-only as not-rejected.\n        var rejected = SDPUtils.isRejected(mediaSection) &&\n            SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n\n        if (!rejected && !transceiver.rejected) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!pc.usingBundle || sdpMLineIndex === 0) {\n            pc._gather(transceiver.mid, sdpMLineIndex);\n            if (iceTransport.state === 'new') {\n              iceTransport.start(iceGatherer, remoteIceParameters,\n                  isIceLite ? 'controlling' : 'controlled');\n            }\n            if (dtlsTransport.state === 'new') {\n              dtlsTransport.start(remoteDtlsParameters);\n            }\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          pc._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    pc._localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-local-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set remote ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var streams = {};\n    pc.remoteStreams.forEach(function(stream) {\n      streams[stream.id] = stream;\n    });\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    pc.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      pc.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      // treat bundle-only as not-rejected.\n      var rejected = SDPUtils.isRejected(mediaSection) &&\n          SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||\n          protocol === 'UDP/DTLS/SCTP'))) {\n        // TODO: this is dangerous in the case where a non-rejected m-line\n        //     becomes rejected.\n        pc.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          kind: kind,\n          protocol: protocol,\n          rejected: true\n        };\n        return;\n      }\n\n      if (!rejected && pc.transceivers[sdpMLineIndex] &&\n          pc.transceivers[sdpMLineIndex].rejected) {\n        // recycle a rejected transceiver.\n        pc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === 1;\n          });\n\n      // Check if we can use BUNDLE and dispose transports.\n      if ((description.type === 'offer' || description.type === 'answer') &&\n          !rejected && usingBundle && sdpMLineIndex > 0 &&\n          pc.transceivers[sdpMLineIndex]) {\n        pc._disposeIceAndDtlsTransports(sdpMLineIndex);\n        pc.transceivers[sdpMLineIndex].iceGatherer =\n            pc.transceivers[0].iceGatherer;\n        pc.transceivers[sdpMLineIndex].iceTransport =\n            pc.transceivers[0].iceTransport;\n        pc.transceivers[sdpMLineIndex].dtlsTransport =\n            pc.transceivers[0].dtlsTransport;\n        if (pc.transceivers[sdpMLineIndex].rtpSender) {\n          pc.transceivers[sdpMLineIndex].rtpSender.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n        if (pc.transceivers[sdpMLineIndex].rtpReceiver) {\n          pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n      }\n      if (description.type === 'offer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex] ||\n            pc._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n              usingBundle);\n        }\n\n        if (cands.length && transceiver.iceTransport.state === 'new') {\n          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n            transceiver.iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = transceiver.sendEncodingParameters || [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        var isNewTrack = false;\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          isNewTrack = !transceiver.rtpReceiver;\n          rtpReceiver = transceiver.rtpReceiver ||\n              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\n\n          if (isNewTrack) {\n            var stream;\n            track = rtpReceiver.track;\n            // FIXME: does not work with Plan B.\n            if (remoteMsid && remoteMsid.stream === '-') {\n              // no-op. a stream id of '-' means: no associated stream.\n            } else if (remoteMsid) {\n              if (!streams[remoteMsid.stream]) {\n                streams[remoteMsid.stream] = new window.MediaStream();\n                Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                  get: function() {\n                    return remoteMsid.stream;\n                  }\n                });\n              }\n              Object.defineProperty(track, 'id', {\n                get: function() {\n                  return remoteMsid.track;\n                }\n              });\n              stream = streams[remoteMsid.stream];\n            } else {\n              if (!streams.default) {\n                streams.default = new window.MediaStream();\n              }\n              stream = streams.default;\n            }\n            if (stream) {\n              addTrackToStreamAndFireEvent(track, stream);\n              transceiver.associatedRemoteMediaStreams.push(stream);\n            }\n            receiverList.push([track, rtpReceiver, stream]);\n          }\n        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\n          transceiver.associatedRemoteMediaStreams.forEach(function(s) {\n            var nativeTrack = s.getTracks().find(function(t) {\n              return t.id === transceiver.rtpReceiver.track.id;\n            });\n            if (nativeTrack) {\n              removeTrackFromStreamAndFireEvent(nativeTrack, s);\n            }\n          });\n          transceiver.associatedRemoteMediaStreams = [];\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        pc._transceive(pc.transceivers[sdpMLineIndex],\n            false,\n            isNewTrack);\n      } else if (description.type === 'answer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        pc.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        pc.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if (cands.length && iceTransport.state === 'new') {\n          if ((isIceLite || isComplete) &&\n              (!usingBundle || sdpMLineIndex === 0)) {\n            iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        if (!usingBundle || sdpMLineIndex === 0) {\n          if (iceTransport.state === 'new') {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                'controlling');\n          }\n          if (dtlsTransport.state === 'new') {\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n        }\n\n        // If the offer contained RTX but the answer did not,\n        // remove RTX from sendEncodingParameters.\n        var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n        var hasRtx = commonCapabilities.codecs.filter(function(c) {\n          return c.name.toLowerCase() === 'rtx';\n        }).length;\n        if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n          delete transceiver.sendEncodingParameters[0].rtx;\n        }\n\n        pc._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams.default);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    if (pc._dtlsRole === undefined) {\n      pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\n    }\n\n    pc._remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-remote-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        if (pc.remoteStreams.indexOf(stream) === -1) {\n          pc.remoteStreams.push(stream);\n          var event = new Event('addstream');\n          event.stream = stream;\n          window.setTimeout(function() {\n            pc._dispatchEvent('addstream', event);\n          });\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          fireAddTrack(pc, track, receiver, [stream]);\n        });\n      }\n    });\n    receiverList.forEach(function(item) {\n      if (item[2]) {\n        return;\n      }\n      fireAddTrack(pc, item[0], item[1], []);\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(pc && pc.transceivers)) {\n        return;\n      }\n      pc.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._isClosed = true;\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this._dispatchEvent('signalingstatechange', event);\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var pc = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (pc.needNegotiation) {\n        pc.needNegotiation = false;\n        var event = new Event('negotiationneeded');\n        pc._dispatchEvent('negotiationneeded', event);\n      }\n    }, 0);\n  };\n\n  // Update the ice connection state.\n  RTCPeerConnection.prototype._updateIceConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n      }\n    });\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.checking > 0) {\n      newState = 'checking';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    } else if (states.completed > 0) {\n      newState = 'completed';\n    }\n\n    if (newState !== this.iceConnectionState) {\n      this.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this._dispatchEvent('iceconnectionstatechange', event);\n    }\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && transceiver.dtlsTransport &&\n          !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n        states[transceiver.dtlsTransport.state]++;\n      }\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== this.connectionState) {\n      this.connectionState = newState;\n      var event = new Event('connectionstatechange');\n      this._dispatchEvent('connectionstatechange', event);\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createOffer after close'));\n    }\n\n    var numAudioTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    var offerOptions = arguments[0];\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    pc.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        pc._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        pc._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = transceiver.mid || SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n            pc.usingBundle);\n      }\n\n      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n\n        // for subsequent offers, we might have to re-use the payload\n        // type of the last offer.\n        if (transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.codecs) {\n          transceiver.remoteCapabilities.codecs.forEach(function(remoteCodec) {\n            if (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&\n                codec.clockRate === remoteCodec.clockRate) {\n              codec.preferredPayloadType = remoteCodec.payloadType;\n            }\n          });\n        }\n      });\n      localCapabilities.headerExtensions.forEach(function(hdrExt) {\n        var remoteExtensions = transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.headerExtensions || [];\n        remoteExtensions.forEach(function(rHdrExt) {\n          if (hdrExt.uri === rHdrExt.uri) {\n            hdrExt.id = rHdrExt.id;\n          }\n        });\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = transceiver.sendEncodingParameters || [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video' &&\n            !sendEncodingParameters[0].rtx) {\n          sendEncodingParameters[0].rtx = {\n            ssrc: sendEncodingParameters[0].ssrc + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new window.RTCRtpReceiver(\n            transceiver.dtlsTransport, kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (pc._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,\n          'offer', transceiver.stream, pc._dtlsRole);\n      sdp += 'a=rtcp-rsize\\r\\n';\n\n      if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&\n          (sdpMLineIndex === 0 || !pc.usingBundle)) {\n        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {\n          cand.component = 1;\n          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\\r\\n';\n        });\n\n        if (transceiver.iceGatherer.state === 'completed') {\n          sdp += 'a=end-of-candidates\\r\\n';\n        }\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer after close'));\n    }\n\n    if (!(pc.signalingState === 'have-remote-offer' ||\n        pc.signalingState === 'have-local-pranswer')) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer in signalingState ' + pc.signalingState));\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    if (pc.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    var mediaSectionsInOffer = SDPUtils.getMediaSections(\n        pc._remoteDescription.sdp).length;\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {\n        return;\n      }\n      if (transceiver.rejected) {\n        if (transceiver.kind === 'application') {\n          if (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt\n            sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n';\n          } else {\n            sdp += 'm=application 0 ' + transceiver.protocol +\n                ' webrtc-datachannel\\r\\n';\n          }\n        } else if (transceiver.kind === 'audio') {\n          sdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\n' +\n              'a=rtpmap:0 PCMU/8000\\r\\n';\n        } else if (transceiver.kind === 'video') {\n          sdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\\r\\n' +\n              'a=rtpmap:120 VP8/90000\\r\\n';\n        }\n        sdp += 'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=inactive\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&\n              !transceiver.sendEncodingParameters[0].rtx) {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream, pc._dtlsRole);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    var pc = this;\n    var sections;\n    if (candidate && !(candidate.sdpMLineIndex !== undefined ||\n        candidate.sdpMid)) {\n      return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));\n    }\n\n    // TODO: needs to go into ops queue.\n    return new Promise(function(resolve, reject) {\n      if (!pc._remoteDescription) {\n        return reject(makeError('InvalidStateError',\n            'Can not add ICE candidate without a remote description'));\n      } else if (!candidate || candidate.candidate === '') {\n        for (var j = 0; j < pc.transceivers.length; j++) {\n          if (pc.transceivers[j].rejected) {\n            continue;\n          }\n          pc.transceivers[j].iceTransport.addRemoteCandidate({});\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[j] += 'a=end-of-candidates\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n          if (pc.usingBundle) {\n            break;\n          }\n        }\n      } else {\n        var sdpMLineIndex = candidate.sdpMLineIndex;\n        if (candidate.sdpMid) {\n          for (var i = 0; i < pc.transceivers.length; i++) {\n            if (pc.transceivers[i].mid === candidate.sdpMid) {\n              sdpMLineIndex = i;\n              break;\n            }\n          }\n        }\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        if (transceiver) {\n          if (transceiver.rejected) {\n            return resolve();\n          }\n          var cand = Object.keys(candidate.candidate).length > 0 ?\n              SDPUtils.parseCandidate(candidate.candidate) : {};\n          // Ignore Chrome's invalid candidates since Edge does not like them.\n          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n            return resolve();\n          }\n          // Ignore RTCP candidates, we assume RTCP-MUX.\n          if (cand.component && cand.component !== 1) {\n            return resolve();\n          }\n          // when using bundle, avoid adding candidates to the wrong\n          // ice transport. And avoid adding candidates added in the SDP.\n          if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\n              transceiver.iceTransport !== pc.transceivers[0].iceTransport)) {\n            if (!maybeAddCandidate(transceiver.iceTransport, cand)) {\n              return reject(makeError('OperationError',\n                  'Can not add ICE candidate'));\n            }\n          }\n\n          // update the remoteDescription.\n          var candidateString = candidate.candidate.trim();\n          if (candidateString.indexOf('a=') === 0) {\n            candidateString = candidateString.substr(2);\n          }\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[sdpMLineIndex] += 'a=' +\n              (cand.type ? candidateString : 'end-of-candidates')\n              + '\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n        } else {\n          return reject(makeError('OperationError',\n              'Can not add ICE candidate'));\n        }\n      }\n      resolve();\n    });\n  };\n\n  RTCPeerConnection.prototype.getStats = function(selector) {\n    if (selector && selector instanceof window.MediaStreamTrack) {\n      var senderOrReceiver = null;\n      this.transceivers.forEach(function(transceiver) {\n        if (transceiver.rtpSender &&\n            transceiver.rtpSender.track === selector) {\n          senderOrReceiver = transceiver.rtpSender;\n        } else if (transceiver.rtpReceiver &&\n            transceiver.rtpReceiver.track === selector) {\n          senderOrReceiver = transceiver.rtpReceiver;\n        }\n      });\n      if (!senderOrReceiver) {\n        throw makeError('InvalidAccessError', 'Invalid selector.');\n      }\n      return senderOrReceiver.getStats();\n    }\n\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n          'dtlsTransport'].forEach(function(method) {\n            if (transceiver[method]) {\n              promises.push(transceiver[method].getStats());\n            }\n          });\n    });\n    return Promise.all(promises).then(function(allStats) {\n      var results = new Map();\n      allStats.forEach(function(stats) {\n        stats.forEach(function(stat) {\n          results.set(stat.id, stat);\n        });\n      });\n      return results;\n    });\n  };\n\n  // fix low-level stat names and return Map instead of object.\n  var ortcObjects = ['RTCRtpSender', 'RTCRtpReceiver', 'RTCIceGatherer',\n    'RTCIceTransport', 'RTCDtlsTransport'];\n  ortcObjects.forEach(function(ortcObjectName) {\n    var obj = window[ortcObjectName];\n    if (obj && obj.prototype && obj.prototype.getStats) {\n      var nativeGetstats = obj.prototype.getStats;\n      obj.prototype.getStats = function() {\n        return nativeGetstats.apply(this)\n        .then(function(nativeStats) {\n          var mapStats = new Map();\n          Object.keys(nativeStats).forEach(function(id) {\n            nativeStats[id].type = fixStatsType(nativeStats[id]);\n            mapStats.set(id, nativeStats[id]);\n          });\n          return mapStats;\n        });\n      };\n    }\n  });\n\n  // legacy callback shims. Should be moved to adapter.js some days.\n  var methods = ['createOffer', 'createAnswer'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[0] === 'function' ||\n          typeof args[1] === 'function') { // legacy\n        return nativeMethod.apply(this, [arguments[2]])\n        .then(function(description) {\n          if (typeof args[0] === 'function') {\n            args[0].apply(null, [description]);\n          }\n        }, function(error) {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function' ||\n          typeof args[2] === 'function') { // legacy\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        }, function(error) {\n          if (typeof args[2] === 'function') {\n            args[2].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // getStats is special. It doesn't have a spec legacy method yet we support\n  // getStats(something, cb) without error callbacks.\n  ['getStats'].forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function') {\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  return RTCPeerConnection;\n};\n","// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n"],"sourceRoot":""}