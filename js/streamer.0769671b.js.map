{"version":3,"sources":["webpack:///./src/views/Streamer.vue?b49c","webpack:///./src/views/Streamer.vue?8ea9","webpack:///./src/assets/svgs/video.svg","webpack:///./src/assets/svgs/audio.svg","webpack:///./src/components/DesktopCapturer.vue?dc7c","webpack:///src/components/DesktopCapturer.vue","webpack:///./src/components/DesktopCapturer.vue?3fdb","webpack:///./src/components/DesktopCapturer.vue","webpack:///./src/components/StreamerConnection.vue?6613","webpack:///src/components/StreamerConnection.vue","webpack:///./src/components/StreamerConnection.vue?043f","webpack:///./src/components/StreamerConnection.vue","webpack:///src/views/Streamer.vue","webpack:///./src/views/Streamer.vue?0983","webpack:///./src/views/Streamer.vue","webpack:///./node_modules/core-js/modules/es.number.constructor.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","attrs","isVideo","on","onIsSharing","onGotStream","onSetDefaults","bandwidth","codecs","room_id","room_password","onSessionId","onViewerCount","class","live","isSharingOn","sessionId","_v","_e","directives","name","rawName","value","expression","domProps","setRoomName","$event","target","composing","_m","setCodecs","setBandwidth","startStream","_s","viewerCount","stopStream","staticRenderFns","functional","data","children","classNames","style","staticStyle","rest","Object","assign","concat","props","enableVideo","Boolean","isSharing","enableAudio","watch","$emit","newValue","methods","setDefaults","captureDesktop","onAccessApproved","video","audio","autoGainControl","echoCancellation","noiseSuppression","googDisableLocalEcho","startCapturing","gotStream","stream","addEventListener","addStreamStopListener","streamEndedEvent","getAudioTracks","forEach","track","getVideoTracks","component","type","Number","default","String","roomPassword","roomId","connection","mounted","window","shareStreamUsingRTCMultiConnection","socketURL","autoCloseEntireSession","socketMessageEvent","password","length","enableLogs","session","oneway","candidates","stun","turn","iceTransportPolicy","iceProtocols","tcp","udp","optionalArgument","optional","mandatory","channel","sessionid","userid","autoReDialOnFailure","getExternalIceServers","iceServers","IceServersHandler","processSdp","sdp","CodecsHandler","min","max","sdpConstraints","OfferToReceiveAudio","OfferToReceiveVideo","onstream","onstreamended","event","mediaElement","pause","dontCaptureUserMedia","attachStreams","push","removeTrack","text","clearInterval","looper","socketCustomEvent","error","alert","onSocketDisconnect","onSocketError","setTimeout","onmessage","newChatMessage","receivedChatMessage","checkmark_id","open","roomOpenCallback","onleave","onPeerStateChanged","participantsCount","setViewerCount","count","getTracks","stop","close","closeSocket","replace","components","LogoSvg","VideoSvg","AudioSvg","DesktopCapturer","StreamerConnection","desktop_id","constraints","localStorage","getItem","streaming_method","$refs","capturer","setItem","parseInt","codec","id","DESCRIPTORS","global","isForced","redefine","has","classof","inheritIfRequired","toPrimitive","fails","create","getOwnPropertyNames","f","getOwnPropertyDescriptor","defineProperty","trim","NUMBER","NativeNumber","NumberPrototype","prototype","BROKEN_CLASSOF","toNumber","argument","first","third","radix","maxCode","digits","index","code","it","charCodeAt","NaN","slice","key","NumberWrapper","arguments","dummy","valueOf","call","keys","split","j","constructor"],"mappings":"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","file":"js/streamer.0769671b.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Streamer.vue?vue&type=style&index=0&id=0072f113&scoped=true&lang=sass&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Streamer.vue?vue&type=style&index=0&id=0072f113&scoped=true&lang=sass&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"frow centered\"},[_c('DesktopCapturer',{ref:\"capturer\",attrs:{\"enableVideo\":_vm.isVideo},on:{\"isSharing\":_vm.onIsSharing,\"gotStream\":_vm.onGotStream,\"setDefaults\":_vm.onSetDefaults}}),_c('StreamerConnection',{ref:\"connection\",attrs:{\"bandwidth\":_vm.bandwidth,\"codecs\":_vm.codecs,\"roomId\":_vm.room_id,\"roomPassword\":_vm.room_password},on:{\"sessionId\":_vm.onSessionId,\"viewerCount\":_vm.onViewerCount}}),_c('div',{staticClass:\"col-md-1-2\"},[_c('LogoSvg',{attrs:{\"id\":\"logo\"}}),_c('div',{class:{ live: _vm.isSharingOn && _vm.sessionId },attrs:{\"id\":\"live-indicator\"}},[_vm._v(\"LIVE\")])],1),_c('div',{staticClass:\"col-md-1-2\"},[(!_vm.isSharingOn || !_vm.sessionId)?_c('section',{attrs:{\"id\":\"setup-section\"}},[_c('label',{staticClass:\"row-start\",attrs:{\"id\":\"room-id-label\"}},[_c('span',{staticClass:\"shrink-0\"},[_vm._v(\"2n.fm/\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.room_id),expression:\"room_id\"}],attrs:{\"id\":\"room-id\",\"type\":\"text\",\"placeholder\":\"Random\"},domProps:{\"value\":(_vm.room_id)},on:{\"change\":_vm.setRoomName,\"blur\":_vm.setRoomName,\"input\":function($event){if($event.target.composing){ return; }_vm.room_id=$event.target.value}}})]),_c('section',{attrs:{\"id\":\"options\",\"hidden\":\"\"}},[_c('div',{staticClass:\"label\"},[_vm._v(\"Options\")]),_c('div',{staticClass:\"frow row-start gutters\"},[_vm._m(0),_c('div',{staticClass:\"col-xs-1-2\"},[_c('div',{staticClass:\"settings-item\"},[_c('label',[_vm._v(\"Codec\"),_c('select',{attrs:{\"id\":\"codecs\"},on:{\"change\":_vm.setCodecs}},[_c('option',{attrs:{\"value\":\"default\",\"selected\":\"\"}},[_vm._v(\"Default (VP8)\")]),_c('option',{attrs:{\"value\":\"vp8\"}},[_vm._v(\"VP8\")]),_c('option',{attrs:{\"value\":\"vp9\"}},[_vm._v(\"VP9\")]),_c('option',{attrs:{\"value\":\"h264\"}},[_vm._v(\"H264\")])])])])]),_c('div',{staticClass:\"col-xs-1-2\"},[_c('div',{staticClass:\"settings-item mb-0\"},[_c('label',[_vm._v(\"Bandwidth\"),_c('input',{attrs:{\"id\":\"bandwidth\",\"type\":\"text\",\"value\":\"\",\"placeholder\":\"Optional: 8192, 1048, 512, etc.\"},on:{\"change\":_vm.setBandwidth}})])])]),_vm._m(1)])]),_c('section',{attrs:{\"id\":\"stream-section\"}},[_c('div',{attrs:{\"id\":\"start\"}},[_c('div',{staticClass:\"label\"},[_vm._v(\"Start\")]),_c('div',{staticClass:\"frow gutters\"},[_c('div',{staticClass:\"col-xs-1-2\"},[_c('div',{staticClass:\"stream-button\",attrs:{\"id\":\"video-button\"},on:{\"click\":function($event){return _vm.startStream(true)}}},[_c('div',{staticClass:\"frow column-center\"},[_c('VideoSvg'),_vm._v(\"Video\")],1)])]),_c('div',{staticClass:\"col-xs-1-2\"},[_c('div',{staticClass:\"stream-button\",attrs:{\"id\":\"audio-button\"},on:{\"click\":function($event){return _vm.startStream()}}},[_c('div',{staticClass:\"frow column-center\"},[_c('AudioSvg'),_vm._v(\"Audio Only\")],1)])])])])])]):_vm._e(),(_vm.isSharingOn && _vm.sessionId)?_c('section',{attrs:{\"id\":\"stop-section\"}},[_c('router-link',{attrs:{\"id\":\"public-link\",\"to\":_vm.sessionId,\"target\":\"_blank\"}},[_vm._v(_vm._s((\"2n.fm/\" + _vm.sessionId)))]),_c('div',{staticClass:\"viewer-count\"},[_c('span',{attrs:{\"id\":\"viewer-count-number\"}}),_vm._v(_vm._s(_vm.viewerCount)+\" \"+_vm._s(_vm.viewerCount === 1 ? 'Viewer' : 'Viewers')+\" \")]),_c('button',{attrs:{\"id\":\"stop-sharing\",\"type\":\"button\"},on:{\"click\":_vm.stopStream}},[_vm._v(\"End Sharing\")])],1):_vm._e(),_vm._m(2)])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"col-xs-1-2\"},[_c('div',{staticClass:\"settings-item\"},[_c('label',[_vm._v(\"Resolution\"),_c('select',{attrs:{\"id\":\"resolutions\"}},[_c('option',{attrs:{\"value\":\"fit-screen\",\"selected\":\"\"}},[_vm._v(\"Fit Screen\")]),_c('option',{attrs:{\"value\":\"4K\"}},[_vm._v(\"4K (2160p)\")]),_c('option',{attrs:{\"value\":\"1080p\"}},[_vm._v(\"Full-HD (1080p)\")]),_c('option',{attrs:{\"value\":\"720p\"}},[_vm._v(\"HD (720p)\")]),_c('option',{attrs:{\"value\":\"480p\"}},[_vm._v(\"SD (480p)\")]),_c('option',{attrs:{\"value\":\"360p\"}},[_vm._v(\"SD (360p)\")])])])])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"col-xs-1-2\"},[_c('div',{staticClass:\"settings-item mb-0\"},[_c('label',[_vm._v(\"Room Password\"),_c('input',{attrs:{\"id\":\"room_password\",\"type\":\"password\",\"value\":\"\",\"placeholder\":\"Optional\"}})])])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"frow width-100 mt-20\"},[_c('a',{staticClass:\"text-underline\",attrs:{\"href\":\"https://caniuse.com/#search=getDisplayMedia\",\"rel\":\"noreferrer\",\"target\":\"_blank\"}},[_vm._v(\"OS and Browser Limitations\")])])}]\n\nexport { render, staticRenderFns }","\n      export default {\n        functional: true,\n        render(_h, _vm) {\n          const { _c, _v, data, children = [] } = _vm;\n\n          const {\n            class: classNames,\n            staticClass,\n            style,\n            staticStyle,\n            attrs = {},\n            ...rest\n          } = data;\n\n          return _c(\n            'svg',\n            {\n              class: [classNames,staticClass],\n              style: [style,staticStyle],\n              attrs: Object.assign({\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\"}, attrs),\n              ...rest,\n            },\n            children.concat([_c('g',{attrs:{\"fill\":\"none\",\"fill-rule\":\"evenodd\"}},[_c('path',{attrs:{\"d\":\"M1 18v3h3c0-1.7-1.3-3-3-3zm0-4v2c2.8 0 5 2.2 5 5h2c0-3.9-3.1-7-7-7zm0-4v2c5 0 9 4 9 9h2c0-6.1-4.9-11-11-11zm20-7H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\"}})])])\n          )\n        }\n      }\n    ","\n      export default {\n        functional: true,\n        render(_h, _vm) {\n          const { _c, _v, data, children = [] } = _vm;\n\n          const {\n            class: classNames,\n            staticClass,\n            style,\n            staticStyle,\n            attrs = {},\n            ...rest\n          } = data;\n\n          return _c(\n            'svg',\n            {\n              class: [classNames,staticClass],\n              style: [style,staticStyle],\n              attrs: Object.assign({\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\"}, attrs),\n              ...rest,\n            },\n            children.concat([_c('path',{attrs:{\"d\":\"M2 6h3.828c-1.335 2.905-1.335 9.096 0 12H2c-1.311-1.108-2-3.551-2-5.995C0 9.555.692 7.105 2 6zm22 6.005c.005 8.031-3.145 12.864-6.121 11.864-.774-.26-9.567-5.579-9.567-5.579-1.993-2.22-1.993-10.288 0-12.508 0 0 9.161-5.476 9.548-5.633 2.691-1.086 6.136 3.82 6.14 11.856zm-3.383-7.693c-1.053-2.264-3.002-2.226-4.034.002-.588 1.271-.993 3.165-1.21 4.797h.527c1.587 0 2.873 1.287 2.873 2.875s-1.286 2.875-2.873 2.875h-.515c.217 1.603.616 3.538 1.206 4.89.988 2.271 3.062 2.232 4.033-.002 1.946-4.477 1.772-11.609-.007-15.437z\"}})])\n          )\n        }\n      }\n    ","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(\"div\")}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\n  \n</template>\n\n<script>\nexport default {\n  name: 'DesktopCapturer',\n  props: {\n    enableVideo: Boolean,\n  },\n  data() {\n    return {\n      isSharing: false,\n      enableAudio: false,\n    };\n  },\n  watch: {\n    isSharing(newValue) {\n      this.$emit('isSharing', newValue);\n    },\n  },\n  methods: {\n    setDefaults() {\n      this.$emit('setDefaults');\n      this.isSharing = false;\n    },\n    startStream() {\n      this.setDefaults();\n      this.isSharing = true;\n      this.enableAudio = true;\n      this.captureDesktop();\n    },\n    stopStream() {\n      this.isSharing = false;\n\n      // SM: post Vue migration, what previously ran in captureDesktop is instead in setDefaults\n      // this.captureDesktop();\n      this.setDefaults();\n\n      // runtimePort.postMessage({\n      //   messageFromContentScript1234: true,\n      //   stopSharing: true,\n      // });\n    },\n    captureDesktop() {\n      this.onAccessApproved();\n    },\n    onAccessApproved() {\n      // console.log(navigator.mediaDevices.getSupportedConstraints());\n\n      let constraints = {\n        video: {\n          // TODO: displaySurface support is waiting on browser support\n          // https://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/displaySurface\n          // displaySurface: [\"application\", \"browser\", \"monitor\", \"window\"]\n        },\n        audio: {\n          autoGainControl: false,\n          echoCancellation: false,\n          noiseSuppression: false,\n          googDisableLocalEcho: false, // https://www.chromestatus.com/feature/5056629556903936\n        },\n      };\n\n      const startScreenCapture = async () => {\n        let captureStream;\n        try {\n          captureStream = await navigator.mediaDevices.getDisplayMedia(\n            constraints,\n          );\n        } catch (err) {\n          this.setDefaults();\n        }\n        return captureStream;\n      };\n\n      const startCapturing = async () => {\n        let stream = await startScreenCapture();\n        // console.log(stream.getTracks()[0].getCapabilities());\n        // console.log(stream.getTracks()[0].getSettings());\n        if (!this.enableVideo && stream.getAudioTracks().length === 0) {\n          alert('Make sure to check the \"Share audio\" box in Google Chrome');\n        }\n        this.gotStream(stream);\n      };\n      startCapturing();\n    },\n    gotStream(stream) {\n      if (!stream) {\n        this.setDefaults();\n        return;\n      }\n\n      stream.addEventListener('inactive', () => {\n        this.setDefaults();\n      });\n\n      this.addStreamStopListener(stream, () => {\n        this.setDefaults();\n      });\n\n      this.$emit('gotStream', stream);\n    },\n    addStreamStopListener(stream, callback) {\n      var streamEndedEvent = 'ended';\n      if ('oninactive' in stream) {\n        streamEndedEvent = 'inactive';\n      }\n      stream.addEventListener(\n        streamEndedEvent,\n        function() {\n          callback();\n          callback = function() {};\n        },\n        false,\n      );\n      stream.getAudioTracks().forEach(function(track) {\n        track.addEventListener(\n          streamEndedEvent,\n          function() {\n            callback();\n            callback = function() {};\n          },\n          false,\n        );\n      });\n      stream.getVideoTracks().forEach(function(track) {\n        track.addEventListener(\n          streamEndedEvent,\n          function() {\n            callback();\n            callback = function() {};\n          },\n          false,\n        );\n      });\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DesktopCapturer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DesktopCapturer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DesktopCapturer.vue?vue&type=template&id=4c2b97f4&lang=pug&\"\nimport script from \"./DesktopCapturer.vue?vue&type=script&lang=js&\"\nexport * from \"./DesktopCapturer.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(\"div\")}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\n  \n</template>\n\n<script>\n// NOTE: needs to be imported for back-compat, but not referenced\n// eslint-disable-next-line no-unused-vars\nimport adapter from 'webrtc-adapter';\n\nimport RTCMultiConnection from 'rtcmulticonnection';\n\nimport { CodecsHandler } from '../utils/background/helpers/CodecsHandler';\nimport { IceServersHandler } from '../utils/background/helpers/IceServersHandler';\n\nexport default {\n  name: 'StreamerConnection',\n  props: {\n    bandwidth: {\n      type: Number,\n      default: 8192,\n    },\n    codecs: {\n      type: String,\n      default: 'default',\n    },\n    roomPassword: {\n      type: String,\n      default: '',\n    },\n    roomId: {\n      type: String,\n      default: '',\n    },\n  },\n  data() {\n    return {\n      connection: null,\n    };\n  },\n  mounted() {\n    // TODO: should probably deregister the event listener on e.g. `unmounted`\n    window.addEventListener(\n      'offline',\n      () => {\n        if (!this.connection || !this.connection.attachStreams.length) return;\n\n        this.setDefaults();\n      },\n      false,\n    );\n\n    window.addEventListener(\n      'online',\n      () => {\n        if (!this.connection) return;\n\n        this.setDefaults();\n      },\n      false,\n    );\n  },\n  methods: {\n    shareStreamUsingRTCMultiConnection(stream, isVideo = false) {\n      // www.RTCMultiConnection.org/docs/\n      this.connection = new RTCMultiConnection();\n      this.connection.socketURL = 'https://api.2n.fm:9001/';\n      this.connection.autoCloseEntireSession = true;\n\n      // this must match the viewer page\n      this.connection.socketMessageEvent = 'desktopCapture';\n\n      this.connection.password = null;\n      if (this.roomPassword && this.roomPassword.length) {\n        this.connection.password = this.roomPassword;\n      }\n\n      this.connection.enableLogs = false;\n      this.connection.session = {\n        audio: true,\n        video: true,\n        data: true,\n        oneway: true,\n      };\n\n      this.connection.candidates = {\n        stun: true,\n        turn: true,\n      };\n      this.connection.iceTransportPolicy = 'relay';\n\n      this.connection.iceProtocols = {\n        tcp: true,\n        udp: true,\n      };\n\n      this.connection.optionalArgument = {\n        optional: [],\n        mandatory: {},\n      };\n\n      this.connection.channel = this.connection.sessionid = this.connection.userid;\n\n      if (this.roomId && this.roomId.length) {\n        this.connection.channel = this.connection.sessionid = this.connection.userid = this.roomId;\n      }\n\n      this.connection.autoReDialOnFailure = true;\n      this.connection.getExternalIceServers = false;\n\n      this.connection.iceServers = IceServersHandler.getIceServers();\n\n      this.connection.processSdp = (sdp) => {\n        if (this.bandwidth) {\n          if (\n            this.bandwidth &&\n            !isNaN(this.bandwidth) &&\n            this.bandwidth != 'NaN' &&\n            typeof this.bandwidth == 'number'\n          ) {\n            sdp = setBandwidth(sdp, this.bandwidth);\n            sdp = CodecsHandler.setVideoBitrates(sdp, {\n              min: this.bandwidth,\n              max: this.bandwidth,\n            });\n          }\n        }\n\n        if (!!this.codecs && this.codecs !== 'default') {\n          sdp = CodecsHandler.preferCodec(sdp, this.codecs);\n        }\n        return sdp;\n      };\n\n      // www.rtcmultiexternalThis.connection.org/docs/sdpConstraints/\n      this.connection.sdpConstraints.mandatory = {\n        OfferToReceiveAudio: false,\n        OfferToReceiveVideo: false,\n      };\n\n      this.connection.onstream = this.connection.onstreamended = (event) => {\n        try {\n          event.mediaElement.pause();\n          delete event.mediaElement;\n        } catch (e) {}\n      };\n\n      // www.RTCMultiConnection.org/docs/dontCaptureUserMedia/\n      this.connection.dontCaptureUserMedia = true;\n\n      // www.RTCMultiConnection.org/docs/attachStreams/\n      this.connection.attachStreams.push(stream);\n\n      if (\n        !isVideo &&\n        this.connection.attachStreams[0].getVideoTracks().length > 0\n      ) {\n        this.connection.attachStreams[0].removeTrack(\n          this.connection.attachStreams[0].getVideoTracks()[0],\n        );\n      }\n\n      // console.log(\"connectionHere\", externalThis.connection.attachStreams[0].getAudioTracks());\n\n      var text = '-';\n      const looper = setInterval(() => {\n        if (!this.connection) {\n          this.setViewerCount(0);\n          clearInterval(looper);\n          return;\n        }\n\n        if (this.connection.isInitiator) {\n          this.setViewerCount(0);\n          clearInterval(looper)\n          return;\n        }\n\n        text += ' -';\n        if (text.length > 6) {\n          text = '-';\n        }\n\n        this.setViewerCount(text);\n      }, 500);\n      \n\n      // www.RTCMultiConnection.org/docs/open/\n      this.connection.socketCustomEvent = this.connection.sessionid;\n\n      const roomOpenCallback = (isRoomOpened, roomid, error) => {\n        if (error) {\n          alert(error);\n        }\n\n        // any key-values set here should be reset in setDefaults.js\n        this.$emit('sessionId', this.connection.sessionid);\n\n        this.setViewerCount(0);\n\n        this.connection.socket.on(\n          this.connection.socketCustomEvent,\n          (message) => {\n            if (message.receivedYourScreen) {\n              this.setViewerCount(\n                this.connection.isInitiator\n                  ? this.connection.getAllParticipants().length\n                  : 0,\n              );\n            }\n          },\n        );\n      };\n\n      this.connection.onSocketDisconnect = () => {\n        // alert('externalThis.connection to the server is closed.');\n        if (this.connection.getAllParticipants().length > 0) return;\n\n        this.setDefaults();\n      };\n\n      this.connection.onSocketError = () => {\n        alert('Unable to connect to the server. Please try again.');\n\n        setTimeout(() => {\n          this.setDefaults();\n        }, 1000);\n      };\n\n      // this.connection.onopen = (event) => {\n      //   //\n      // };\n\n      this.connection.onmessage = (event) => {\n        if (event.data.newChatMessage) {\n          // this.runtimePort.postMessage({\n          //   messageFromContentScript1234: true,\n          //   newChatMessage: event.data.newChatMessage\n          // });\n\n          this.connection.send({\n            receivedChatMessage: true,\n            checkmark_id: event.data.checkmark_id,\n          });\n        }\n\n        // if (event.data.receivedChatMessage) {\n        //   this.runtimePort.postMessage({\n        //     messageFromContentScript1234: true,\n        //     receivedChatMessage: true,\n        //     checkmark_id: event.data.checkmark_id\n        //   });\n        // }\n      };\n\n      this.connection.open(this.connection.sessionid, roomOpenCallback);\n\n      var oldLength = 0;\n      this.connection.onleave = this.connection.onPeerStateChanged = () => {\n        var participantsCount = this.connection.getAllParticipants().length;\n        if (oldLength != participantsCount) {\n          // sendTabTitle();\n        }\n        this.setViewerCount(\n          this.connection.isInitiator ? participantsCount : 0,\n        );\n      };\n    },\n    setViewerCount(count) {\n      this.$emit('viewerCount', count);\n    },\n    setDefaults() {\n      if (this.connection) {\n        this.connection.attachStreams.forEach((stream) => {\n          try {\n            stream.getTracks().forEach((track) => {\n              try {\n                track.stop();\n              } catch (e) {}\n            });\n          } catch (e) {}\n        });\n\n        try {\n          this.connection.close();\n        } catch (e) {}\n\n        try {\n          this.connection.closeSocket();\n        } catch (e) {}\n\n        clearInterval(this.connection.looper);\n\n        this.connection = null;\n      }\n\n      this.setViewerCount(0);\n    },\n  },\n};\n\nfunction setBandwidth(sdp, value) {\n  sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\n  sdp = sdp.replace(\n    /a=mid:video\\r\\n/g,\n    'a=mid:video\\r\\nb=AS:' + value + '\\r\\n',\n  );\n  return sdp;\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StreamerConnection.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StreamerConnection.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./StreamerConnection.vue?vue&type=template&id=ccc02c02&lang=pug&\"\nimport script from \"./StreamerConnection.vue?vue&type=script&lang=js&\"\nexport * from \"./StreamerConnection.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<style scoped lang=\"sass\">\n.card\n  background-color: $white\n  padding: 15px\n  text-align: center\n\n#logo\n  margin: 0 auto\n  width: 228px\n  height: auto\n  fill: $primary-color\n\n#live-indicator\n  margin: 15px auto 0\n  width: 228px\n  color: $tertiary-color\n  border-radius: 20px\n  border: 6px solid $tertiary-color\n  font-weight: bold\n  font-size: 91px\n  text-align: center\n\n  &.live\n    color: red\n    border-color: red\n    animation: pulse 1.5s ease-in-out infinite alternate\n\n/* XS\n@media (max-width: 767px)\n  #logo\n    margin: 0 auto\n    width: 114px\n  #live-indicator\n    width: 114px\n    border-radius: 10px\n    border: 3px solid $tertiary-color\n    font-size: 45px\n    margin-bottom: 30px\n\n#room-id-label\n  font-size: 40px\n  color: $primary-color\n\n  input\n    font-size: 40px\n    border-width: 4px\n\n/* XS\n@media (max-width: 767px)\n  #room-id-label\n    font-size: 30px\n\n    input\n      font-size: 30px\n      border-width: 2px\n\n#options\n  border: 2px solid $tertiary-color\n  border-radius: 10px\n  padding: 40px\n  margin: 40px 0\n  position: relative\n\n  .label\n    position: absolute\n    top: -9px\n    left: 30px\n    background-color: $white\n    padding: 0 8px\n    width: auto\n\n.settings-item\n  margin-bottom: 40px\n\n  label\n    margin-bottom: 0\n\n#start\n  border: 2px solid $tertiary-color\n  border-radius: 10px\n  padding: 40px\n  margin-top: 40px\n  position: relative\n\n  .label\n    position: absolute\n    top: -9px\n    left: 30px\n    background-color: $white\n    padding: 0 8px\n    width: auto\n\n.stream-button\n  cursor: pointer\n  transition: color 0.3s\n\n  &:hover\n    color: $black\n\n  svg\n    width: auto\n    height: 40px\n    margin-bottom: 10px\n\n  path\n    fill: $primary-color\n    transition: fill 0.3s\n\n  &:hover svg path\n    fill: $black\n\n#public-link\n  display: block\n  font-size: 40px\n  color: $primary-color\n  margin: 0 auto\n  text-align: center\n\n/* XS\n@media (max-width: 767px)\n  #public-link\n    font-size: 30px\n\n.viewer-count\n  margin: 5px auto 60px\n  text-align: center\n  font-size: 20px\n  font-weight: bold\n\n#stop-sharing\n  margin: 0 auto\n  font-size: 40px\n  padding: 20px\n  background: none\n  border: 3px solid $primary-color\n  color: $primary-color\n  border-radius: 10px\n</style>\n\n<template lang=\"pug\">\n.frow.centered\n  DesktopCapturer(\n    ref=\"capturer\"\n    :enableVideo=\"isVideo\"\n    @isSharing=\"onIsSharing\"\n    @gotStream=\"onGotStream\"\n    @setDefaults=\"onSetDefaults\"\n  )\n  StreamerConnection(\n    ref=\"connection\"\n    :bandwidth=\"bandwidth\"\n    :codecs=\"codecs\"\n    :roomId=\"room_id\"\n    :roomPassword=\"room_password\"\n    @sessionId=\"onSessionId\"\n    @viewerCount=\"onViewerCount\"\n  )\n  .col-md-1-2\n    LogoSvg#logo\n    #live-indicator(:class=\"{ live: isSharingOn && sessionId }\") LIVE\n  .col-md-1-2\n    section#setup-section(v-if=\"!isSharingOn || !sessionId\")\n      label#room-id-label.row-start\n        span.shrink-0 2n.fm/\n        input#room-id(\n          type=\"text\"\n          placeholder=\"Random\"\n          v-model=\"room_id\"\n          @change=\"setRoomName\"\n          @blur=\"setRoomName\")\n      section#options(hidden=\"\")\n        .label Options\n        .frow.row-start.gutters\n          .col-xs-1-2\n            .settings-item\n              label\n                | Resolution\n                select#resolutions\n                  option(value=\"fit-screen\" selected=\"\") Fit Screen\n                  option(value=\"4K\") 4K (2160p)\n                  option(value=\"1080p\") Full-HD (1080p)\n                  option(value=\"720p\") HD (720p)\n                  option(value=\"480p\") SD (480p)\n                  option(value=\"360p\") SD (360p)\n          .col-xs-1-2\n            .settings-item\n              label\n                | Codec\n                select#codecs(@change=\"setCodecs\")\n                  option(value=\"default\" selected=\"\") Default (VP8)\n                  option(value=\"vp8\") VP8\n                  option(value=\"vp9\") VP9\n                  option(value=\"h264\") H264\n          .col-xs-1-2\n            .settings-item.mb-0\n              label\n                | Bandwidth\n                input#bandwidth(\n                  type=\"text\"\n                  value=\"\"\n                  placeholder=\"Optional: 8192, 1048, 512, etc.\"\n                  @change=\"setBandwidth\"\n                )\n          .col-xs-1-2\n            .settings-item.mb-0\n              label\n                | Room Password\n                input#room_password(type=\"password\" value=\"\" placeholder=\"Optional\")\n      section#stream-section\n        #start\n          .label Start\n          .frow.gutters\n            .col-xs-1-2\n              #video-button.stream-button(@click=\"startStream(true)\")\n                .frow.column-center\n                  VideoSvg\n                  | Video\n            .col-xs-1-2\n              #audio-button.stream-button(@click=\"startStream()\")\n                .frow.column-center\n                  AudioSvg\n                  | Audio Only\n    section#stop-section(v-if=\"isSharingOn && sessionId\")\n      //- router-link#public-link(\n      //-   to=\"{query: { s: sessionId, p: room_password }}`}\" target=\"_blank\"\n      //- )\n      router-link#public-link(:to=\"sessionId\" target=\"_blank\")\n        | {{ `2n.fm/${sessionId}` }}\n      .viewer-count\n        span#viewer-count-number\n        | {{ viewerCount }} {{ viewerCount === 1 ? 'Viewer' : 'Viewers' }} \n      button#stop-sharing(type=\"button\" @click=\"stopStream\")\n        | End Sharing\n    .frow.width-100.mt-20\n      a.text-underline(\n        href=\"https://caniuse.com/#search=getDisplayMedia\"\n        rel=\"noreferrer\"\n        target=\"_blank\"\n      )\n        | OS and Browser Limitations\n      //\n        <div id=\"enable-chat\">\n        <img src=\"../images/chat.png\">\n        Open Chat Box\n        </div>\n</template>\n\n<script>\nimport LogoSvg from '@/assets/svgs/logo.svg';\nimport VideoSvg from '@/assets/svgs/video.svg';\nimport AudioSvg from '@/assets/svgs/audio.svg';\n\nimport DesktopCapturer from '@/components/DesktopCapturer.vue';\nimport StreamerConnection from '@/components/StreamerConnection.vue';\n\nexport default {\n  name: 'Streamer',\n  components: {\n    LogoSvg,\n    VideoSvg,\n    AudioSvg,\n    DesktopCapturer,\n    StreamerConnection,\n  },\n  data() {\n    return {\n      isSharingOn: false,\n      // sessionId aka room name\n      sessionId: null,\n      desktop_id: null,\n      constraints: null,\n      room_password: '',\n      room_id: window.localStorage.getItem('room_id') || '',\n      codecs: 'default',\n      bandwidth: null,\n      isVideo: false,\n      streaming_method: 'RTCMultiConnection',\n      viewerCount: 0,\n    };\n  },\n  mounted() {\n    // document.getElementById('enable-chat').onclick = function() {\n    //   var popup_width = 312;\n    //   var popup_height = 400;\n    //   runtimePort.postMessage({\n    //     messageFromContentScript1234: true,\n    //     openChat: true\n    //   });\n    //   window.open('chat.html','Chat','width='+popup_width+',height='+popup_height\n    //     +',toolbar=0,menubar=0,location=0,status=1,scrollbars=1,resizable=0,top='\n    //     +(screen.height - popup_height)+',left=' + (screen.width - popup_width - 30));\n    //   window.close();\n    // };\n  },\n  methods: {\n    startStream(isVideo = false) {\n      this.isVideo = isVideo;\n\n      if (\n        this.$refs.connection.connection &&\n        this.$refs.connection.connection.attachStreams[0]\n      ) {\n        this.onSetDefaults();\n        return;\n      }\n\n      this.room_id = '';\n\n      if (window.localStorage.getItem('room_id')) {\n        this.room_id = window.localStorage.getItem('room_id');\n      }\n\n      this.$refs.capturer.startStream();\n    },\n    stopStream() {\n      this.$refs.capturer.stopStream();\n    },\n    setRoomName() {\n      this.room_id = this.room_id\n        .trim()\n        .replace(/\\s+/g, '-')\n        .replace(/[^a-zA-Z0-9-_]/g, '')\n        .toLowerCase();\n      window.localStorage.setItem('room_id', this.room_id);\n    },\n    setBandwidth(value) {\n      try {\n        this.bandwidth = parseInt(value);\n      } catch (e) {\n        this.bandwidth = null;\n      }\n    },\n    setCodecs(codec) {\n      this.codecs = codec;\n    },\n    onGotStream(stream) {\n      this.$refs.connection.shareStreamUsingRTCMultiConnection(\n        stream,\n        this.isVideo,\n      );\n    },\n    onSessionId(id) {\n      this.sessionId = id;\n    },\n    onSetDefaults() {\n      this.$refs.connection.setDefaults();\n    },\n    onIsSharing(isSharing) {\n      this.isSharingOn = isSharing;\n    },\n    onViewerCount(count) {\n      this.viewerCount = count;\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Streamer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Streamer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Streamer.vue?vue&type=template&id=0072f113&scoped=true&lang=pug&\"\nimport script from \"./Streamer.vue?vue&type=script&lang=js&\"\nexport * from \"./Streamer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Streamer.vue?vue&type=style&index=0&id=0072f113&scoped=true&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0072f113\",\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar has = require('../internals/has');\nvar classof = require('../internals/classof-raw');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar toPrimitive = require('../internals/to-primitive');\nvar fails = require('../internals/fails');\nvar create = require('../internals/object-create');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar defineProperty = require('../internals/object-define-property').f;\nvar trim = require('../internals/string-trim').trim;\n\nvar NUMBER = 'Number';\nvar NativeNumber = global[NUMBER];\nvar NumberPrototype = NativeNumber.prototype;\n\n// Opera ~12 has broken Object#toString\nvar BROKEN_CLASSOF = classof(create(NumberPrototype)) == NUMBER;\n\n// `ToNumber` abstract operation\n// https://tc39.github.io/ecma262/#sec-tonumber\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, false);\n  var first, third, radix, maxCode, digits, length, index, code;\n  if (typeof it == 'string' && it.length > 2) {\n    it = trim(it);\n    first = it.charCodeAt(0);\n    if (first === 43 || first === 45) {\n      third = it.charCodeAt(2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (it.charCodeAt(1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal of /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal of /^0o[0-7]+$/i\n        default: return +it;\n      }\n      digits = it.slice(2);\n      length = digits.length;\n      for (index = 0; index < length; index++) {\n        code = digits.charCodeAt(index);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\n// `Number` constructor\n// https://tc39.github.io/ecma262/#sec-number-constructor\nif (isForced(NUMBER, !NativeNumber(' 0o1') || !NativeNumber('0b1') || NativeNumber('+0x1'))) {\n  var NumberWrapper = function Number(value) {\n    var it = arguments.length < 1 ? 0 : value;\n    var dummy = this;\n    return dummy instanceof NumberWrapper\n      // check on 1..constructor(foo) case\n      && (BROKEN_CLASSOF ? fails(function () { NumberPrototype.valueOf.call(dummy); }) : classof(dummy) != NUMBER)\n        ? inheritIfRequired(new NativeNumber(toNumber(it)), dummy, NumberWrapper) : toNumber(it);\n  };\n  for (var keys = DESCRIPTORS ? getOwnPropertyNames(NativeNumber) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES2015 (in case, if modules with ES2015 Number statics required before):\n    'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,' +\n    'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (has(NativeNumber, key = keys[j]) && !has(NumberWrapper, key)) {\n      defineProperty(NumberWrapper, key, getOwnPropertyDescriptor(NativeNumber, key));\n    }\n  }\n  NumberWrapper.prototype = NumberPrototype;\n  NumberPrototype.constructor = NumberWrapper;\n  redefine(global, NUMBER, NumberWrapper);\n}\n"],"sourceRoot":""}